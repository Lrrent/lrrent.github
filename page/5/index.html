<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="f9kcHL9W1mQXtVMD51J919P_jKOPLSbMVi46xSMpOkM" />










  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="随笔 随心" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="随笔 随心">
<meta property="og:type" content="website">
<meta property="og:title" content="FOOLMAN 一个人的修行">
<meta property="og:url" content="http://www.wuliaole.com/page/5/index.html">
<meta property="og:site_name" content="FOOLMAN 一个人的修行">
<meta property="og:description" content="随笔 随心">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FOOLMAN 一个人的修行">
<meta name="twitter:description" content="随笔 随心">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://www.wuliaole.com/page/5/"/>

  <title> FOOLMAN 一个人的修行 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?0b9af06e21a88c60dc3deb5b699a3e63";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <div style="display: none;">
    <script src="http://s6.cnzz.com/stat.php?id=1259393906&web_id=1259393906" type="text/javascript"></script>
  </div>





  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">FOOLMAN 一个人的修行</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">随笔 随心</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/the_encryption_algorithms_and_implementation/" itemprop="url">
                  网络通信加密算法介绍及C#实现
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-10T21:07:24+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/the_encryption_algorithms_and_implementation/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/the_encryption_algorithms_and_implementation/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="&#x672C;&#x6587;&#x4E3B;&#x8981;&#x5728;&#x8BF4;&#x4EC0;&#x4E48;&#xFF1F;"><a href="#&#x672C;&#x6587;&#x4E3B;&#x8981;&#x5728;&#x8BF4;&#x4EC0;&#x4E48;&#xFF1F;" class="headerlink" title="&#x672C;&#x6587;&#x4E3B;&#x8981;&#x5728;&#x8BF4;&#x4EC0;&#x4E48;&#xFF1F;"></a>&#x672C;&#x6587;&#x4E3B;&#x8981;&#x5728;&#x8BF4;&#x4EC0;&#x4E48;&#xFF1F;</h1><p>&#x6700;&#x8FD1;&#x5728;&#x505A;Winform&#x7A0B;&#x5E8F;&#x548C;PHP&#x7684;&#x4EA4;&#x4E92;&#xFF0C;&#x4E2D;&#x95F4;&#x63A5;&#x89E6;&#x4E86;&#x4E0D;&#x5C11;&#x52A0;&#x5BC6;&#x89E3;&#x5BC6;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x7B80;&#x5355;&#x505A;&#x4E2A;&#x603B;&#x7ED3;&#x3002;</p>
<p>#&#x51E0;&#x4E2A;&#x6982;&#x5FF5;</p>
<h2 id="&#x6563;&#x5217;&#x52A0;&#x5BC6;&#xFF0C;"><a href="#&#x6563;&#x5217;&#x52A0;&#x5BC6;&#xFF0C;" class="headerlink" title="&#x6563;&#x5217;&#x52A0;&#x5BC6;&#xFF0C;"></a>&#x6563;&#x5217;&#x52A0;&#x5BC6;&#xFF0C;</h2><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><p>&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x6807;&#x51C6;&#xFF08;DES&#xFF09;&#x662F;&#x7F8E;&#x56FD;&#x7684;&#x4E00;&#x79CD;&#x7531;&#x6765;&#x5DF2;&#x4E45;&#x7684;&#x52A0;&#x5BC6;&#x6807;&#x51C6;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x5BF9;&#x79F0;&#x5BC6;&#x94A5;&#x52A0;&#x5BC6;&#x6CD5;&#xFF0C;&#x5E76;&#x4E8E;1981&#x5E74;&#x88AB;ANSI&#x7EC4;&#x7EC7;&#x89C4;&#x8303;&#x4E3A;ANSI X.3.92&#x3002;DES&#x4F7F;&#x7528;56&#x4F4D;&#x5BC6;&#x94A5;&#x548C;&#x5BC6;&#x7801;&#x5757;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x800C;&#x5728;&#x5BC6;&#x7801;&#x5757;&#x7684;&#x65B9;&#x6CD5;&#x4E2D;&#xFF0C;&#x6587;&#x672C;&#x88AB;&#x5206;&#x6210;64&#x4F4D;&#x5927;&#x5C0F;&#x7684;&#x6587;&#x672C;&#x5757;&#x7136;&#x540E;&#x518D;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#x3002;</p>
<h2 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h2><p>3DES&#xFF08;&#x6216;&#x79F0;&#x4E3A;Triple DES&#xFF09;&#x662F;&#x4E09;&#x91CD;&#x6570;&#x636E;&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#xFF08;TDEA&#xFF0C;Triple Data Encryption Algorithm&#xFF09;&#x5757;&#x5BC6;&#x7801;&#x7684;&#x901A;&#x79F0;&#x3002;&#x5B83;&#x76F8;&#x5F53;&#x4E8E;&#x662F;&#x5BF9;&#x6BCF;&#x4E2A;&#x6570;&#x636E;&#x5757;&#x5E94;&#x7528;&#x4E09;&#x6B21;DES&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x3002;&#x7531;&#x4E8E;&#x8BA1;&#x7B97;&#x673A;&#x8FD0;&#x7B97;&#x80FD;&#x529B;&#x7684;&#x589E;&#x5F3A;&#xFF0C;&#x539F;&#x7248;DES&#x5BC6;&#x7801;&#x7684;&#x5BC6;&#x94A5;&#x957F;&#x5EA6;&#x53D8;&#x5F97;&#x5BB9;&#x6613;&#x88AB;&#x66B4;&#x529B;&#x7834;&#x89E3;&#xFF1B;3DES&#x5373;&#x662F;&#x8BBE;&#x8BA1;&#x7528;&#x6765;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x76F8;&#x5BF9;&#x7B80;&#x5355;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5373;&#x901A;&#x8FC7;&#x589E;&#x52A0;DES&#x7684;&#x5BC6;&#x94A5;&#x957F;&#x5EA6;&#x6765;&#x907F;&#x514D;&#x7C7B;&#x4F3C;&#x7684;&#x653B;&#x51FB;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x8BBE;&#x8BA1;&#x4E00;&#x79CD;&#x5168;&#x65B0;&#x7684;&#x5757;&#x5BC6;&#x7801;&#x7B97;&#x6CD5;&#x3002;</p>
<p>3DES&#x662F;DES&#x52A0;&#x5BC6;&#x7B97;&#x6CD5;&#x7684;&#x4E00;&#x79CD;&#x6A21;&#x5F0F;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;3&#x6761;56&#x4F4D;&#x7684;&#x5BC6;&#x94A5;&#x5BF9; 3DES 3DES &#x6570;&#x636E;&#x8FDB;&#x884C;&#x4E09;&#x6B21;&#x52A0;&#x5BC6;&#x3002;&#x6BD4;&#x8D77;&#x524D;&#x6587;&#x63D0;&#x5230;&#x7684;DES&#xFF0C;3DES&#x66F4;&#x4E3A;&#x5B89;&#x5168;&#x3002;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/before_everything_started/" itemprop="url">
                  在一切开始之前
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-10T20:57:34+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/before_everything_started/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/before_everything_started/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>FOOLMAN&#xFF0C;&#x201C;&#x751F;&#x6D3B;&#x5728;&#x7AE5;&#x8BDD;&#x4E16;&#x754C;&#x4E2D;&#x7684;&#x7406;&#x60F3;&#x4E3B;&#x4E49;&#x8005;&#x201D;&#x2013;&#x5728;&#x4E00;&#x5207;&#x5F00;&#x59CB;&#x4E4B;&#x524D;</p>
</blockquote>
<p>&#x4E4B;&#x524D;&#x81EA;&#x5DF1;&#x7684;WP&#x535A;&#x5BA2;&#x56E0;&#x4E3A;&#x540E;&#x53F0;&#x603B;&#x662F;&#x65E0;&#x7F18;&#x65E0;&#x6545;&#x6253;&#x4E0D;&#x5F00;&#xFF0C;&#x88C5;&#x4E86;DISABLE GOOGLE FONT&#x63D2;&#x4EF6;&#x4E5F;&#x662F;&#x6CA1;&#x6709;&#x6539;&#x5584;&#xFF0C;&#x7528;CHROME&#x7684;DEVELOPER TOOLS&#x4E5F;&#x6CA1;&#x53D1;&#x73B0;&#x4EC0;&#x4E48;&#x4E0D;&#x59A5;&#xFF0C;&#x867D;&#x7136;&#x6709;&#x5904;&#x5973;[&#x5EA7;]&#x60C5;&#x8282;&#x7684;&#x6211;&#x5E94;&#x8BE5;&#x4E00;&#x7A76;&#x5230;&#x5E95;&#xFF0C;&#x4F46;&#x662F;&#x8FD8;&#x662F;&#x89C9;&#x5F97;KEEP THINGS SIMPLE&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#xFF0C;&#x9677;&#x5728;&#x590D;&#x6742;&#x7684;&#x4E8B;&#x60C5;&#x91CC;&#x9762;&#xFF0C;&#x81EA;&#x5DF1;&#x4E5F;&#x53D8;&#x5F97;&#x590D;&#x6742;&#x4E86;&#x3002;</p>
<p>&#x7136;&#x540E;&#x60F3;&#x5230;&#x4E86;&#x201C;&#x7EAF;&#x9759;&#x6001;&#x535A;&#x5BA2;&#x201D;&#xFF0C;&#x52A0;&#x4E0A;&#x81EA;&#x5DF1;&#x7684;&#x963F;&#x91CC;&#x4E91;&#x901F;&#x5EA6;&#x8FD8;&#x4E0D;&#x9519;&#xFF0C;&#x5C31;&#x5F00;&#x59CB;&#x641E;&#x4E86;&#x3002;</p>
<p>&#x5148;&#x8BF4;&#x8FD9;&#x4E2A;HEXO&#xFF0C;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x662F;&#x552F;&#x4E00;&#x7684;&#x65B9;&#x6848;&#xFF0C;&#x53EA;&#x662F;&#x6BD4;&#x8F83;&#x6D41;&#x884C;&#xFF0C;&#x5927;&#x5BB6;&#x53EF;&#x4EE5;&#x81EA;&#x7531;&#x9009;&#x62E9;&#x5176;&#x4ED6;&#x65B9;&#x5F0F;&#x642D;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x9759;&#x6001;&#x535A;&#x5BA2;&#xFF0C;&#x9759;&#x6001;&#x6709;&#x4EC0;&#x4E48;&#x597D;&#x7684;&#xFF1F;&#x901F;&#x5EA6;&#x98DE;&#x5FEB;&#xFF01;&#x8FD8;&#x6709;&#x5462;&#xFF1F;&#x8FD9;&#x4E2A;&#x7406;&#x7531;&#x8FD8;&#x4E0D;&#x591F;&#x4E48;&#xFF1F;</p>
<p>&#x5F00;&#x59CB;&#x6B65;&#x9AA4;&#xFF0C;&#x8BF7;&#x89C1;<a href="">&#x8FD9;&#x91CC;</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/from_wordpress_to_hexo/" itemprop="url">
                  从WordPress迁移到HEXO
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-10T19:56:40+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/from_wordpress_to_hexo/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/from_wordpress_to_hexo/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>FOOLMAN&#x559C;&#x6B22;&#x7B80;&#x5355;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x867D;&#x7136;&#x4E3A;&#x4E86;&#x8FBE;&#x5230;&#x7B80;&#x5355;&#x76EE;&#x6807;&#xFF0C;&#x4ED8;&#x51FA;&#x7684;&#x4EE3;&#x4EF7;&#x5374;&#x662F;&#x590D;&#x6742;&#x65E0;&#x6BD4;</p>
</blockquote>
<h2 id="&#x6587;&#x7AE0;&#x66F4;&#x65B0;"><a href="#&#x6587;&#x7AE0;&#x66F4;&#x65B0;" class="headerlink" title="&#x6587;&#x7AE0;&#x66F4;&#x65B0;"></a>&#x6587;&#x7AE0;&#x66F4;&#x65B0;</h2><p>20160310-&#x521D;&#x6B21;&#x6210;&#x6587;<br>20160704-&#x5DF2;&#x7ECF;&#x8FC7;&#x53BB;&#x4E86;4&#x4E2A;&#x6708;&#xFF0C;&#x66F4;&#x65B0;&#x4E86;MAC&#x4E0B;&#x7684;HEXO&#x5B89;&#x88C5;&#x65B9;&#x6CD5;</p>
<p>WordPress&#x786E;&#x5B9E;&#x662F;&#x4E2A;&#x4F18;&#x79C0;&#x7684;&#x535A;&#x5BA2;&#x7CFB;&#x7EDF;&#xFF0C;&#x4F46;&#x662F;&#x5374;&#x8D8A;&#x6765;&#x8D8A;&#x81C3;&#x80BF;&#xFF0C;&#x5E73;&#x5FC3;&#x800C;&#x8BBA;&#xFF0C;&#x5982;&#x679C;&#x8EAB;&#x5728;&#x5899;&#x5916;&#xFF0C;&#x80AF;&#x5B9A;&#x4F1A;&#x4E00;&#x76F4;&#x7528;&#x4E0B;&#x53BB;&#xFF0C;&#x8C01;&#x60F3;&#x5929;&#x5929;&#x6CA1;&#x4E8B;&#x597D;&#x597D;&#x65E5;&#x5B50;&#x4E0D;&#x8FC7;&#x778E;&#x6298;&#x817E;&#x5462;&#x3002;&#x5728;&#x4E0D;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x603B;&#x770B;&#x5230;&#x7F51;&#x4E0A;&#x6709;&#x4E00;&#x4E9B;&#x535A;&#x5BA2;&#x4E0B;&#x9762;&#x5199;&#x7740;&#x4E00;&#x53E5;&#x8BDD;&#x201C;&#x7531;HEXO&#x5F3A;&#x529B;&#x9A71;&#x52A8;&#x201D;&#x3002;&#x5FC3;&#x60F3;&#x8FD9;&#x662F;&#x4EC0;&#x4E48;&#x9B3C;&#xFF1F;&#x4E0D;&#x8FC7;&#x5C31;&#x5728;&#x4E4B;&#x524D;WordPress&#x518D;&#x6B21;&#x8FDB;&#x4E0D;&#x53BB;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x8FD8;&#x662F;&#x51B3;&#x5B9A;&#x6362;&#x4E2A;&#x535A;&#x5BA2;&#x7CFB;&#x7EDF;&#x5427;&#xFF0C;&#x5927;&#x6982;&#x77E5;&#x9053;HEXO&#x662F;&#x4EC0;&#x4E48;&#xFF0C;&#x7EAF;&#x9759;&#x6001;&#x535A;&#x5BA2;&#xFF0C;&#x4E00;&#x756A;&#x4E86;&#x89E3;&#x4E4B;&#x540E;&#xFF0C;&#x53D1;&#x73B0;&#x8FD9;&#x4E2A;&#x4E1C;&#x897F;&#x7B80;&#x7EA6;&#x5374;&#x4E0D;&#x7B80;&#x5355;&#x3002;</p>
<p>&#x4ECA;&#x5929;&#x5728;&#x4E0A;&#x73ED;&#x7684;&#x8DEF;&#x4E0A;&#x6211;&#x8FD8;&#x5728;&#x60F3;&#xFF0C;&#x4E5F;&#x8BB8;&#x8FC7;&#x4E0D;&#x4E86;&#x591A;&#x4E45;&#xFF0C;HEXO&#x5C31;&#x4F1A;&#x53D8;&#x5F97;&#x81C3;&#x80BF;&#xFF0C;&#x4E5F;&#x8BB8;&#x5C31;&#x6709;&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x66F4;&#x52A0;&#x7B80;&#x5355;&#x7684;&#x535A;&#x5BA2;&#x6846;&#x67B6;&#x51FA;&#x73B0;&#xFF0C;&#x4E0D;&#x8FC7;&#x7BA1;&#x4ED6;&#x5462;&#xFF0C;&#x6298;&#x817E;&#x4E00;&#x4E0B;&#x6CA1;&#x574F;&#x5904;&#x3002;</p>
<blockquote>
<p>&#x6211;&#x559C;&#x6B22;&#x5199;&#x6D41;&#x6C34;&#x8D26;&#x4F3C;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x89C9;&#x5F97;&#x53EA;&#x6709;&#x81EA;&#x5DF1;&#x6D88;&#x5316;&#x4E86;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x5199;&#x51FA;&#x6765;&#x7684;&#x5FC3;&#x5F97;&#xFF0C;&#x624D;&#x80FD;&#x662F;&#x7CBE;&#x534E;&#xFF0C;&#x624D;&#x503C;&#x5F97;&#x8BB0;&#x5F55;&#x3002;</p>
</blockquote>
<p>&#x53EF;&#x80FD;&#x81EA;&#x5DF1;&#x5199;&#x4F5C;&#x4E60;&#x60EF;&#x4E0D;&#x597D;&#xFF0C;&#x7ECF;&#x5E38;&#x5077;&#x61D2;&#xFF0C;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x5C31;&#x7B97;&#x8BB0;&#x4E0B;&#x6765;&#x4E86;&#xFF0C;&#x4E5F;&#x662F;&#x968F;&#x624B;&#x6254;&#x5728;&#x5370;&#x8C61;&#x7B14;&#x8BB0;&#x4E2D;&#xFF0C;&#x61D2;&#x5F97;&#x6574;&#x7406;&#x4E86;&#x3002;&#x4E0D;&#x8FC7;&#x65E2;&#x7136;&#x6709;&#x4E86;&#x8FD9;&#x4E2A;&#x5951;&#x673A;&#xFF0C;&#x53EF;&#x4EE5;&#x9002;&#x5F53;&#x6574;&#x7406;&#x4E00;&#x4E0B;&#x4E86;&#x3002;</p>
<h2 id="&#x672C;&#x6587;&#x8BB2;&#x7684;&#x662F;&#x4EC0;&#x4E48;"><a href="#&#x672C;&#x6587;&#x8BB2;&#x7684;&#x662F;&#x4EC0;&#x4E48;" class="headerlink" title="&#x672C;&#x6587;&#x8BB2;&#x7684;&#x662F;&#x4EC0;&#x4E48;"></a>&#x672C;&#x6587;&#x8BB2;&#x7684;&#x662F;&#x4EC0;&#x4E48;</h2><p>&#x4E3B;&#x8981;&#x662F;WINDOWS&#x7528;&#x6237;&#x5982;&#x4F55;&#x5728;&#x672C;&#x5730;&#x4E0A;&#x8C03;&#x8BD5;&#xFF0C;&#x5E76;&#x4E14;&#x4E0A;&#x4F20;&#x5230;GITHUB&#x514D;&#x8D39;&#x7A7A;&#x95F4;&#xFF0C;&#x672C;&#x6765;&#x6211;&#x7684;&#x76EE;&#x6807;&#x662F;&#x4E0A;&#x4F20;&#x5230;&#x963F;&#x91CC;&#x4E91;&#x7684;&#xFF0C;&#x6298;&#x817E;&#x4E86;&#x4E24;&#x5929;&#x4E86;&#xFF0C;&#x53D1;&#x73B0;&#x8981;&#x603B;&#x7ED3;&#x7684;&#x4E1C;&#x897F;&#x592A;&#x591A;&#x4E86;&#xFF0C;&#x518D;&#x4E0D;&#x53CA;&#x65F6;&#x5199;&#x6210;&#x5E16;&#x5B50;&#xFF0C;&#x5C31;&#x8981;&#x5FCD;&#x4E0D;&#x4E86;&#x4E86;&#xFF0C;&#x4E0D;&#x662F;&#x6211;&#x5FCD;&#x4E0D;&#x4E86;&#xFF0C;&#x800C;&#x662F;&#x5370;&#x8C61;&#x7B14;&#x8BB0;&#x5FCD;&#x4E0D;&#x4E86;&#x6211;&#x4E86;&#xFF08;&#x6761;&#x76EE;&#x592A;&#x591A;&#x3001;&#x592A;&#x4E71;&#xFF09;&#x3002;</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/post/from_wordpress_to_hexo/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/use_awesome_to_tile_all_windows_on_windows/" itemprop="url">
                  Windows下的awesome让所有窗口平铺沾满桌面的工具bug.n
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-14T11:11:21+08:00" content="2016-01-14">
              2016-01-14
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/use_awesome_to_tile_all_windows_on_windows/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/use_awesome_to_tile_all_windows_on_windows/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x5E73;&#x94FA;&#x5F0F;&#x7A97;&#x53E3;&#x7BA1;&#x7406;&#x5668;"><a href="#&#x5E73;&#x94FA;&#x5F0F;&#x7A97;&#x53E3;&#x7BA1;&#x7406;&#x5668;" class="headerlink" title="&#x5E73;&#x94FA;&#x5F0F;&#x7A97;&#x53E3;&#x7BA1;&#x7406;&#x5668;"></a>&#x5E73;&#x94FA;&#x5F0F;&#x7A97;&#x53E3;&#x7BA1;&#x7406;&#x5668;</h2><blockquote>
<p>&#x603B;&#x6709;&#x4E00;&#x4E9B;&#x4E1C;&#x897F;&#x662F;&#x4F60;&#x81EA;&#x5DF1;&#x4E0D;&#x77E5;&#x9053;&#x662F;&#x5426;&#x9700;&#x8981;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x770B;&#x5230;&#x7684;&#x90A3;&#x4E00;&#x5239;&#x90A3;&#xFF0C;&#x5C31;&#x89C9;&#x5F97;&#x76F8;&#x89C1;&#x6068;&#x665A;&#x7684;&#x3002;</p>
</blockquote>
<p>&#x56E0;&#x4E3A;&#x66FE;&#x7ECF;&#x5728;&#x77E5;&#x4E4E;&#x4E0A;&#xFF0C;&#x770B;&#x5230;&#x73A9;&#x591A;&#x5C4F;&#x7684;&#x4EBA;&#x4ECB;&#x7ECD;&#x8FC7;awesome&#xFF0C;&#x5C31;&#x4E00;&#x76F4;&#x5BFB;&#x627E;windows&#x4E0B;&#x80FD;&#x7528;&#x7684;&#x7C7B;&#x4F3C;&#x8F6F;&#x4EF6;&#xFF0C;&#x7ED3;&#x679C;&#x627E;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x540D;&#x53EB;bug.n&#x7684;&#x5C0F;&#x8F6F;&#x4EF6;&#xFF08;&#x540D;&#x5B57;&#x662F;&#x4E0D;&#x662F;&#x5F88;&#x62D7;&#x53E3;&#xFF1F;&#xFF09;&#x3002;</p>
<p>&#x8F6F;&#x4EF6;&#x5728;GITHUB&#x4E0A;&#xFF0C;&#x8BE6;&#x89C1;<a href="https://github.com/fuhsjr00/bug.n" target="_blank" rel="external">&#x8FD9;&#x91CC;</a></p>
<p>&#x5148;&#x770B;&#x4E00;&#x4E0B;&#x6211;&#x81EA;&#x5DF1;&#x5F00;&#x542F;bug.n&#x540E;&#x684C;&#x9762;&#x7684;&#x7A97;&#x53E3;&#x5E03;&#x5C40;&#xFF1A;</p>
<p><img src="http://7xrpbc.com1.z0.glb.clouddn.com/img_569711fb30fc5.png" alt=""></p>
<p>&#x503C;&#x5F97;&#x4E00;&#x63D0;&#x7684;&#x662F;&#xFF0C;&#x7A97;&#x53E3;&#x9876;&#x7AEF;&#x8FD8;&#x6709;&#x4E00;&#x4E2A;banner&#xFF0C;&#x663E;&#x793A;&#x7684;&#x4FE1;&#x606F;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>&#x865A;&#x62DF;&#x684C;&#x9762;&#x5217;&#x8868;</li>
<li>&#x5F53;&#x524D;&#x865A;&#x62DF;&#x684C;&#x9762;&#x4F7F;&#x7528;&#x4EC0;&#x4E48;&#x5E03;&#x5C40;</li>
<li>&#x6D3B;&#x52A8;&#x7A97;&#x53E3;&#x7684;&#x6807;&#x9898;</li>
<li>&#x65E5;&#x671F;&#x65F6;&#x95F4;</li>
</ul>
<p>bug.n&#x652F;&#x6301;&#x865A;&#x62DF;&#x684C;&#x9762;&#x3002;Windows&#x7CFB;&#x7EDF;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x684C;&#x9762;&#xFF0C;&#x4F46;&#x901A;&#x8FC7;bug.n&#x53EF;&#x4EE5;&#x865A;&#x62DF;&#x51FA;&#x5F88;&#x591A;&#x684C;&#x9762;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6B63;&#x5728;&#x4E00;&#x4E2A;&#x684C;&#x9762;&#x4E0A;&#x73A9;&#x6E38;&#x620F;&#x6216;&#x770B;&#x789F;&#xFF0C;&#x770B;&#x5230;&#x8001;&#x677F;&#x6765;&#x4E86;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x8FC5;&#x901F;&#x5207;&#x6362;&#x5230;&#x65E9;&#x5C31;&#x51C6;&#x5907;&#x597D;&#x7684;&#x5DE5;&#x4F5C;&#x684C;&#x9762;&#x3002;&#x8001;&#x677F;&#x5728;&#x4EFB;&#x52A1;&#x680F;&#x4E0A;&#x4E0D;&#x4F1A;&#x53D1;&#x73B0;&#x4EFB;&#x4F55;&#x4F60;&#x5A31;&#x4E50;&#x8FC7;&#x7684;&#x86DB;&#x4E1D;&#x9A6C;&#x8FF9;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x6309;Win+&#x52A0;&#x6570;&#x5B57;n&#xFF0C;&#x53EF;&#x4EE5;&#x5207;&#x6362;&#x5230;&#x7B2C;n&#x4E2A;&#x684C;&#x9762;&#x3002;&#x7528;&#x9F20;&#x6807;&#x76F4;&#x63A5;&#x70B9;&#x51FB;banner&#x4E0A;&#x7684;&#x865A;&#x62DF;&#x684C;&#x9762;&#x6309;&#x94AE;&#x4E5F;&#x53EF;&#x4EE5;&#x3002;&#x53E6;&#x5916;&#x7528;&#x9F20;&#x6807;&#x53F3;&#x952E;&#x70B9;&#x51FB;&#x67D0;&#x4E2A;&#x865A;&#x62DF;&#x684C;&#x9762;&#xFF0C;&#x4F1A;&#x628A;&#x5F53;&#x524D;&#x7684;&#x6D3B;&#x52A8;&#x7A97;&#x53E3;&#x9001;&#x5230;&#x90A3;&#x4E2A;&#x865A;&#x62DF;&#x684C;&#x9762;&#x53BB;&#x3002;</p>
<p>&#x6BCF;&#x4E2A;&#x684C;&#x9762;&#x652F;&#x6301;&#x4E09;&#x79CD;&#x5E03;&#x5C40;&#x6A21;&#x5F0F;&#xFF1A;</p>
<ul>
<li>&#x5E73;&#x94FA;&#x6A21;&#x5F0F;(tiling): &#x6240;&#x6709;&#x7A97;&#x53E3;&#x5E73;&#x94FA;&#xFF0C;&#x5DE6;&#x8FB9;&#x662F;&#x4E3B;&#x7A97;&#x53E3;&#xFF0C;&#x53F3;&#x8FB9;&#x662F;&#x7A97;&#x53E3;&#x961F;&#x5217;&#x3002;&#x6309; Win+t &#x53EF;&#x4EE5;&#x5207;&#x6362;&#x5230;tiling&#x6A21;&#x5F0F;&#x3002;</li>
<li>&#x6D6E;&#x52A8;&#x6A21;&#x5F0F;(floating): &#x6240;&#x6709;&#x7A97;&#x53E3;&#x6D6E;&#x52A8;&#xFF0C;&#x53EF;&#x4EE5;&#x4E92;&#x76F8;&#x906E;&#x76D6;&#xFF0C;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x5E73;&#x5E38;&#x7528;&#x7684;&#x6A21;&#x5F0F;&#x3002;&#x6309; win+f&#x53EF;&#x4EE5;&#x5207;&#x6362;&#x5230;floating&#x6A21;&#x5F0F;&#x3002;</li>
<li>&#x5168;&#x5C4F;&#x6A21;&#x5F0F;(monocle): &#x6240;&#x6709;&#x7A97;&#x53E3;&#x6700;&#x5927;&#x5316;&#xFF0C;&#x4E00;&#x6B21;&#x53EA;&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x3002;&#x6309; Win+m &#x53EF;&#x4EE5;&#x5207;&#x6362;&#x5230; monocle &#x6A21;&#x5F0F;&#x3002;<br>&#x7528;&#x9F20;&#x6807;&#x53F3;&#x952E;&#x70B9;&#x51FB;banner&#x4E0A;&#x7684;&#x5E03;&#x5C40;&#x6309;&#x94AE;&#x53EF;&#x4EE5;&#x5728;&#x8FD9;&#x4E09;&#x79CD;&#x5E03;&#x5C40;&#x95F4;&#x5207;&#x6362;&#x3002;</li>
</ul>
<p>&#x901A;&#x8FC7;&#x7A97;&#x53E3;&#x952E;&#x52A0;&#x65B9;&#x5411;&#x952E;&#x53EF;&#x4EE5;&#x8C03;&#x6574;&#x4E3B;&#x7A97;&#x53E3;&#x5927;&#x5C0F;&#x548C;&#x6539;&#x53D8;&#x7A97;&#x53E3;&#x961F;&#x5217;&#xFF0C;&#x81EA;&#x5DF1;&#x8BD5;&#x8BD5;&#x5C31;&#x77E5;&#x9053;&#x3002;&#x5982;&#x679C;&#x4F60;&#x89C9;&#x5F97;&#x53D7;&#x4E0D;&#x4E86;&#x4E86;&#xFF0C;&#x6309; Win + Ctrl + q&#xFF0C;&#x53EF;&#x4EE5;&#x9000;&#x51FA;bug.n&#x3002;</p>
<p>&#x6211;&#x5728;Win10&#x4E0A;&#x7528;bug.n&#xFF0C;&#x81EA;&#x5DF1;&#x7684;&#x914D;&#x7F6E;&#x5199;&#x5728; <code>C:\Users\Administrator\AppData\Roaming\bug.n\Config.ini</code> &#x4E2D;&#x3002;</p>
<p>&#x91CD;&#x70B9;&#x4ECB;&#x7ECD;&#x4E00;&#x4E9B;&#x5E38;&#x7528;&#x7684;&#x5FEB;&#x6377;&#x952E;</p>
<p><code>Win+&#x5DE6;&#x53F3;&#x65B9;&#x5411;&#x952E;</code>&#xFF0C;&#x662F;&#x8C03;&#x6574;&#x5206;&#x5272;&#x6BD4;&#x4F8B;&#xFF0C;&#x8FD9;&#x4E2A;&#x5F88;&#x597D;&#x7528;&#xFF0C;&#x5DE6;&#x4FA7;&#x53EF;&#x4EE5;&#x8C03;&#x6574;&#x4E3A;&#x6B63;&#x597D;&#x4E00;&#x4E2A;&#x7F51;&#x9875;&#x7684;&#x5BBD;&#x5EA6;&#x3002;</p>
<p><code>Win+&#x4E0A;&#x4E0B;</code>&#xFF0C;&#x53EF;&#x4EE5;&#x8C03;&#x6574;&#x6D3B;&#x52A8;&#x7A97;&#x53E3;&#x3002;</p>
<p><code>Win+Shift+&#x4E0A;&#x4E0B;&#x952E;</code>&#xFF0C;&#x53EF;&#x4EE5;&#x8BA9;&#x6D3B;&#x52A8;&#x7A97;&#x53E3;&#x5728;&#x4E0D;&#x540C;&#x4F4D;&#x7F6E;&#x4E4B;&#x95F4;&#x8DF3;&#x8F6C;&#x3002;</p>
<p><code>Win+Shift+Enter</code>&#xFF0C;&#x8BA9;&#x5F53;&#x524D;&#x7A97;&#x53E3;&#x548C;&#x5DE6;&#x4FA7;&#x6D3B;&#x52A8;&#x4E3B;&#x7A97;&#x53E3;&#x5BF9;&#x8C03;&#x4F4D;&#x7F6E;&#x5F88;&#x65B9;&#x4FBF;&#x3002;</p>
<p><code>Win+Ctrl+q</code>&#xFF0C;&#x9000;&#x51FA;bug.n&#x3002;</p>
<p><code>Win+c</code>&#xFF0C;&#x5173;&#x95ED;&#x5F53;&#x524D;&#x7A97;&#x53E3;&#x3002;</p>
<p>&#x914D;&#x5408;Chrome&#x7684;Vimium&#xFF0C;&#x53EF;&#x4EE5;&#x63D0;&#x9AD8;&#x4E0D;&#x5C11;&#x6548;&#x7387;&#x3002;</p>
<p>&#x76EE;&#x524D;&#x6211;&#x6B63;&#x5728;&#x7814;&#x7A76;&#x7684;&#x662F;Config.ini&#x7684;&#x4E00;&#x6761;&#x89C4;&#x5219;&#xFF0C;</p>
<p><code>Config_rule=WebChat*;.*;;1;0;0;0;0;0;</code></p>
<p>&#x5C31;&#x662F;&#x6BD4;&#x5982;&#x50CF;&#x5FAE;&#x4FE1;&#x7535;&#x8111;&#x7248;&#x8FD9;&#x6837;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x5176;&#x7A97;&#x53E3;&#x7684;&#x6700;&#x5C0F;&#x662F;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x8BA9;&#x4ED6;&#x6309;&#x7167;&#x666E;&#x901A;&#x7A97;&#x53E3;&#x90A3;&#x6837;&#x6392;&#x5217;&#xFF0C;&#x57FA;&#x672C;&#x4EC0;&#x4E48;&#x4E5F;&#x770B;&#x4E0D;&#x5230;&#xFF0C;&#x76EE;&#x524D;&#x4EE3;&#x66FF;&#x7684;&#x65B9;&#x6CD5;&#x5C31;&#x662F;Win+c&#xFF0C;&#x7136;&#x540E;&#x770B;&#x5230;&#x65B0;&#x4FE1;&#x606F;&#xFF0C;Ctrl+Alt+w&#x53D6;&#x6D88;&#x606F;&#xFF0C;&#x56DE;&#x590D;&#x5B8C;&#x4E86;&#xFF0C;&#x518D;&#x5173;&#x95ED;&#x5FAE;&#x4FE1;&#xFF08;&#x6CE8;&#xFF1A;Ctrl+Alt+w&#x662F;&#x5FAE;&#x4FE1;&#x9ED8;&#x8BA4;&#x5FEB;&#x6377;&#x952E;&#xFF0C;&#x975E;bug.n&#xFF09;&#x3002;</p>
<p>&#x90E8;&#x5206;&#x6587;&#x5B57;&#x6458;&#x6284;<a href="http://www.cnblogs.com/jiqingwu/p/4311202.html" target="_blank" rel="external">http://www.cnblogs.com/jiqingwu/p/4311202.html</a></p>
<p>&#x7279;&#x6B64;&#x8BF4;&#x660E;&#x3002;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/the_summary_of_decomplation_of_c_sharp/" itemprop="url">
                  .net破解反编译资料汇总
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-11T17:10:24+08:00" content="2016-01-11">
              2016-01-11
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/the_summary_of_decomplation_of_c_sharp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/the_summary_of_decomplation_of_c_sharp/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x56FD;&#x5185;&#x7F51;&#x7AD9;</p>
<p>1&#x3001;www.52pojie.cn &#x5514;&#x7231;&#x7834;&#x89E3;</p>
<p>2&#x3001;<a href="http://www.17ky.net/" target="_blank" rel="external">http://www.17ky.net/</a> &#x5DE5;&#x5177;&#x6C47;&#x603B;</p>
<p>&#x56FD;&#x5916;&#x7F51;&#x7AD9;</p>
<p>1&#x3001;<a href="http://www.hackforum.net" target="_blank" rel="external">http://www.hackforum.net</a> &#x8457;&#x540D;&#x7684;HACK&#x8BBA;&#x575B;&#xFF0C;&#x56FD;&#x5185;IP&#x65E0;&#x6CD5;&#x8BBF;&#x95EE;&#xFF0C;&#x6302;&#x4EE3;&#x7406;&#x6216;&#x8005;VPN&#x4E5F;&#x4E0D;&#x884C;</p>
<p>2&#x3001;<a href="http://www.tuts.com" target="_blank" rel="external">http://www.tuts.com</a></p>
<p>3&#x3001;<a href="http://www.nulled.io" target="_blank" rel="external">http://www.nulled.io</a> &#x73B0;&#x5728;&#x8C8C;&#x4F3C;&#x57DF;&#x540D;&#x7F16;&#x7A0B;nulled.cr&#x4E86;&#xFF0C;&#x4E0D;&#x77E5;&#x9053;IO&#x51FA;&#x73B0;&#x4EC0;&#x4E48;&#x53D8;&#x6545;&#x4E86;</p>
<p>4&#x3001;</p>
<p>&#x6587;&#x6863;&#x3001;&#x8D44;&#x6599;</p>
<p>&#xA0;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/the_summary_of_decomplation_tools_for_c_sharp/" itemprop="url">
                  .Net反编译软件集合
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-07T12:24:15+08:00" content="2016-01-07">
              2016-01-07
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/the_summary_of_decomplation_tools_for_c_sharp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/the_summary_of_decomplation_tools_for_c_sharp/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1&#x3001;&#x67E5;&#x58F3;</p>
<p>PeID 0.95 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;115&#x201D;] &#x5B98;&#x7F51;&#xFF1A;&#x65E0;&#xFF0C;&#x5DF2;&#x7ECF;&#x505C;&#x6B62;&#x66F4;&#x65B0;</p>
<p>&#x8FD9;&#x91CC;&#x8981;&#x8BF4;&#x4E00;&#x4E0B;&#xFF0C;&#x7F51;&#x4E0A;&#x6240;&#x8C13;&#x7684;0.96&#x7248;&#x672C;&#xFF0C;&#x5E94;&#x8BE5;&#x4E0D;&#x662F;&#x539F;&#x4F5C;&#x8005;&#x7684;&#x4F5C;&#x54C1;&#xFF0C;&#x622A;&#x56FE;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="http://www.wuliaole.com/wp-content/uploads/2016/01/img_56934c3b33ebb.png" alt=""></p>
<p>0.95&#x7248;&#x672C;&#xFF0C;&#x5927;&#x5C0F;213KB&#xFF0C;&#x6240;&#x8C13;&#x7684;0.96&#xFF0C;&#x5927;&#x5C0F;&#x5C31;&#x8D85;&#x8FC7;1M&#x4E86;&#xFF0C;&#x5E76;&#x4E14;&#x6253;&#x5F00;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x817E;&#x8BAF;&#x7BA1;&#x5BB6;&#x62A5;&#x6BD2;&#x201C;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x201D;&#xFF0C;&#x5404;&#x4F4D;&#x5C0F;&#x5FC3;&#x4E3A;&#x5999;&#x3002;</p>
<p>Exeinfo PE 0.0.4.1 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;150&#x201D;] &#x5B98;&#x65B9;&#x7F51;&#x7AD9;&#xFF1A;<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>Dot Net ID &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;154&#x201D;] &#x5B98;&#x65B9;&#x7F51;&#x7AD9;&#xFF1A;<a href="http://rongchaua.net&#xFF0C;&#x7F51;&#x7AD9;404" target="_blank" rel="external">http://rongchaua.net&#xFF0C;&#x7F51;&#x7AD9;404</a></p>
<p>2&#x3001;&#x8131;&#x58F3;</p>
<p>.NET Generic Unpacker(x86) &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;144&#x201D;] &#x5B98;&#x65B9;&#x7F51;&#x7AD9;&#xFF1A;<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>.NET Generic Unpacker(x64) &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;147&#x201D;] &#x5B98;&#x65B9;&#x7F51;&#x7AD9;&#xFF1A;<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>DNGuard HVM Unpacker 3.71 trial support</p>
<p><img src="http://www.wuliaole.com/wp-content/uploads/2016/01/img_569370433c050.png" alt=""></p>
<p>SAE 1.14 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;122&#x201D;]</p>
<p>.NET REFLECTOR 8.3.3.115 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;127&#x201D;]</p>
<p>ILSpy_Master_2.3.1.1855 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;132&#x201D;]</p>
<p>Telerik Just Decompile 2015.3.1116.1 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;141&#x201D;]</p>
<p>dnSpy 1.5.0.0 &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;[download id=&#x201D;161&#x201D;]</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/use_turbotop_to_keep_applications_topmost/" itemprop="url">
                  使用TurboTop保持Windows上任意程序保持最前端
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-18T10:32:13+08:00" content="2015-12-18">
              2015-12-18
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/use_turbotop_to_keep_applications_topmost/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/use_turbotop_to_keep_applications_topmost/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x6709;&#x65F6;&#x5019;&#x4F60;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x628A;&#x67D0;&#x4E2A;&#x5E94;&#x7528;&#x7A97;&#x53E3;&#x4FDD;&#x6301;&#x5728;&#x6700;&#x524D;&#x7AEF;&#xFF0C;&#x6BD4;&#x5982;&#x5904;&#x7406;&#x8868;&#x5355;&#x6570;&#x636E;&#x7684;&#x65F6;&#x5019;&#x5C06;&#x8BA1;&#x7B97;&#x5668;&#x653E;&#x5728;&#x6700;&#x524D;&#x9762;&#x3002;<strong>TurboTop</strong> &#x8FD9;&#x6B3E;&#x514D;&#x8D39;PC&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x8BA9;&#x4EFB;&#x610F;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x5E94;&#x7528;&#x7A97;&#x53E3;&#x4FDD;&#x6301;&#x5728;&#x6700;&#x524D;&#x7AEF;&#x3002;</p>
<p>&#x8FD0;&#x884C;&#x540E;&#x70B9;&#x51FB;&#x6258;&#x76D8;&#x533A;&#x56FE;&#x6807;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x5E94;&#x7528;&#x5217;&#x8868;&#xFF0C;&#x52FE;&#x9009;&#x67D0;&#x4E2A;&#x5E94;&#x7528;&#xFF0C;&#x6B64;&#x5E94;&#x7528;&#x5C31;&#x4F1A;&#x4FDD;&#x6301;&#x5728;&#x6700;&#x524D;&#x7AEF;&#x4E86;&#xFF0C;&#x800C;&#x4E14;&#x4F60;&#x53EF;&#x4EE5;&#x52FE;&#x9009;&#x591A;&#x4E2A;&#x5E94;&#x7528;&#x3002;</p>
<ul>
<li>&#x8F6F;&#x4EF6;&#x540D;&#x79F0;&#xFF1A; TurboTop</li>
<li>&#x652F;&#x63F4;&#x5E73;&#x53F0;&#xFF1B; Windows</li>
<li>&#x8F6F;&#x4EF6;&#x4E0B;&#x8F7D;&#xFF1A; &#x5B98;&#x7F51;<br>&#x8F6F;&#x4EF6;&#x622A;&#x56FE;<br><img src="http://pics.ikamu.me/2014/10/fqqc6i7qh1taf2cvlk7g.png" alt="fqqc6i7qh1taf2cvlk7g"></li>
</ul>
<p>&#x8F6C;&#x8F7D;&#x4E86;&#x5176;&#x4ED6;&#x4EBA;&#x7684;&#x6587;&#x5B57;&#xFF0C;&#x5F53;&#x4E2A;&#x8F6F;&#x4EF6;&#x63A8;&#x8350;&#x7ED9;&#x5927;&#x5BB6;&#x5427;&#x3002;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/how_to_use_rsa_to_protect_your_local_and_remote_communication/" itemprop="url">
                  使用RSA加密保护你的.net应用程序(winform)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-16T17:43:28+08:00" content="2015-12-16">
              2015-12-16
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/how_to_use_rsa_to_protect_your_local_and_remote_communication/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/how_to_use_rsa_to_protect_your_local_and_remote_communication/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x539F;&#x6587;&#x5730;&#x5740;&#xFF1A;<a href="http://www.codeproject.com/Articles/203840/RSA-License-Protection" target="_blank" rel="external">http://www.codeproject.com/Articles/203840/RSA-License-Protection</a></p>
<h2 id="&#x4ECB;&#x7ECD;"><a href="#&#x4ECB;&#x7ECD;" class="headerlink" title="&#x4ECB;&#x7ECD;"></a>&#x4ECB;&#x7ECD;</h2><p>&#x672C;&#x6587;&#x7684;&#x76EE;&#x7684;&#x662F;&#x901A;&#x8FC7;&#x4F7F;&#x7528;.net&#x5185;&#x7F6E;&#x7684;RSA&#x52A0;&#x5BC6;&#x7EC4;&#x4EF6;&#x5BF9;winform&#x7A0B;&#x5E8F;&#x8FDB;&#x884C;&#x7B7E;&#x540D;&#x5E76;&#x6821;&#x9A8C;&#xFF0C;&#x4EE5;&#x8FBE;&#x5230;&#x6709;&#x6548;&#x4FDD;&#x62A4;winform&#x7A0B;&#x5E8F;&#x7684;&#x76EE;&#x7684;&#x3002;</p>
<h2 id="&#x80CC;&#x666F;"><a href="#&#x80CC;&#x666F;" class="headerlink" title="&#x80CC;&#x666F;"></a>&#x80CC;&#x666F;</h2><p>&#x6240;&#x6709;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5F00;&#x53D1;&#x8005;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x54EA;&#x4E9B;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x9500;&#x552E;&#x5E76;&#x4E14;&#x5F97;&#x5230;&#x4ED8;&#x6B3E;&#x7684;&#x5F00;&#x53D1;&#x8005;&#xFF0C;&#x90FD;&#x6216;&#x591A;&#x6216;&#x5C11;&#x7684;&#x5173;&#x6CE8;&#x7A0B;&#x5E8F;&#x7684;&#x672A;&#x6388;&#x6743;&#x7684;&#x5206;&#x53D1;&#x95EE;&#x9898;&#x3002;&#x56E0;&#x4E3A;&#x65E0;&#x8BBA;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#xFF0C;&#x7A0B;&#x5E8F;&#x90FD;&#x5B58;&#x5728;&#x88AB;&#x7834;&#x89E3;&#xFF08;&#x6216;&#x53CD;&#x7F16;&#x8BD1;&#xFF09;&#x7684;&#x53EF;&#x80FD;&#x6027;&#xFF0C;&#x603B;&#x6709;&#x4EBA;&#x4E0D;&#x60F3;&#x82B1;&#x94B1;&#x53BB;&#x4E70;&#x4F60;&#x7684;&#x8F6F;&#x4EF6;&#x3002;&#x800C;&#x4F60;&#x9700;&#x8981;&#x660E;&#x767D;&#x7684;&#x4E00;&#x4E2A;&#x4E8B;&#x5B9E;&#x662F;&#xFF0C;&#x65E0;&#x8BBA;&#x4F60;&#x5982;&#x4F55;&#x52A0;&#x5BC6;&#x8F6F;&#x4EF6;&#xFF0C;&#x8F6F;&#x4EF6;&#x90FD;&#x5B58;&#x5728;&#x88AB;&#x7834;&#x89E3;&#x548C;&#x53CD;&#x7F16;&#x8BD1;&#x7684;&#x4E8B;&#x5B9E;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x52A0;&#x5BC6;&#x7684;&#x76EE;&#x7684;&#xFF0C;&#x5E76;&#x4E0D;&#x662F;&#x4E3A;&#x4E86;&#x9632;&#x6B62;&#x53CD;&#x7F16;&#x8BD1;&#x6216;&#x8005;&#x7834;&#x89E3;&#xFF0C;&#x800C;&#x662F;&#x52A0;&#x5927;&#x7834;&#x89E3;&#x7684;&#x96BE;&#x5EA6;&#xFF0C;&#x8BA9;&#x5927;&#x591A;&#x6570;&#x4EBA;&#x89C9;&#x5F97;&#x8D2D;&#x4E70;&#x4F60;&#x7684;&#x8F6F;&#x4EF6;&#xFF0C;&#x6BD4;&#x5BFB;&#x627E;&#x7834;&#x89E3;&#x7248;&#x66F4;&#x52A0;&#x5BB9;&#x6613;&#x3002;&#x5E76;&#x4E14;&#x6700;&#x91CD;&#x8981;&#x7684;&#x4E00;&#x70B9;&#xFF0C;&#x5C31;&#x662F;&#x7A0B;&#x5E8F;&#x5458;&#x9700;&#x8981;&#x82B1;&#x8D39;&#x66F4;&#x591A;&#x7684;&#x7CBE;&#x529B;&#xFF0C;&#x53BB;&#x5B8C;&#x5584;&#x8F6F;&#x4EF6;&#xFF0C;&#x63D0;&#x5347;&#x670D;&#x52A1;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x914D;&#x5957;&#x7684;&#xFF0C;&#x552E;&#x540E;&#x7684;&#x670D;&#x52A1;&#x8D28;&#x91CF;&#xFF0C;&#x8BA9;&#x987E;&#x5BA2;&#x89C9;&#x5F97;&#x5FC3;&#x7518;&#x60C5;&#x613F;&#x8D2D;&#x4E70;&#x4F60;&#x7684;&#x8F6F;&#x4EF6;&#xFF0C;&#x6216;&#x8005;&#x66F4;&#x786E;&#x5207;&#x7684;&#xFF0C;&#x662F;&#x8D2D;&#x4E70;&#x4F60;&#x7684;&#x670D;&#x52A1;&#xFF01;&#x7136;&#x540E;&#xFF0C;&#x518D;&#x56DE;&#x5934;&#x6765;&#x8BA8;&#x8BBA;&#x4E0B;&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;&#x7684;&#x6700;&#x521D;&#x76EE;&#x7684;&#xFF0C;&#x5C31;&#x662F;&#x4F60;&#x7684;&#x7A0B;&#x5E8F;&#xFF0C;&#x5E94;&#x5F53;&#xFF0C;&#x4E5F;&#x5E94;&#x8BE5;&#x6821;&#x9A8C;&#x7528;&#x6237;&#x7684;&#x5408;&#x6CD5;&#x6027;&#xFF0C;&#x6BD5;&#x7ADF;&#x4F60;&#x662F;&#x9700;&#x8981;&#x8D5A;&#x94B1;&#x7684;&#xFF01;  The best bit of programming you can do to secure your program is to make the program actually valuable to the user, so they <em>want</em> to buy it. But, the next best thing is a mechanism by which you can use to correctly identify valid users of the program. There is no end to these methods, and they all have varying levels of security, administration overhead, and user-annoyance. Here are some of the common methods:</p>
<h3 id="Serial-Number-Protection"><a href="#Serial-Number-Protection" class="headerlink" title="Serial Number Protection"></a>Serial Number Protection</h3><p>Found on the back of a CD case, the most common copy-protection you can find often involves a long serial number that is derived from an algorithm, such that only the original key-generator can produce valid keys. Often, the first few characters define a seed entry for a pseudo-random-number generator, and the remaining characters must match the transformed output of that number generator. This has a number of drawbacks:</p>
<ol>
<li>It is a blanket authorization: Usernames and License-end terms, partial licenses cannot be specified</li>
<li>All you need is a copy of the serial-number: there are hundreds of websites that list known serial numbers for almost any bit of commercial software.</li>
<li>The user has to type in a long annoying and difficult to read serial number in order to install the software.</li>
</ol>
<h3 id="Online-Activation"><a href="#Online-Activation" class="headerlink" title="Online Activation"></a>Online Activation</h3><p>An extension of serial-number protection: the application contacts a central server to validate that the serial-number is one that has been issued. This allows serial numbers to be blacklisted, tracked, etc. The main drawback is that the application must have internet access in order to validate the serial number. Users will probably not be happy about this (especially if they don&#x2019;t have constant internet access) and you may find hackers patching your software not to illegally copy it, but just to get it to work offline. The other drawback is the amount of coding and development work that must go into a system like this that could be defeated by a proxy-server that simulates the responses of your own validation server.</p>
<h3 id="License-Terms-File"><a href="#License-Terms-File" class="headerlink" title="License Terms File"></a>License Terms File</h3><p>Many systems use a license file that is supplied to the user with their purchase. The license file specifies the licensee (the user&#x2019;s name, address, contact details, etc.), the product being licensed, and the start and end dates of that license. The software asks for the license file on first use, copies it into a known location, then validates that the terms of the license are valid (correct software version, within the applicable date-range, etc.).</p>
<p>The trick here is to ensure that the license file that is supplied is authentic, if that part is covered, this is an excellent system for licensing: the license terms can be as simple or complex as you like (i.e. blanket authorization, or partial (certain features enabled)), they can have start and end dates, be restricted to particular applications or even restricted to particular users. The user isn&#x2019;t forced to type in a long and complex serial-number, and having the users name and contact details embedded within the terms makes it less likely that users will voluntarily share the license file.</p>
<h3 id="Authenticating-the-License-File"><a href="#Authenticating-the-License-File" class="headerlink" title="Authenticating the License File"></a>Authenticating the License File</h3><p>There is a branch of cryptography that deals with verification (or signing) of data, using Asymmetrical Encryption.</p>
<p>A digital signature is produced from the data being verified by generating a hash-code from the source data, and encrypting this hash with a private key.<br>The hash code will be unique to the source data&#x2026; if even one bit in the source data changes, the resulting hashcode will be quite different. (The &#x201C;strength&#x201D; of any hashing algorithm is indicated by how much the hash-code changes with the smallest possible edit of the source data).</p>
<p>Verification of the data is achieved by using the public-part of the key to check if the digital signature (the encrypted hash) still matches the data that is being verified. If any part of the data is changed, then the digital signature will not match.</p>
<p>This means that you can verify that the license file the system is using definitely came from you, (the sellers of the software) without having to give the application access to the private key. If you were to use symmetrical encryption to encrypt the license-terms (so they could not be seen or changed), then the application itself would need access to the encryption key, in order to decrypt the file. The key could be found within the application EXE and extracted, allowing pirates to generate their own license files.</p>
<p>Using asymmetrical encryption still requires that the application have access to the public part of the key, but knowing the public part of the key will not help anyone trying to hack the system.</p>
<p>The danger lies in pirates being able to replace or intercept the public key with one of their own making. This would require them to get into the <em>.exe</em> and alter the sequence of bytes that defines the public-key (whether it is a string-literal or a resource within the EXE).</p>
<p>This is beyond the scope I have given myself for this article, but just a quick mention:<br>signing the executable itself is one potential way of trying to stop this: modification of the executable will generate a different signature, and the application can be instructed not to open. (This is how the click-once manifests work, in fact, using click-once to deploy your application makes it (almost) impossible to modify that application without regenerating the click-once manifest file.)</p>
<h2 id="&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4EE3;&#x7801;"><a href="#&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4EE3;&#x7801;" class="headerlink" title="&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4EE3;&#x7801;"></a>&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4EE3;&#x7801;</h2><p>The logic for the licensing system is contained within the <code>General.Security</code>namespace within the example project: this code is non-specific and portable (it doesn&#x2019;t reference any custom types outside the <code>General</code>namespace) and the two files (<em>Serializer.cs</em> and <em><span class="search-highlight">RSA</span>.cs</em>) can be moved to any project without change. The actual implementation of the licensing system (i.e. project specific code) is contained within the<code>validateLicenseFile()</code>method of the <code>static Program</code> class. This provides a good example of using the methods defined in the <code>General.Security</code>namespace. The <code>Program.validateLicenseFile()</code>method reads the <code>public</code>key out of the embedded resource (<em>Resources.resx</em>) and locates the license file (asking the user for the location if it can&#x2019;t find it). It verifies the license file signature is correct, then extracts the license-terms, de-serializes them and checks that the current software and date/time is within the terms on the license. Supplied is an example license file (valid until the year 9999) for user &#x201C;<code>Test</code>&#x201C; (<em>Test.lic</em>) - The public and private key files used to generate this license are also included.</p>
<p>This is the <code>validateLicense</code>method:</p>
<p><pre class="lang:c# decode:true ">/// validate the user-license.<br>internal static bool validateLicenseFile()<br>{<br>    try<br>    {<br>        // reserve a license object:<br>        License license = null;</pre></p>
<pre><code>    // get the public key from internal resource:
    String publicKey = Properties.Resources.publicKey;

    // work out the expected license file-name:
    String licenseFile = Application.LocalUserAppDataPath + &quot;\\&quot; + 
                Environment.UserName + &quot;_user.lic&quot;;

    // does the license file exist?
    if (File.Exists(licenseFile))
    {
        // load the license:
        license = License.Load(licenseFile);
    }
    else
    {
        // prompt the user for a license file:
        OpenFileDialog dlg = new OpenFileDialog();

        // setup a dialog;
        dlg.Filter = &quot;User License Files (*.lic)|*.lic&quot;;
        dlg.Title = &quot;Select License File&quot;;

        if (dlg.ShowDialog() == DialogResult.OK)
        {
            try
            {
                // copy the license file into the local app data directory:
                File.Copy(dlg.FileName, licenseFile);

                // if it made it here, load it:
                if (File.Exists(licenseFile))
                {
                    license = License.Load(licenseFile);
                }
            }
            catch
            {
                // can&apos;t copy the file?.. load the original:
                license = License.Load(dlg.FileName);
            }
        }
    }
    if (license != null)
    {
        // validate the signature on the license with the message contents, 
        // and the public key:
        LicenseAuthorization.ValidateLicense(license, publicKey);

        // if we get here, the license is valid;
        return true;
    }
    else
    {
        // no license file...
        MessageBox.Show(&quot;License File Not Supplied!&quot;, &quot;License Check&quot;);
        return false;
    }
}
catch (SecurityException se)
{
    // display the reason for the license check failure:
    MessageBox.Show(se.Message, &quot;License Check&quot;);
}

// return false...invalid license.
return false;
}
</code></pre><p>}</p>
<div id="contentdiv" class="text"><br><br>## Points of Interest<br><br>Something I discovered while doing the research for this: You can convert an array of bytes to a printable <code>string</code>using <code>Convert.ToBase64String()</code>. The result <code>string</code>always contains printable ASCII characters, and it is definitely not human-readable. The <code>LicenseTerms</code>class for this article, (which contains the start date, end date, product name, user name, etc.) is stored in the license file (which is XML) as a <code>string</code>. The <code>string</code>is created by serializing the licence-terms class to a byte-array using the binary-formatter. This doesn&#x2019;t encrypt the license terms by any means, but it makes it much harder to read, and it also makes it easy to deal with (no special serialization is required to save a <code>string</code>).<br><br>## &#x66F4;&#x65B0;&#x7248;&#x672C;<br><br>*   Version 1.0<br></div><br><div class="float-right"></div>

<h2 id="&#x6587;&#x7AE0;&#x6388;&#x6743;"><a href="#&#x6587;&#x7AE0;&#x6388;&#x6743;" class="headerlink" title="&#x6587;&#x7AE0;&#x6388;&#x6743;"></a>&#x6587;&#x7AE0;&#x6388;&#x6743;</h2><div id="LicenseTerms"><br><br>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" target="_blank" rel="external">The Code Project Open License (CPOL)</a><br><br></div>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/the_usage_of_hookers_in_key_code_capture_in_c_sharp/" itemprop="url">
                  C#全局键盘监听（Hook）的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-10T14:08:45+08:00" content="2015-12-10">
              2015-12-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/the_usage_of_hookers_in_key_code_capture_in_c_sharp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/the_usage_of_hookers_in_key_code_capture_in_c_sharp/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;</h2><p>&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x5FEB;&#x6377;&#x952E;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x529F;&#x80FD;&#xFF0C;&#x4F8B;&#x5982;&#x5927;&#x5BB6;&#x719F;&#x77E5;&#x7684;QQ&#x622A;&#x56FE;&#x529F;&#x80FD;Ctrl+Alt+A&#x5FEB;&#x6377;&#x952E;&#xFF0C;&#x53EA;&#x8981;QQ&#x7A0B;&#x5E8F;&#x5728;&#x8FD0;&#x884C;&#xFF08;&#x65E0;&#x8BBA;&#x662F;&#x62E5;&#x6709;&#x7126;&#x70B9;&#x8FD8;&#x662F;&#x5904;&#x4E8E;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#xFF09;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x6309;&#x4E0B;&#x5FEB;&#x6377;&#x952E;&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#x2026;</p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x6DFB;&#x52A0;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;&#x4E86;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x7126;&#x70B9;&#x4E0D;&#x5728;App&#x4E0A;&#x65F6;&#xFF08;&#x5982;&#x6700;&#x5C0F;&#x5316;&#xFF0C;&#x6216;&#x8005;&#x7528;&#x6237;&#x5728;&#x5904;&#x7406;&#x5176;&#x5B83;&#x4E8B;&#x7269;&#x7B49;&#x7B49;&#xFF09;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x5C31;&#x5931;&#x6548;&#x4E86;</p>
<h2 id="&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"><a href="#&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;" class="headerlink" title="&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"></a>&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;</h2><p>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x7528;&#x5230;Windows API&#xFF0C;&#x6E90;&#x7801;&#x5982;&#x4E0B;&#xFF1A;&#xFF08;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x7C7B;[KeyboardHook.cs]&#x6536;&#x85CF;&#x8D77;&#x6765;&#xFF09;<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Text;</div><div class="line">using System.Runtime.InteropServices;</div><div class="line">using System.Windows.Forms;</div><div class="line">using System.Reflection;</div><div class="line"></div><div class="line">namespace &#x58C1;&#x7EB8;&#x7BA1;&#x5BB6;</div><div class="line">{</div><div class="line">    /// &lt;summary&gt;</div><div class="line">    /// &#x952E;&#x76D8;&#x94A9;&#x5B50;</div><div class="line">    /// [&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x6765;&#x81EA;&#x67D0;&#x7F51;&#x53CB;&#xFF0C;&#x5E76;&#x975E;&#x672C;&#x4EBA;&#x539F;&#x521B;]</div><div class="line">    /// &lt;summary&gt;</div><div class="line">    class KeyboardHook</div><div class="line">    {</div><div class="line">        public event KeyEventHandler KeyDownEvent;</div><div class="line">        public event KeyPressEventHandler KeyPressEvent;</div><div class="line">        public event KeyEventHandler KeyUpEvent;</div><div class="line"></div><div class="line">        public delegate int HookProc(int nCode, Int32 wParam, IntPtr lParam);</div><div class="line">        static int hKeyboardHook = 0; //&#x58F0;&#x660E;&#x952E;&#x76D8;&#x94A9;&#x5B50;&#x5904;&#x7406;&#x7684;&#x521D;&#x59CB;&#x503C;</div><div class="line">        //&#x503C;&#x5728;Microsoft SDK&#x7684;Winuser.h&#x91CC;&#x67E5;&#x8BE2;</div><div class="line">		// http://www.bianceng.cn/Programming/csharp/201410/45484.htm</div><div class="line">        public const int WH_KEYBOARD_LL = 13;   //&#x7EBF;&#x7A0B;&#x952E;&#x76D8;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;2&#xFF0C;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;13</div><div class="line">        HookProc KeyboardHookProcedure; //&#x58F0;&#x660E;KeyboardHookProcedure&#x4F5C;&#x4E3A;HookProc&#x7C7B;&#x578B;</div><div class="line">        //&#x952E;&#x76D8;&#x7ED3;&#x6784;</div><div class="line">        [StructLayout(LayoutKind.Sequential)]</div><div class="line">        public class KeyboardHookStruct</div><div class="line">        {</div><div class="line">            public int vkCode;  //&#x5B9A;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x952E;&#x7801;&#x3002;&#x8BE5;&#x4EE3;&#x7801;&#x5FC5;&#x987B;&#x6709;&#x4E00;&#x4E2A;&#x4EF7;&#x503C;&#x7684;&#x8303;&#x56F4;1&#x81F3;254</div><div class="line">            public int scanCode; // &#x6307;&#x5B9A;&#x7684;&#x786C;&#x4EF6;&#x626B;&#x63CF;&#x7801;&#x7684;&#x5173;&#x952E;</div><div class="line">            public int flags;  // &#x952E;&#x6807;&#x5FD7;</div><div class="line">            public int time; // &#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x8BB0;&#x7684;&#x8FD9;&#x4E2A;&#x8BAF;&#x606F;</div><div class="line">            public int dwExtraInfo; // &#x6307;&#x5B9A;&#x989D;&#x5916;&#x4FE1;&#x606F;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;</div><div class="line">        }</div><div class="line">        //&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x5B89;&#x88C5;&#x4E86;&#x4E00;&#x4E2A;&#x94A9;&#x5B50;</div><div class="line">        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</div><div class="line">        public static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);</div><div class="line"></div><div class="line">        //&#x8C03;&#x7528;&#x6B64;&#x51FD;&#x6570;&#x5378;&#x8F7D;&#x94A9;&#x5B50;</div><div class="line">        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</div><div class="line">        public static extern bool UnhookWindowsHookEx(int idHook);</div><div class="line"></div><div class="line">        //&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x901A;&#x8FC7;&#x4FE1;&#x606F;&#x94A9;&#x5B50;&#x7EE7;&#x7EED;&#x4E0B;&#x4E00;&#x4E2A;&#x94A9;&#x5B50;</div><div class="line">        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</div><div class="line">        public static extern int CallNextHookEx(int idHook, int nCode, Int32 wParam, IntPtr lParam);</div><div class="line"></div><div class="line">        // &#x53D6;&#x5F97;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x7F16;&#x53F7;&#xFF08;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#x9700;&#x8981;&#x7528;&#x5230;&#xFF09;</div><div class="line">        [DllImport(&quot;kernel32.dll&quot;)]</div><div class="line">        static extern int GetCurrentThreadId();</div><div class="line"></div><div class="line">        //&#x4F7F;&#x7528;WINDOWS API&#x51FD;&#x6570;&#x4EE3;&#x66FF;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x5B9E;&#x4F8B;&#x7684;&#x51FD;&#x6570;,&#x9632;&#x6B62;&#x94A9;&#x5B50;&#x5931;&#x6548;</div><div class="line">        [DllImport(&quot;kernel32.dll&quot;)]</div><div class="line">        public static extern IntPtr GetModuleHandle(string name);</div><div class="line"></div><div class="line">        public void Start()</div><div class="line">        {</div><div class="line">            // &#x5B89;&#x88C5;&#x952E;&#x76D8;&#x94A9;&#x5B50;</div><div class="line">            if (hKeyboardHook == 0)</div><div class="line">            {</div><div class="line">                KeyboardHookProcedure = new HookProc(KeyboardHookProc);</div><div class="line">                hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, GetModuleHandle(System.Diagnostics.Process.GetCurrentProcess().MainModule.ModuleName), 0);</div><div class="line">                //hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]), 0);</div><div class="line">                //************************************</div><div class="line">                //&#x952E;&#x76D8;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;</div><div class="line">                //SetWindowsHookEx( 2,KeyboardHookProcedure, IntPtr.Zero, GetCurrentThreadId());//&#x6307;&#x5B9A;&#x8981;&#x76D1;&#x542C;&#x7684;&#x7EBF;&#x7A0B;idGetCurrentThreadId(),</div><div class="line">                //&#x952E;&#x76D8;&#x5168;&#x5C40;&#x94A9;&#x5B50;,&#x9700;&#x8981;&#x5F15;&#x7528;&#x7A7A;&#x95F4;(using System.Reflection;)</div><div class="line">                //SetWindowsHookEx( 13,MouseHookProcedure,Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]),0);</div><div class="line">                //</div><div class="line">                //&#x5173;&#x4E8E;SetWindowsHookEx (int idHook, HookProc lpfn, IntPtr hInstance, int threadId)&#x51FD;&#x6570;&#x5C06;&#x94A9;&#x5B50;&#x52A0;&#x5165;&#x5230;&#x94A9;&#x5B50;&#x94FE;&#x8868;&#x4E2D;&#xFF0C;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#x56DB;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;</div><div class="line">                //idHook &#x94A9;&#x5B50;&#x7C7B;&#x578B;&#xFF0C;&#x5373;&#x786E;&#x5B9A;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x4F55;&#x79CD;&#x6D88;&#x606F;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x8BBE;&#x4E3A;2&#xFF0C;&#x5373;&#x76D1;&#x542C;&#x952E;&#x76D8;&#x6D88;&#x606F;&#x5E76;&#x4E14;&#x662F;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5168;&#x5C40;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x952E;&#x76D8;&#x6D88;&#x606F;&#x5E94;&#x8BBE;&#x4E3A;13&#xFF0C;</div><div class="line">                //&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;7&#xFF0C;&#x5168;&#x5C40;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;14&#x3002;lpfn &#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x7684;&#x5730;&#x5740;&#x6307;&#x9488;&#x3002;&#x5982;&#x679C;dwThreadId&#x53C2;&#x6570;&#x4E3A;0 &#x6216;&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x522B;&#x7684;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;</div><div class="line">                //&#x7EBF;&#x7A0B;&#x7684;&#x6807;&#x8BC6;&#xFF0C;lpfn&#x5FC5;&#x987B;&#x6307;&#x5411;DLL&#x4E2D;&#x7684;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x3002; &#x9664;&#x6B64;&#x4EE5;&#x5916;&#xFF0C;lpfn&#x53EF;&#x4EE5;&#x6307;&#x5411;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;&#x4E00;&#x6BB5;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x4EE3;&#x7801;&#x3002;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x7684;&#x5165;&#x53E3;&#x5730;&#x5740;&#xFF0C;&#x5F53;&#x94A9;&#x5B50;&#x94A9;&#x5230;&#x4EFB;&#x4F55;</div><div class="line">                //&#x6D88;&#x606F;&#x540E;&#x4FBF;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;hInstance&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5B9E;&#x4F8B;&#x7684;&#x53E5;&#x67C4;&#x3002;&#x6807;&#x8BC6;&#x5305;&#x542B;lpfn&#x6240;&#x6307;&#x7684;&#x5B50;&#x7A0B;&#x7684;DLL&#x3002;&#x5982;&#x679C;threadId &#x6807;&#x8BC6;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x4E14;&#x5B50;</div><div class="line">                //&#x7A0B;&#x4EE3;&#x7801;&#x4F4D;&#x4E8E;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#xFF0C;hInstance&#x5FC5;&#x987B;&#x4E3A;NULL&#x3002;&#x53EF;&#x4EE5;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x8BBE;&#x5B9A;&#x5176;&#x4E3A;&#x672C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5B9E;&#x4F8B;&#x53E5;&#x67C4;&#x3002;threaded &#x4E0E;&#x5B89;&#x88C5;&#x7684;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x76F8;&#x5173;&#x8054;&#x7684;&#x7EBF;&#x7A0B;&#x7684;&#x6807;&#x8BC6;&#x7B26;</div><div class="line">                //&#x5982;&#x679C;&#x4E3A;0&#xFF0C;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x4E0E;&#x6240;&#x6709;&#x7684;&#x7EBF;&#x7A0B;&#x5173;&#x8054;&#xFF0C;&#x5373;&#x4E3A;&#x5168;&#x5C40;&#x94A9;&#x5B50;</div><div class="line">                //************************************</div><div class="line">                //&#x5982;&#x679C;SetWindowsHookEx&#x5931;&#x8D25;</div><div class="line">                if (hKeyboardHook == 0)</div><div class="line">                {</div><div class="line">                    Stop();</div><div class="line">                    throw new Exception(&quot;&#x5B89;&#x88C5;&#x952E;&#x76D8;&#x94A9;&#x5B50;&#x5931;&#x8D25;&quot;);</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        public void Stop()</div><div class="line">        {</div><div class="line">            bool retKeyboard = true;</div><div class="line"></div><div class="line">            if (hKeyboardHook != 0)</div><div class="line">            {</div><div class="line">                retKeyboard = UnhookWindowsHookEx(hKeyboardHook);</div><div class="line">                hKeyboardHook = 0;</div><div class="line">            }</div><div class="line"></div><div class="line">            if (!(retKeyboard)) throw new Exception(&quot;&#x5378;&#x8F7D;&#x94A9;&#x5B50;&#x5931;&#x8D25;&#xFF01;&quot;);</div><div class="line">        }</div><div class="line">        //ToAscii&#x804C;&#x80FD;&#x7684;&#x8F6C;&#x6362;&#x6307;&#x5B9A;&#x7684;&#x865A;&#x62DF;&#x952E;&#x7801;&#x548C;&#x952E;&#x76D8;&#x72B6;&#x6001;&#x7684;&#x76F8;&#x5E94;&#x5B57;&#x7B26;&#x6216;&#x5B57;&#x7B26;</div><div class="line">        [DllImport(&quot;user32&quot;)]</div><div class="line">        public static extern int ToAscii(int uVirtKey, //[in] &#x6307;&#x5B9A;&#x865A;&#x62DF;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x7FFB;&#x8BD1;&#x3002;</div><div class="line">                                         int uScanCode, // [in] &#x6307;&#x5B9A;&#x7684;&#x786C;&#x4EF6;&#x626B;&#x63CF;&#x7801;&#x7684;&#x5173;&#x952E;&#x987B;&#x7FFB;&#x8BD1;&#x6210;&#x82F1;&#x6587;&#x3002;&#x9AD8;&#x9636;&#x4F4D;&#x7684;&#x8FD9;&#x4E2A;&#x503C;&#x8BBE;&#x5B9A;&#x7684;&#x5173;&#x952E;&#xFF0C;&#x5982;&#x679C;&#x662F;&#xFF08;&#x4E0D;&#x538B;&#xFF09;</div><div class="line">                                         byte[] lpbKeyState, // [in] &#x6307;&#x9488;&#xFF0C;&#x4EE5;256&#x5B57;&#x8282;&#x6570;&#x7EC4;&#xFF0C;&#x5305;&#x542B;&#x5F53;&#x524D;&#x952E;&#x76D8;&#x7684;&#x72B6;&#x6001;&#x3002;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#xFF08;&#x5B57;&#x8282;&#xFF09;&#x7684;&#x6570;&#x7EC4;&#x5305;&#x542B;&#x72B6;&#x6001;&#x7684;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x3002;&#x5982;&#x679C;&#x9AD8;&#x9636;&#x4F4D;&#x7684;&#x5B57;&#x8282;&#x662F;&#x4E00;&#x5957;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x4E0B;&#x8DCC;&#xFF08;&#x6309;&#x4E0B;&#xFF09;&#x3002;&#x5728;&#x4F4E;&#x6BD4;&#x7279;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x8868;&#x660E;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x5BF9;&#x5207;&#x6362;&#x3002;&#x5728;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x53EA;&#x6709;&#x8098;&#x4F4D;&#x7684;CAPS LOCK&#x952E;&#x662F;&#x76F8;&#x5173;&#x7684;&#x3002;&#x5728;&#x5207;&#x6362;&#x72B6;&#x6001;&#x7684;NUM&#x4E2A;&#x9501;&#x548C;&#x6EDA;&#x52A8;&#x9501;&#x5B9A;&#x952E;&#x88AB;&#x5FFD;&#x7565;&#x3002;</div><div class="line">                                         byte[] lpwTransKey, // [out] &#x6307;&#x9488;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x6536;&#x5230;&#x7FFB;&#x8BD1;&#x5B57;&#x7B26;&#x6216;&#x5B57;&#x7B26;&#x3002;</div><div class="line">                                         int fuState); // [in] Specifies whether a menu is active. This parameter must be 1 if a menu is active, or 0 otherwise.</div><div class="line"></div><div class="line">        //&#x83B7;&#x53D6;&#x6309;&#x952E;&#x7684;&#x72B6;&#x6001;</div><div class="line">        [DllImport(&quot;user32&quot;)]</div><div class="line">        public static extern int GetKeyboardState(byte[] pbKeyState);</div><div class="line"></div><div class="line">        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</div><div class="line">        private static extern short GetKeyState(int vKey);</div><div class="line"></div><div class="line">        private const int WM_KEYDOWN = 0x100;//KEYDOWN</div><div class="line">        private const int WM_KEYUP = 0x101;//KEYUP</div><div class="line">        private const int WM_SYSKEYDOWN = 0x104;//SYSKEYDOWN</div><div class="line">        private const int WM_SYSKEYUP = 0x105;//SYSKEYUP</div><div class="line"></div><div class="line">        private int KeyboardHookProc(int nCode, Int32 wParam, IntPtr lParam)</div><div class="line">        {</div><div class="line">            // &#x4FA6;&#x542C;&#x952E;&#x76D8;&#x4E8B;&#x4EF6;</div><div class="line">            if ((nCode &amp;gt;= 0) &amp;amp;&amp;amp; (KeyDownEvent != null || KeyUpEvent != null || KeyPressEvent != null))</div><div class="line">            {</div><div class="line">                KeyboardHookStruct MyKeyboardHookStruct = (KeyboardHookStruct)Marshal.PtrToStructure(lParam, typeof(KeyboardHookStruct));</div><div class="line">                // raise KeyDown</div><div class="line">                if (KeyDownEvent != null &amp;amp;&amp;amp; (wParam == WM_KEYDOWN || wParam == WM_SYSKEYDOWN))</div><div class="line">                {</div><div class="line">                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;</div><div class="line">                    KeyEventArgs e = new KeyEventArgs(keyData);</div><div class="line">                    KeyDownEvent(this, e);</div><div class="line">                }</div><div class="line"></div><div class="line">                //&#x952E;&#x76D8;&#x6309;&#x4E0B;</div><div class="line">                if (KeyPressEvent != null &amp;amp;&amp;amp; wParam == WM_KEYDOWN)</div><div class="line">                {</div><div class="line">                    byte[] keyState = new byte[256];</div><div class="line">                    GetKeyboardState(keyState);</div><div class="line"></div><div class="line">                    byte[] inBuffer = new byte[2];</div><div class="line">                    if (ToAscii(MyKeyboardHookStruct.vkCode, MyKeyboardHookStruct.scanCode, keyState, inBuffer, MyKeyboardHookStruct.flags) == 1)</div><div class="line">                    {</div><div class="line">                        KeyPressEventArgs e = new KeyPressEventArgs((char)inBuffer[0]);</div><div class="line">                        KeyPressEvent(this, e);</div><div class="line">                    }</div><div class="line">                }</div><div class="line"></div><div class="line">                // &#x952E;&#x76D8;&#x62AC;&#x8D77;</div><div class="line">                if (KeyUpEvent != null &amp;amp;&amp;amp; (wParam == WM_KEYUP || wParam == WM_SYSKEYUP))</div><div class="line">                {</div><div class="line">                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;</div><div class="line">                    KeyEventArgs e = new KeyEventArgs(keyData);</div><div class="line">                    KeyUpEvent(this, e);</div><div class="line">                }</div><div class="line"></div><div class="line">            }</div><div class="line">            //&#x5982;&#x679C;&#x8FD4;&#x56DE;1&#xFF0C;&#x5219;&#x7ED3;&#x675F;&#x6D88;&#x606F;&#xFF0C;&#x8FD9;&#x4E2A;&#x6D88;&#x606F;&#x5230;&#x6B64;&#x4E3A;&#x6B62;&#xFF0C;&#x4E0D;&#x518D;&#x4F20;&#x9012;&#x3002;</div><div class="line">            //&#x5982;&#x679C;&#x8FD4;&#x56DE;0&#x6216;&#x8C03;&#x7528;CallNextHookEx&#x51FD;&#x6570;&#x5219;&#x6D88;&#x606F;&#x51FA;&#x4E86;&#x8FD9;&#x4E2A;&#x94A9;&#x5B50;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x4F20;&#x9012;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4F20;&#x7ED9;&#x6D88;&#x606F;&#x771F;&#x6B63;&#x7684;&#x63A5;&#x53D7;&#x8005;</div><div class="line">            return CallNextHookEx(hKeyboardHook, nCode, wParam, lParam);</div><div class="line">        }</div><div class="line">        ~KeyboardHook()</div><div class="line">        {</div><div class="line">            Stop();</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<h2 id="&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;"><a href="#&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;"></a>&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;</h2><h3 id="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"><a href="#&#x51C6;&#x5907;&#x5DE5;&#x4F5C;" class="headerlink" title="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"></a>&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</h3><p>&#x628A;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x6DFB;&#x52A0;&#x5230;&#x9879;&#x76EE;&#x4E2D;</p>
<h3 id="&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;"><a href="#&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;" class="headerlink" title="&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;"></a>&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">using</span> System.Runtime.InteropServices; <span class="comment">//&#x8C03;&#x7528;WINDOWS API&#x51FD;&#x6570;&#x65F6;&#x8981;&#x7528;&#x5230;</span></div><div class="line"><span class="keyword">using</span> Microsoft.Win32; <span class="comment">//&#x5199;&#x5165;&#x6CE8;&#x518C;&#x8868;&#x65F6;&#x8981;&#x7528;&#x5230;</span></div></pre></td></tr></table></figure>
<h3 id="&#x5B89;&#x88C5;Hook"><a href="#&#x5B89;&#x88C5;Hook" class="headerlink" title="&#x5B89;&#x88C5;Hook"></a>&#x5B89;&#x88C5;Hook</h3><p>&#x5728;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#x4E2D;&#x5199;&#x4E0A;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x672C;&#x4F8B;&#x4E2D;&#x7528;&#x4E86;WinForm&#xFF0C;&#x5728;Form&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x5B89;&#x88C5;Hook&#x5373;&#x53EF;&#xFF09;</p>
<pre class="lang:c# decode:true ">var k_hook = new KeyboardHook();
k_hook.KeyDownEvent += new KeyEventHandler(hook_KeyDown);//&#x94A9;&#x4F4F;&#x952E;&#x6309;&#x4E0B;
k_hook.Start();//&#x5B89;&#x88C5;&#x952E;&#x76D8;&#x94A9;&#x5B50;</pre>

<h3 id="&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;"><a href="#&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;" class="headerlink" title="&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;"></a>&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;</h3><p><pre class="lang:c# decode:true ">private void hook_KeyDown(object sender, KeyEventArgs e)<br>{<br>    //&#x5224;&#x65AD;&#x6309;&#x4E0B;&#x7684;&#x952E;&#xFF08;Alt + A&#xFF09;<br>    if (e.KeyValue == (int)Keys.A &amp;&amp; (int)Control.ModifierKeys == (int)Keys.Alt)<br>    {<br>        System.Windows.Forms.MessageBox.Show(&#x201C;&#x6309;&#x4E0B;&#x4E86;&#x6307;&#x5B9A;&#x5FEB;&#x6377;&#x952E;&#x7EC4;&#x5408;&#x201D;);<br>    }<br>}</pre><br>&#x6CE8;&#x610F;&#x51E0;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x952E;&#x503C;&#x5224;&#x65AD;&#xFF1A;</p>
<ul>
<li>&#x5355;&#x666E;&#x901A;&#x952E;&#xFF08;&#x4F8B;&#x5982;A&#xFF09;</li>
<li>&#x5355;&#x63A7;&#x5236;&#x952E;+&#x5355;&#x666E;&#x901A;&#x952E;&#xFF08;&#x4F8B;&#x5982;Ctrl+A&#xFF09;</li>
<li>&#x591A;&#x63A7;&#x5236;&#x952E;+&#x5355;&#x666E;&#x901A;&#x952E;&#xFF08;&#x4F8B;&#x5982;Ctrl+Alt+A&#xFF09;<br>&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x6F14;&#x793A;&#x4E86;2&#xFF0C;&#x5176;&#x5B83;&#x60C5;&#x51B5;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;&#x65E0;&#x975E;&#x5C31;&#x662F;&#x6DFB;&#x51E0;&#x4E2A;&#x6761;&#x4EF6;&#x518D;&amp;&amp;&#x8D77;&#x6765;&#x5C31;&#x597D;</li>
</ul>
<p>&#x641E;&#x5B9A;&#xFF01;</p>
<h2 id="&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;-&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;"><a href="#&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;-&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;" class="headerlink" title="&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;(&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;)"></a>&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;(&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;)</h2><p>&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF0C;&#x4F1A;&#x88AB;360&#x53D1;&#x73B0;&#xFF0C;&#x5F39;&#x7A97;&#x63D0;&#x793A;&#x7528;&#x6237;&#x201C;&#x6709;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x76D1;&#x542C;&#x952E;&#x76D8;&#x8F93;&#x5165;&#xFF0C;&#x662F;&#x5426;&#x963B;&#x6B62;&#xFF1F;&#x201D;</p>
<p>&#x6240;&#x4EE5;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x4E2D;&#x5FC5;&#x987B;&#x8981;&#x7528;Hook&#x5E94;&#x8BE5;&#x544A;&#x8BC9;&#x7528;&#x6237;&#x4E0D;&#x4F1A;&#x6CC4;&#x9732;&#x5176;&#x4FE1;&#x606F;&#x7B49;&#x7B49;</p>
<p>&#x6216;&#x8005;&#x76F4;&#x63A5;&#x628A;&#x7A0B;&#x5E8F;&#x63D0;&#x4EA4;&#x7ED9;360&#x8FDB;&#x884C;&#x5BA1;&#x6838;</p>
<p>&#x5426;&#x5219;&#x6740;&#x8F6F;&#x7684;&#x63D0;&#x793A;&#x4F1A;&#x5BF9;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#x9020;&#x6210;&#x6781;&#x5927;&#x7684;&#x5F71;&#x54CD;</p>
<p>P.S&#xFF1A;&#x672C;&#x673A;&#x53EA;&#x5728;360&#x5B89;&#x5168;&#x536B;&#x58EB;&#x73AF;&#x5883;&#x4E0B;&#x505A;&#x4E86;&#x6D4B;&#x8BD5;&#xFF0C;&#x5176;&#x5B83;&#x6740;&#x8F6F;&#x672A;&#x77E5;&#xFF0C;&#x5E94;&#x8BE5;&#x4E5F;&#x4F1A;&#x63D0;&#x793A;&#x7C7B;&#x4F3C;&#x7684;&#x5371;&#x9669;&#x4FE1;&#x606F;&#xFF0C;&#x6545;&#x614E;&#x91CD;&#x4F7F;&#x7528;Hook</p>
<h2 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;" class="headerlink" title="&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h2><p><a href="http://www.bianceng.cn/Programming/csharp/201410/45484.htm" target="_blank" rel="external">bianceng</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/post/the_use_of_hookers_when_capturing_the_keyboard_press_in_c_sharp/" itemprop="url">
                  C#全局键盘监听（Hook）的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-12-10T14:08:45+08:00" content="2015-12-10">
              2015-12-10
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/post/the_use_of_hookers_when_capturing_the_keyboard_press_in_c_sharp/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="post/the_use_of_hookers_when_capturing_the_keyboard_press_in_c_sharp/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x6587;&#x7AE0;&#x4E3B;&#x8981;&#x53C2;&#x8003;&#x4E86;&#xFF1A;<a href="http://www.bianceng.cn/Programming/csharp/201410/45484.htm" target="_blank" rel="external">http://www.bianceng.cn/Programming/csharp/201410/45484.htm</a></p>
<h2 id="&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;" class="headerlink" title="&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;</h2><p>&#x5728;&#x67D0;&#x4E9B;&#x60C5;&#x51B5;&#x4E0B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x5FEB;&#x6377;&#x952E;&#x6267;&#x884C;&#x7279;&#x5B9A;&#x529F;&#x80FD;&#xFF0C;&#x4F8B;&#x5982;&#x5927;&#x5BB6;&#x719F;&#x77E5;&#x7684;QQ&#x622A;&#x56FE;&#x529F;&#x80FD;Ctrl+Alt+A&#x5FEB;&#x6377;&#x952E;&#xFF0C;&#x53EA;&#x8981;QQ&#x7A0B;&#x5E8F;&#x5728;&#x8FD0;&#x884C;&#xFF08;&#x65E0;&#x8BBA;&#x662F;&#x62E5;&#x6709;&#x7126;&#x70B9;&#x8FD8;&#x662F;&#x5904;&#x4E8E;&#x540E;&#x53F0;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#xFF09;&#xFF0C;&#x90FD;&#x53EF;&#x4EE5;&#x6309;&#x4E0B;&#x5FEB;&#x6377;&#x952E;&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#x2026;</p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x5728;&#x7A0B;&#x5E8F;&#x4E2D;&#x6DFB;&#x52A0;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x80AF;&#x5B9A;&#x4E0D;&#x80FD;&#x6EE1;&#x8DB3;&#x9700;&#x6C42;&#x4E86;&#xFF0C;&#x5F53;&#x7528;&#x6237;&#x7126;&#x70B9;&#x4E0D;&#x5728;App&#x4E0A;&#x65F6;&#xFF08;&#x5982;&#x6700;&#x5C0F;&#x5316;&#xFF0C;&#x6216;&#x8005;&#x7528;&#x6237;&#x5728;&#x5904;&#x7406;&#x5176;&#x5B83;&#x4E8B;&#x7269;&#x7B49;&#x7B49;&#xFF09;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x5C31;&#x5931;&#x6548;&#x4E86;</p>
<h2 id="&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"><a href="#&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;" class="headerlink" title="&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;"></a>&#x600E;&#x6837;&#x624D;&#x80FD;&#x5B9E;&#x73B0;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF1F;</h2><p>&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x7528;&#x5230;Windows API&#xFF0C;&#x6E90;&#x7801;&#x5982;&#x4E0B;&#xFF1A;&#xFF08;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x7C7B;[KeyboardHook.cs]&#x6536;&#x85CF;&#x8D77;&#x6765;&#xFF09;</p>
<pre class="lang:c# decode:true ">using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using System.Reflection;

namespace &#x58C1;&#x7EB8;&#x7BA1;&#x5BB6;
{
    /// &lt;summary&gt;
    /// &#x952E;&#x76D8;&#x94A9;&#x5B50;
    /// [&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x6765;&#x81EA;&#x67D0;&#x7F51;&#x53CB;&#xFF0C;&#x5E76;&#x975E;&#x672C;&#x4EBA;&#x539F;&#x521B;]
    /// &lt;/summary&gt;
    class KeyboardHook
    {
        public event KeyEventHandler KeyDownEvent;
        public event KeyPressEventHandler KeyPressEvent;
        public event KeyEventHandler KeyUpEvent;

        public delegate int HookProc(int nCode, Int32 wParam, IntPtr lParam);
        static int hKeyboardHook = 0; //&#x58F0;&#x660E;&#x952E;&#x76D8;&#x94A9;&#x5B50;&#x5904;&#x7406;&#x7684;&#x521D;&#x59CB;&#x503C;
        //&#x503C;&#x5728;Microsoft SDK&#x7684;Winuser.h&#x91CC;&#x67E5;&#x8BE2;
        // http://www.bianceng.cn/Programming/csharp/201410/45484.htm
        public const int WH_KEYBOARD_LL = 13;   //&#x7EBF;&#x7A0B;&#x952E;&#x76D8;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;2&#xFF0C;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;13
        HookProc KeyboardHookProcedure; //&#x58F0;&#x660E;KeyboardHookProcedure&#x4F5C;&#x4E3A;HookProc&#x7C7B;&#x578B;
        //&#x952E;&#x76D8;&#x7ED3;&#x6784;
        [StructLayout(LayoutKind.Sequential)]
        public class KeyboardHookStruct
        {
            public int vkCode;  //&#x5B9A;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x952E;&#x7801;&#x3002;&#x8BE5;&#x4EE3;&#x7801;&#x5FC5;&#x987B;&#x6709;&#x4E00;&#x4E2A;&#x4EF7;&#x503C;&#x7684;&#x8303;&#x56F4;1&#x81F3;254
            public int scanCode; // &#x6307;&#x5B9A;&#x7684;&#x786C;&#x4EF6;&#x626B;&#x63CF;&#x7801;&#x7684;&#x5173;&#x952E;
            public int flags;  // &#x952E;&#x6807;&#x5FD7;
            public int time; // &#x6307;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x8BB0;&#x7684;&#x8FD9;&#x4E2A;&#x8BAF;&#x606F;
            public int dwExtraInfo; // &#x6307;&#x5B9A;&#x989D;&#x5916;&#x4FE1;&#x606F;&#x76F8;&#x5173;&#x7684;&#x4FE1;&#x606F;
        }
        //&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x5B89;&#x88C5;&#x4E86;&#x4E00;&#x4E2A;&#x94A9;&#x5B50;
        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);

        //&#x8C03;&#x7528;&#x6B64;&#x51FD;&#x6570;&#x5378;&#x8F7D;&#x94A9;&#x5B50;
        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern bool UnhookWindowsHookEx(int idHook);

        //&#x4F7F;&#x7528;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x901A;&#x8FC7;&#x4FE1;&#x606F;&#x94A9;&#x5B50;&#x7EE7;&#x7EED;&#x4E0B;&#x4E00;&#x4E2A;&#x94A9;&#x5B50;
        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int CallNextHookEx(int idHook, int nCode, Int32 wParam, IntPtr lParam);

        // &#x53D6;&#x5F97;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x7F16;&#x53F7;&#xFF08;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#x9700;&#x8981;&#x7528;&#x5230;&#xFF09;
        [DllImport(&quot;kernel32.dll&quot;)]
        static extern int GetCurrentThreadId();

        //&#x4F7F;&#x7528;WINDOWS API&#x51FD;&#x6570;&#x4EE3;&#x66FF;&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x5B9E;&#x4F8B;&#x7684;&#x51FD;&#x6570;,&#x9632;&#x6B62;&#x94A9;&#x5B50;&#x5931;&#x6548;
        [DllImport(&quot;kernel32.dll&quot;)]
        public static extern IntPtr GetModuleHandle(string name);

        public void Start()
        {
            // &#x5B89;&#x88C5;&#x952E;&#x76D8;&#x94A9;&#x5B50;
            if (hKeyboardHook == 0)
            {
                KeyboardHookProcedure = new HookProc(KeyboardHookProc);
                hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, GetModuleHandle(System.Diagnostics.Process.GetCurrentProcess().MainModule.ModuleName), 0);
                //hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]), 0);
                //************************************
                //&#x952E;&#x76D8;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;
                //SetWindowsHookEx( 2,KeyboardHookProcedure, IntPtr.Zero, GetCurrentThreadId());//&#x6307;&#x5B9A;&#x8981;&#x76D1;&#x542C;&#x7684;&#x7EBF;&#x7A0B;idGetCurrentThreadId(),
                //&#x952E;&#x76D8;&#x5168;&#x5C40;&#x94A9;&#x5B50;,&#x9700;&#x8981;&#x5F15;&#x7528;&#x7A7A;&#x95F4;(using System.Reflection;)
                //SetWindowsHookEx( 13,MouseHookProcedure,Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]),0);
                //
                //&#x5173;&#x4E8E;SetWindowsHookEx (int idHook, HookProc lpfn, IntPtr hInstance, int threadId)&#x51FD;&#x6570;&#x5C06;&#x94A9;&#x5B50;&#x52A0;&#x5165;&#x5230;&#x94A9;&#x5B50;&#x94FE;&#x8868;&#x4E2D;&#xFF0C;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#x56DB;&#x4E2A;&#x53C2;&#x6570;&#xFF1A;
                //idHook &#x94A9;&#x5B50;&#x7C7B;&#x578B;&#xFF0C;&#x5373;&#x786E;&#x5B9A;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x4F55;&#x79CD;&#x6D88;&#x606F;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x8BBE;&#x4E3A;2&#xFF0C;&#x5373;&#x76D1;&#x542C;&#x952E;&#x76D8;&#x6D88;&#x606F;&#x5E76;&#x4E14;&#x662F;&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5168;&#x5C40;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x952E;&#x76D8;&#x6D88;&#x606F;&#x5E94;&#x8BBE;&#x4E3A;13&#xFF0C;
                //&#x7EBF;&#x7A0B;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;7&#xFF0C;&#x5168;&#x5C40;&#x94A9;&#x5B50;&#x76D1;&#x542C;&#x9F20;&#x6807;&#x6D88;&#x606F;&#x8BBE;&#x4E3A;14&#x3002;lpfn &#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x7684;&#x5730;&#x5740;&#x6307;&#x9488;&#x3002;&#x5982;&#x679C;dwThreadId&#x53C2;&#x6570;&#x4E3A;0 &#x6216;&#x662F;&#x4E00;&#x4E2A;&#x7531;&#x522B;&#x7684;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;
                //&#x7EBF;&#x7A0B;&#x7684;&#x6807;&#x8BC6;&#xFF0C;lpfn&#x5FC5;&#x987B;&#x6307;&#x5411;DLL&#x4E2D;&#x7684;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x3002; &#x9664;&#x6B64;&#x4EE5;&#x5916;&#xFF0C;lpfn&#x53EF;&#x4EE5;&#x6307;&#x5411;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x7684;&#x4E00;&#x6BB5;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x4EE3;&#x7801;&#x3002;&#x94A9;&#x5B50;&#x51FD;&#x6570;&#x7684;&#x5165;&#x53E3;&#x5730;&#x5740;&#xFF0C;&#x5F53;&#x94A9;&#x5B50;&#x94A9;&#x5230;&#x4EFB;&#x4F55;
                //&#x6D88;&#x606F;&#x540E;&#x4FBF;&#x8C03;&#x7528;&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x3002;hInstance&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5B9E;&#x4F8B;&#x7684;&#x53E5;&#x67C4;&#x3002;&#x6807;&#x8BC6;&#x5305;&#x542B;lpfn&#x6240;&#x6307;&#x7684;&#x5B50;&#x7A0B;&#x7684;DLL&#x3002;&#x5982;&#x679C;threadId &#x6807;&#x8BC6;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#x521B;&#x5EFA;&#x7684;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x800C;&#x4E14;&#x5B50;
                //&#x7A0B;&#x4EE3;&#x7801;&#x4F4D;&#x4E8E;&#x5F53;&#x524D;&#x8FDB;&#x7A0B;&#xFF0C;hInstance&#x5FC5;&#x987B;&#x4E3A;NULL&#x3002;&#x53EF;&#x4EE5;&#x5F88;&#x7B80;&#x5355;&#x7684;&#x8BBE;&#x5B9A;&#x5176;&#x4E3A;&#x672C;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x5B9E;&#x4F8B;&#x53E5;&#x67C4;&#x3002;threaded &#x4E0E;&#x5B89;&#x88C5;&#x7684;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x76F8;&#x5173;&#x8054;&#x7684;&#x7EBF;&#x7A0B;&#x7684;&#x6807;&#x8BC6;&#x7B26;
                //&#x5982;&#x679C;&#x4E3A;0&#xFF0C;&#x94A9;&#x5B50;&#x5B50;&#x7A0B;&#x4E0E;&#x6240;&#x6709;&#x7684;&#x7EBF;&#x7A0B;&#x5173;&#x8054;&#xFF0C;&#x5373;&#x4E3A;&#x5168;&#x5C40;&#x94A9;&#x5B50;
                //************************************
                //&#x5982;&#x679C;SetWindowsHookEx&#x5931;&#x8D25;
                if (hKeyboardHook == 0)
                {
                    Stop();
                    throw new Exception(&quot;&#x5B89;&#x88C5;&#x952E;&#x76D8;&#x94A9;&#x5B50;&#x5931;&#x8D25;&quot;);
                }
            }
        }
        public void Stop()
        {
            bool retKeyboard = true;

            if (hKeyboardHook != 0)
            {
                retKeyboard = UnhookWindowsHookEx(hKeyboardHook);
                hKeyboardHook = 0;
            }

            if (!(retKeyboard)) throw new Exception(&quot;&#x5378;&#x8F7D;&#x94A9;&#x5B50;&#x5931;&#x8D25;&#xFF01;&quot;);
        }
        //ToAscii&#x804C;&#x80FD;&#x7684;&#x8F6C;&#x6362;&#x6307;&#x5B9A;&#x7684;&#x865A;&#x62DF;&#x952E;&#x7801;&#x548C;&#x952E;&#x76D8;&#x72B6;&#x6001;&#x7684;&#x76F8;&#x5E94;&#x5B57;&#x7B26;&#x6216;&#x5B57;&#x7B26;
        [DllImport(&quot;user32&quot;)]
        public static extern int ToAscii(int uVirtKey, //[in] &#x6307;&#x5B9A;&#x865A;&#x62DF;&#x5173;&#x952E;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x7FFB;&#x8BD1;&#x3002;
                                         int uScanCode, // [in] &#x6307;&#x5B9A;&#x7684;&#x786C;&#x4EF6;&#x626B;&#x63CF;&#x7801;&#x7684;&#x5173;&#x952E;&#x987B;&#x7FFB;&#x8BD1;&#x6210;&#x82F1;&#x6587;&#x3002;&#x9AD8;&#x9636;&#x4F4D;&#x7684;&#x8FD9;&#x4E2A;&#x503C;&#x8BBE;&#x5B9A;&#x7684;&#x5173;&#x952E;&#xFF0C;&#x5982;&#x679C;&#x662F;&#xFF08;&#x4E0D;&#x538B;&#xFF09;
                                         byte[] lpbKeyState, // [in] &#x6307;&#x9488;&#xFF0C;&#x4EE5;256&#x5B57;&#x8282;&#x6570;&#x7EC4;&#xFF0C;&#x5305;&#x542B;&#x5F53;&#x524D;&#x952E;&#x76D8;&#x7684;&#x72B6;&#x6001;&#x3002;&#x6BCF;&#x4E2A;&#x5143;&#x7D20;&#xFF08;&#x5B57;&#x8282;&#xFF09;&#x7684;&#x6570;&#x7EC4;&#x5305;&#x542B;&#x72B6;&#x6001;&#x7684;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x3002;&#x5982;&#x679C;&#x9AD8;&#x9636;&#x4F4D;&#x7684;&#x5B57;&#x8282;&#x662F;&#x4E00;&#x5957;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x4E0B;&#x8DCC;&#xFF08;&#x6309;&#x4E0B;&#xFF09;&#x3002;&#x5728;&#x4F4E;&#x6BD4;&#x7279;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x8868;&#x660E;&#xFF0C;&#x5173;&#x952E;&#x662F;&#x5BF9;&#x5207;&#x6362;&#x3002;&#x5728;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x53EA;&#x6709;&#x8098;&#x4F4D;&#x7684;CAPS LOCK&#x952E;&#x662F;&#x76F8;&#x5173;&#x7684;&#x3002;&#x5728;&#x5207;&#x6362;&#x72B6;&#x6001;&#x7684;NUM&#x4E2A;&#x9501;&#x548C;&#x6EDA;&#x52A8;&#x9501;&#x5B9A;&#x952E;&#x88AB;&#x5FFD;&#x7565;&#x3002;
                                         byte[] lpwTransKey, // [out] &#x6307;&#x9488;&#x7684;&#x7F13;&#x51B2;&#x533A;&#x6536;&#x5230;&#x7FFB;&#x8BD1;&#x5B57;&#x7B26;&#x6216;&#x5B57;&#x7B26;&#x3002;
                                         int fuState); // [in] Specifies whether a menu is active. This parameter must be 1 if a menu is active, or 0 otherwise.

        //&#x83B7;&#x53D6;&#x6309;&#x952E;&#x7684;&#x72B6;&#x6001;
        [DllImport(&quot;user32&quot;)]
        public static extern int GetKeyboardState(byte[] pbKeyState);

        [DllImport(&quot;user32.dll&quot;, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        private static extern short GetKeyState(int vKey);

        private const int WM_KEYDOWN = 0x100;//KEYDOWN
        private const int WM_KEYUP = 0x101;//KEYUP
        private const int WM_SYSKEYDOWN = 0x104;//SYSKEYDOWN
        private const int WM_SYSKEYUP = 0x105;//SYSKEYUP

        private int KeyboardHookProc(int nCode, Int32 wParam, IntPtr lParam)
        {
            // &#x4FA6;&#x542C;&#x952E;&#x76D8;&#x4E8B;&#x4EF6;
            if ((nCode &gt;= 0) &amp;&amp; (KeyDownEvent != null || KeyUpEvent != null || KeyPressEvent != null))
            {
                KeyboardHookStruct MyKeyboardHookStruct = (KeyboardHookStruct)Marshal.PtrToStructure(lParam, typeof(KeyboardHookStruct));
                // raise KeyDown
                if (KeyDownEvent != null &amp;&amp; (wParam == WM_KEYDOWN || wParam == WM_SYSKEYDOWN))
                {
                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;
                    KeyEventArgs e = new KeyEventArgs(keyData);
                    KeyDownEvent(this, e);
                }

                //&#x952E;&#x76D8;&#x6309;&#x4E0B;
                if (KeyPressEvent != null &amp;&amp; wParam == WM_KEYDOWN)
                {
                    byte[] keyState = new byte[256];
                    GetKeyboardState(keyState);

                    byte[] inBuffer = new byte[2];
                    if (ToAscii(MyKeyboardHookStruct.vkCode, MyKeyboardHookStruct.scanCode, keyState, inBuffer, MyKeyboardHookStruct.flags) == 1)
                    {
                        KeyPressEventArgs e = new KeyPressEventArgs((char)inBuffer[0]);
                        KeyPressEvent(this, e);
                    }
                }

                // &#x952E;&#x76D8;&#x62AC;&#x8D77;
                if (KeyUpEvent != null &amp;&amp; (wParam == WM_KEYUP || wParam == WM_SYSKEYUP))
                {
                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;
                    KeyEventArgs e = new KeyEventArgs(keyData);
                    KeyUpEvent(this, e);
                }

            }
            //&#x5982;&#x679C;&#x8FD4;&#x56DE;1&#xFF0C;&#x5219;&#x7ED3;&#x675F;&#x6D88;&#x606F;&#xFF0C;&#x8FD9;&#x4E2A;&#x6D88;&#x606F;&#x5230;&#x6B64;&#x4E3A;&#x6B62;&#xFF0C;&#x4E0D;&#x518D;&#x4F20;&#x9012;&#x3002;
            //&#x5982;&#x679C;&#x8FD4;&#x56DE;0&#x6216;&#x8C03;&#x7528;CallNextHookEx&#x51FD;&#x6570;&#x5219;&#x6D88;&#x606F;&#x51FA;&#x4E86;&#x8FD9;&#x4E2A;&#x94A9;&#x5B50;&#x7EE7;&#x7EED;&#x5F80;&#x4E0B;&#x4F20;&#x9012;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4F20;&#x7ED9;&#x6D88;&#x606F;&#x771F;&#x6B63;&#x7684;&#x63A5;&#x53D7;&#x8005;
            return CallNextHookEx(hKeyboardHook, nCode, wParam, lParam);
        }
        ~KeyboardHook()
        {
            Stop();
        }
    }
}</pre>

<h2 id="&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;"><a href="#&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;" class="headerlink" title="&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;"></a>&#x5982;&#x4F55;&#x4F7F;&#x7528;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#xFF1F;</h2><h3 id="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"><a href="#&#x51C6;&#x5907;&#x5DE5;&#x4F5C;" class="headerlink" title="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;"></a>&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</h3><p>&#x628A;&#x4E0A;&#x9762;&#x7684;&#x5DE5;&#x5177;&#x7C7B;&#x6DFB;&#x52A0;&#x5230;&#x9879;&#x76EE;&#x4E2D;</p>
<h3 id="&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;"><a href="#&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;" class="headerlink" title="&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;"></a>&#x9996;&#x5148;&#x5BFC;&#x5165;&#x9700;&#x8981;&#x7684;&#x547D;&#x540D;&#x7A7A;&#x95F4;</h3><pre class="lang:c# decode:true ">using System.Runtime.InteropServices; //&#x8C03;&#x7528;WINDOWS API&#x51FD;&#x6570;&#x65F6;&#x8981;&#x7528;&#x5230;
using Microsoft.Win32; //&#x5199;&#x5165;&#x6CE8;&#x518C;&#x8868;&#x65F6;&#x8981;&#x7528;&#x5230;</pre>

<h3 id="&#x5B89;&#x88C5;Hook&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#x4E2D;&#x5199;&#x4E0A;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x672C;&#x4F8B;&#x4E2D;&#x7528;&#x4E86;WinForm&#xFF0C;&#x5728;Form&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x5B89;&#x88C5;Hook&#x5373;&#x53EF;&#xFF09;"><a href="#&#x5B89;&#x88C5;Hook&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#x4E2D;&#x5199;&#x4E0A;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x672C;&#x4F8B;&#x4E2D;&#x7528;&#x4E86;WinForm&#xFF0C;&#x5728;Form&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x5B89;&#x88C5;Hook&#x5373;&#x53EF;&#xFF09;" class="headerlink" title="&#x5B89;&#x88C5;Hook&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#x4E2D;&#x5199;&#x4E0A;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x672C;&#x4F8B;&#x4E2D;&#x7528;&#x4E86;WinForm&#xFF0C;&#x5728;Form&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x5B89;&#x88C5;Hook&#x5373;&#x53EF;&#xFF09;"></a>&#x5B89;&#x88C5;Hook&#xFF0C;&#x5728;&#x7A0B;&#x5E8F;&#x5165;&#x53E3;&#x4E2D;&#x5199;&#x4E0A;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF08;&#x672C;&#x4F8B;&#x4E2D;&#x7528;&#x4E86;WinForm&#xFF0C;&#x5728;Form&#x7684;&#x6784;&#x9020;&#x65B9;&#x6CD5;&#x4E2D;&#x5B89;&#x88C5;Hook&#x5373;&#x53EF;&#xFF09;</h3><pre class="lang:c# decode:true ">var k_hook = new KeyboardHook();
k_hook.KeyDownEvent += new KeyEventHandler(hook_KeyDown);//&#x94A9;&#x4F4F;&#x952E;&#x6309;&#x4E0B;
k_hook.Start();//&#x5B89;&#x88C5;&#x952E;&#x76D8;&#x94A9;&#x5B50;</pre>

<h3 id="&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;"><a href="#&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;" class="headerlink" title="&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;"></a>&#x5224;&#x65AD;&#x8F93;&#x5165;&#x952E;&#x503C;&#xFF08;&#x5B9E;&#x73B0;KeyDown&#x4E8B;&#x4EF6;&#xFF09;</h3><p><pre class="lang:c# decode:true ">private void hook_KeyDown(object sender, KeyEventArgs e)<br>{<br>    //&#x5224;&#x65AD;&#x6309;&#x4E0B;&#x7684;&#x952E;&#xFF08;Alt + A&#xFF09;<br>    if (e.KeyValue == (int)Keys.A &amp;&amp; (int)Control.ModifierKeys == (int)Keys.Alt)<br>    {<br>        System.Windows.Forms.MessageBox.Show(&#x201C;&#x6309;&#x4E0B;&#x4E86;&#x6307;&#x5B9A;&#x5FEB;&#x6377;&#x952E;&#x7EC4;&#x5408;&#x201D;);<br>    }<br>}</pre><br>//&#x6CE8;&#x610F;&#x51E0;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x952E;&#x503C;&#x5224;&#x65AD;&#xFF1A;<br>//1&gt;.&#x5355;&#x666E;&#x901A;&#x952E;&#xFF08;&#x4F8B;&#x5982;A&#xFF09;<br>//2&gt;.&#x5355;&#x63A7;&#x5236;&#x952E;+&#x5355;&#x666E;&#x901A;&#x952E;&#xFF08;&#x4F8B;&#x5982;Ctrl+A&#xFF09;<br>//3&gt;.&#x591A;&#x63A7;&#x5236;&#x952E;+&#x5355;&#x666E;&#x901A;&#x952E;&#xFF08;&#x4F8B;&#x5982;Ctrl+Alt+A&#xFF09;<br>//&#x4E0A;&#x9762;&#x7684;&#x4EE3;&#x7801;&#x4E2D;&#x6F14;&#x793A;&#x4E86;2&#xFF0C;&#x5176;&#x5B83;&#x60C5;&#x51B5;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;&#x65E0;&#x975E;&#x5C31;&#x662F;&#x6DFB;&#x51E0;&#x4E2A;&#x6761;&#x4EF6;&#x518D;&amp;&amp;&#x8D77;&#x6765;&#x5C31;&#x597D;</p>
<p>&#x641E;&#x5B9A;&#xFF01;</p>
<h2 id="&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;-&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;"><a href="#&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;-&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;" class="headerlink" title="&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;(&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;)"></a>&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x95EE;&#x9898;(&#x8BF7;&#x8BFB;&#x8005;&#x670B;&#x53CB;&#x52A1;&#x5FC5;&#x770B;&#x770B;)</h2><p>&#x5728;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#x4F7F;&#x7528;&#x5168;&#x5C40;&#x952E;&#x76D8;&#x76D1;&#x542C;&#xFF0C;&#x4F1A;&#x88AB;360&#x53D1;&#x73B0;&#xFF0C;&#x5F39;&#x7A97;&#x63D0;&#x793A;&#x7528;&#x6237;&#x201C;&#x6709;&#x7A0B;&#x5E8F;&#x6B63;&#x5728;&#x76D1;&#x542C;&#x952E;&#x76D8;&#x8F93;&#x5165;&#xFF0C;&#x662F;&#x5426;&#x963B;&#x6B62;&#xFF1F;&#x201D;</p>
<p>&#x6240;&#x4EE5;&#x5982;&#x679C;&#x7A0B;&#x5E8F;&#x4E2D;&#x5FC5;&#x987B;&#x8981;&#x7528;Hook&#x5E94;&#x8BE5;&#x544A;&#x8BC9;&#x7528;&#x6237;&#x4E0D;&#x4F1A;&#x6CC4;&#x9732;&#x5176;&#x4FE1;&#x606F;&#x7B49;&#x7B49;</p>
<p>&#x6216;&#x8005;&#x76F4;&#x63A5;&#x628A;App&#x63D0;&#x4EA4;&#x7ED9;360&#x5BA1;&#x6838;</p>
<p>&#x5426;&#x5219;&#x6740;&#x8F6F;&#x7684;&#x63D0;&#x793A;&#x4F1A;&#x5BF9;&#x7528;&#x6237;&#x4F53;&#x9A8C;&#x9020;&#x6210;&#x6781;&#x5927;&#x7684;&#x5F71;&#x54CD;</p>
<p>P.S&#xFF1A;&#x672C;&#x673A;&#x53EA;&#x5728;360&#x5B89;&#x5168;&#x536B;&#x58EB;&#x73AF;&#x5883;&#x4E0B;&#x505A;&#x4E86;&#x6D4B;&#x8BD5;&#xFF0C;&#x5176;&#x5B83;&#x6740;&#x8F6F;&#x672A;&#x77E5;&#xFF0C;&#x5E94;&#x8BE5;&#x4E5F;&#x4F1A;&#x63D0;&#x793A;&#x7C7B;&#x4F3C;&#x7684;&#x5371;&#x9669;&#x4FE1;&#x606F;&#xFF0C;&#x6545;&#x614E;&#x91CD;&#x4F7F;&#x7528;Hook</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars1.githubusercontent.com/u/150694?v=3&s=140"
               alt="节约用爱" />
          <p class="site-author-name" itemprop="name">节约用爱</p>
          <p class="site-description motion-element" itemprop="description">随笔 随心</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">61</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">132</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/tinyvane" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/tinyvane" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/tinyvane" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/2705283/" target="_blank" title="DouBan">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  DouBan
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/wang-yi-80" target="_blank" title="ZhiHu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  ZhiHu
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.jerryzhang.net/" title="JerrySher's blog" target="_blank">JerrySher's blog</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://3toptop.top/" title="山上" target="_blank">山上</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://sfantree.com/" title="水番林" target="_blank">水番林</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">节约用爱</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"wuliaole"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  






  
  
  

  

  

</body>
</html>
