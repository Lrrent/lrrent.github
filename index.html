<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="随笔 随心">
<meta property="og:type" content="website">
<meta property="og:title" content="FOOLMAN 一个人的修行">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="FOOLMAN 一个人的修行">
<meta property="og:description" content="随笔 随心">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FOOLMAN 一个人的修行">
<meta name="twitter:description" content="随笔 随心">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> FOOLMAN 一个人的修行 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">FOOLMAN 一个人的修行</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">随笔 随心</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/10/如何给HEXO换主题/" itemprop="url">
                  如何给HEXO换主题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-10T23:16:05+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="本文在说什么"><a href="#本文在说什么" class="headerlink" title="本文在说什么"></a>本文在说什么</h2><p>已经会写hexo文章的话，也许你第一个需求就是换一个皮肤或者主题，hexo 3.0c默认带的主题是landscape，像极了WordPress的默认主题，因此，我非常有冲动要换一个。</p>
<h2 id="有哪些主题可以让你选择？"><a href="#有哪些主题可以让你选择？" class="headerlink" title="有哪些主题可以让你选择？"></a>有哪些主题可以让你选择？</h2><p>我还是在知乎上看到了帖子，详情请戳<a href="http://www.zhihu.com/question/24422335" target="_blank" rel="external">这里</a></p>
<p>我这里演示的iissnan的hexo-theme-next主题。至于其他的，自己选吧。</p>
<h2 id="将主题从远程下载到本地"><a href="#将主题从远程下载到本地" class="headerlink" title="将主题从远程下载到本地"></a>将主题从远程下载到本地</h2><p>开Git，在命令行的地方，输入</p>
<p><code>git clone https://github.com/iissnan/hexo-theme-next themes/next</code></p>
<p>后面是你存放主题的默认目录，themes是默认的主题文件夹。</p>
<h2 id="修改配置"><a href="#修改配置" class="headerlink" title="修改配置"></a>修改配置</h2><p>你的默认hexo目录下面，有一个文件叫<code>_config.yml</code>，打开后，会看到一行<code>theme: landscape</code>，注释掉，加上一句</p>
<p><code>theme: next</code>，这个next要和你themes目录下新下的主题保存的目录名称一致。</p>
<p>然后，执行下面的语句</p>
<p>hexo clean &amp;&amp; hexo g</p>
<p>clean是清理，g是重新生成，然后就可以看到新主题已经使用上了。</p>
<p>说简单不简单，这里有个坑，如果执行了上面的语句，访问localhost发现主题还是默认的，关掉服务器的那个git，重开git，输入<code>hexo -s debug</code>，然后再次访问<code>localhost:4000</code>，应该就可以看到新主题已经换上了。</p>
<h2 id="延伸阅读"><a href="#延伸阅读" class="headerlink" title="延伸阅读"></a>延伸阅读</h2><p>如何在GitHub上注册pages架设博客</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://iread.io/2015/09/hexo-guide-6/" target="_blank" rel="external">叶阳栩宁</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/10/网络通信加密算法介绍及实现/" itemprop="url">
                  网络通信加密算法介绍及C#实现“ hexo new 网络通信加密算法介绍及C#实现“
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-10T21:07:24+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="本文主要在说什么？"><a href="#本文主要在说什么？" class="headerlink" title="本文主要在说什么？"></a>本文主要在说什么？</h1><p>最近在做Winform程序和PHP的交互，中间接触了不少加密解密的问题，简单做个总结。</p>
<p>#几个概念</p>
<h2 id="散列加密，"><a href="#散列加密，" class="headerlink" title="散列加密，"></a>散列加密，</h2><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><p>数据加密标准（DES）是美国的一种由来已久的加密标准，它使用对称密钥加密法，并于1981年被ANSI组织规范为ANSI X.3.92。DES使用56位密钥和密码块的方法，而在密码块的方法中，文本被分成64位大小的文本块然后再进行加密。</p>
<h2 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h2><p>3DES（或称为Triple DES）是三重数据加密算法（TDEA，Triple Data Encryption Algorithm）块密码的通称。它相当于是对每个数据块应用三次DES加密算法。由于计算机运算能力的增强，原版DES密码的密钥长度变得容易被暴力破解；3DES即是设计用来提供一种相对简单的方法，即通过增加DES的密钥长度来避免类似的攻击，而不是设计一种全新的块密码算法。</p>
<p>3DES是DES加密算法的一种模式，它使用3条56位的密钥对 3DES 3DES 数据进行三次加密。比起前文提到的DES，3DES更为安全。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/10/在一切开始之前/" itemprop="url">
                  在一切开始之前
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-10T20:57:34+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>FOOLMAN，“生活在童话世界中的理想主义者”–在一切开始之前</p>
</blockquote>
<p>之前自己的WP博客因为后台总是无缘无故打不开，装了DISABLE GOOGLE FONT插件也是没有改善，用CHROME的DEVELOPER TOOLS也没发现什么不妥，虽然有处女[座]情节的我应该一究到底，但是还是觉得KEEP THINGS SIMPLE比较重要，陷在复杂的事情里面，自己也变得复杂了。</p>
<p>然后想到了“纯静态博客”，加上自己的阿里云速度还不错，就开始搞了。</p>
<p>先说这个HEXO，其实并不是唯一的方案，只是比较流行，大家可以自由选择其他方式搭建自己的静态博客，静态有什么好的？速度飞快！还有呢？这个理由还不够么？</p>
<p>开始步骤，请见<a href="">这里</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/10/从WORDPRESS迁移到HEXO/" itemprop="url">
                  从WordPress迁移到HEXO
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-03-10T19:56:40+08:00" content="2016-03-10">
              2016-03-10
            </time>
          </span>

          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>FOOLMAN喜欢简单的东西，虽然为了达到简单目标，付出的代价却是复杂无比</p>
</blockquote>
<p>WordPress确实是个优秀的博客系统，但是却越来越臃肿，平心而论，如果身在墙外，肯定会一直用下去，谁想天天没事好好日子不过瞎折腾呢。在不知道什么时候，就总看到网上有一些博客下面写着一句话“由HEXO强力驱动”。心想这是什么鬼？不过就在之前WordPress再次进不去之后，我还是决定换个博客系统吧，大概知道HEXO是什么，纯静态博客，一番了解之后，发现这个东西简约却不简单。</p>
<p>今天在上班的路上我还在想，也许过不了多久，HEXO就会变得臃肿，也许就有另外一种更加简单的博客框架出现，不过管他呢，折腾一下没坏处。</p>
<blockquote>
<p>我喜欢写流水账似的记录，因为我觉得只有自己消化了的东西，写出来的心得，才能是精华，才值得记录。</p>
</blockquote>
<p>可能自己写作习惯不好，经常偷懒，很多东西就算记下来了，也是随手记录在印象笔记中，懒得整理了。不过既然有了这个契机，就好好整理一下。</p>
<h2 id="本文讲的是什么"><a href="#本文讲的是什么" class="headerlink" title="本文讲的是什么"></a>本文讲的是什么</h2><p>主要是WINDOWS用户如何在本地上调试，并且上传到GITHUB免费空间，本来我的目标是上传到阿里云的，折腾了两天了，发现要总结的东西太多了，再不及时写成帖子，就要忍不了了，不是我忍不了，而是印象笔记忍不了我了（条目太多、太乱）。</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2016/03/10/从WORDPRESS迁移到HEXO/#more" rel="contents">
              Read more &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/14/Windows下的Awesome-窗口平铺占满桌面bug.n/" itemprop="url">
                  Windows下的awesome让所有窗口平铺沾满桌面的工具bug.n
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-01-14T11:11:21+08:00" content="2016-01-14">
              2016-01-14
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/效率提升/" itemprop="url" rel="index">
                    <span itemprop="name">效率提升</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="平铺式窗口管理器"><a href="#平铺式窗口管理器" class="headerlink" title="平铺式窗口管理器"></a>平铺式窗口管理器</h2><blockquote>
<p>总有一些东西是你自己不知道是否需要，但是在看到的那一刹那，就觉得相见恨晚的。</p>
</blockquote>
<p>因为曾经在知乎上，看到玩多屏的人介绍过awesome，就一直寻找windows下能用的类似软件，结果找到了这个名叫bug.n的小软件（名字是不是很拗口？）。</p>
<p>软件在GITHUB上，详见<a href="https://github.com/fuhsjr00/bug.n" target="_blank" rel="external">这里</a></p>
<p>先看一下我自己开启bug.n后桌面的窗口布局：</p>
<p><img src="http://7xrpbc.com1.z0.glb.clouddn.com/img_569711fb30fc5.png" alt=""></p>
<p>值得一提的是，窗口顶端还有一个banner，显示的信息包括：</p>
<ul>
<li>虚拟桌面列表</li>
<li>当前虚拟桌面使用什么布局</li>
<li>活动窗口的标题</li>
<li>日期时间</li>
</ul>
<p>bug.n支持虚拟桌面。Windows系统只有一个桌面，但通过bug.n可以虚拟出很多桌面。如果你正在一个桌面上玩游戏或看碟，看到老板来了，你可以迅速切换到早就准备好的工作桌面。老板在任务栏上不会发现任何你娱乐过的蛛丝马迹。</p>
<p>通过按Win+加数字n，可以切换到第n个桌面。用鼠标直接点击banner上的虚拟桌面按钮也可以。另外用鼠标右键点击某个虚拟桌面，会把当前的活动窗口送到那个虚拟桌面去。</p>
<p>每个桌面支持三种布局模式：</p>
<ul>
<li>平铺模式(tiling): 所有窗口平铺，左边是主窗口，右边是窗口队列。按 Win+t 可以切换到tiling模式。</li>
<li>浮动模式(floating): 所有窗口浮动，可以互相遮盖，就是我们平常用的模式。按 win+f可以切换到floating模式。</li>
<li>全屏模式(monocle): 所有窗口最大化，一次只显示一个。按 Win+m 可以切换到 monocle 模式。<br>用鼠标右键点击banner上的布局按钮可以在这三种布局间切换。</li>
</ul>
<p>通过窗口键加方向键可以调整主窗口大小和改变窗口队列，自己试试就知道。如果你觉得受不了了，按 Win + Ctrl + q，可以退出bug.n。</p>
<p>我在Win10上用bug.n，自己的配置写在 <code>C:\Users\Administrator\AppData\Roaming\bug.n\Config.ini</code> 中。</p>
<p>重点介绍一些常用的快捷键</p>
<p><code>Win+左右方向键</code>，是调整分割比例，这个很好用，左侧可以调整为正好一个网页的宽度。</p>
<p><code>Win+上下</code>，可以调整活动窗口。</p>
<p><code>Win+Shift+上下键</code>，可以让活动窗口在不同位置之间跳转。</p>
<p><code>Win+Shift+Enter</code>，让当前窗口和左侧活动主窗口对调位置很方便。</p>
<p><code>Win+Ctrl+q</code>，退出bug.n。</p>
<p><code>Win+c</code>，关闭当前窗口。</p>
<p>配合Chrome的Vimium，可以提高不少效率。</p>
<p>目前我正在研究的是Config.ini的一条规则，</p>
<p><code>Config_rule=WebChat*;.*;;1;0;0;0;0;0;</code></p>
<p>就是比如像微信电脑版这样的程序，其窗口的最小是一个固定值，如果让他按照普通窗口那样排列，基本什么也看不到，目前代替的方法就是Win+c，然后看到新信息，Ctrl+Alt+w取消息，回复完了，再关闭微信（注：Ctrl+Alt+w是微信默认快捷键，非bug.n）。</p>
<p>部分文字摘抄<a href="http://www.cnblogs.com/jiqingwu/p/4311202.html" target="_blank" rel="external">http://www.cnblogs.com/jiqingwu/p/4311202.html</a></p>
<p>特此说明。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/11/DotNet破解反编译资料汇总/" itemprop="url">
                  .net破解反编译资料汇总
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-01-11T17:10:24+08:00" content="2016-01-11">
              2016-01-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/未分类/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>国内网站</p>
<p>1、www.52pojie.cn 唔爱破解</p>
<p>2、<a href="http://www.17ky.net/" target="_blank" rel="external">http://www.17ky.net/</a> 工具汇总</p>
<p>国外网站</p>
<p>1、<a href="http://www.hackforum.net" target="_blank" rel="external">http://www.hackforum.net</a> 著名的HACK论坛，国内IP无法访问，挂代理或者VPN也不行</p>
<p>2、<a href="http://www.tuts.com" target="_blank" rel="external">http://www.tuts.com</a></p>
<p>3、<a href="http://www.nulled.io" target="_blank" rel="external">http://www.nulled.io</a> 现在貌似域名编程nulled.cr了，不知道IO出现什么变故了</p>
<p>4、</p>
<p>文档、资料</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/07/Net反编译软件集合/" itemprop="url">
                  .Net反编译软件集合
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-01-07T12:24:15+08:00" content="2016-01-07">
              2016-01-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Net反编译/" itemprop="url" rel="index">
                    <span itemprop="name">.Net反编译</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1、查壳</p>
<p>PeID 0.95 下载地址：[download id=”115”] 官网：无，已经停止更新</p>
<p>这里要说一下，网上所谓的0.96版本，应该不是原作者的作品，截图如下：</p>
<p><img src="http://www.wuliaole.com/wp-content/uploads/2016/01/img_56934c3b33ebb.png" alt=""></p>
<p>0.95版本，大小213KB，所谓的0.96，大小就超过1M了，并且打开的时候，腾讯管家报毒“进程创建”，各位小心为妙。</p>
<p>Exeinfo PE 0.0.4.1 下载地址：[download id=”150”] 官方网站：<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>Dot Net ID 下载地址：[download id=”154”] 官方网站：<a href="http://rongchaua.net，网站404" target="_blank" rel="external">http://rongchaua.net，网站404</a></p>
<p>2、脱壳</p>
<p>.NET Generic Unpacker(x86) 下载地址：[download id=”144”] 官方网站：<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>.NET Generic Unpacker(x64) 下载地址：[download id=”147”] 官方网站：<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>DNGuard HVM Unpacker 3.71 trial support</p>
<p><img src="http://www.wuliaole.com/wp-content/uploads/2016/01/img_569370433c050.png" alt=""></p>
<p>SAE 1.14 下载地址：[download id=”122”]</p>
<p>.NET REFLECTOR 8.3.3.115 下载地址：[download id=”127”]</p>
<p>ILSpy_Master_2.3.1.1855 下载地址：[download id=”132”]</p>
<p>Telerik Just Decompile 2015.3.1116.1 下载地址：[download id=”141”]</p>
<p>dnSpy 1.5.0.0 下载地址：[download id=”161”]</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/18/使用TurboTop保持Windows窗口保持最前端/" itemprop="url">
                  使用TurboTop保持Windows上任意程序保持最前端
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-12-18T10:32:13+08:00" content="2015-12-18">
              2015-12-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/未分类/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有时候你可能需要把某个应用窗口保持在最前端，比如处理表单数据的时候将计算器放在最前面。<strong>TurboTop</strong> 这款免费PC工具可以让任意正在运行的应用窗口保持在最前端。</p>
<p>运行后点击托盘区图标可以看到正在运行的应用列表，勾选某个应用，此应用就会保持在最前端了，而且你可以勾选多个应用。</p>
<ul>
<li>软件名称： TurboTop</li>
<li>支援平台； Windows</li>
<li>软件下载： 官网<br>软件截图<br><img src="http://pics.ikamu.me/2014/10/fqqc6i7qh1taf2cvlk7g.png" alt="fqqc6i7qh1taf2cvlk7g"></li>
</ul>
<p>转载了其他人的文字，当个软件推荐给大家吧。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/16/使用RSA加密保护你的.net应用程序(winform)/" itemprop="url">
                  使用RSA加密保护你的.net应用程序(winform)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-12-16T17:43:28+08:00" content="2015-12-16">
              2015-12-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/未分类/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原文地址：<a href="http://www.codeproject.com/Articles/203840/RSA-License-Protection" target="_blank" rel="external">http://www.codeproject.com/Articles/203840/RSA-License-Protection</a></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>本文的目的是通过使用.net内置的RSA加密组件对winform程序进行签名并校验，以达到有效保护winform程序的目的。</p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>所有应用程序开发者，尤其是哪些程序需要销售并且得到付款的开发者，都或多或少的关注程序的未授权的分发问题。因为无论什么时候，程序都存在被破解（或反编译）的可能性，总有人不想花钱去买你的软件。而你需要明白的一个事实是，无论你如何加密软件，软件都存在被破解和反编译的事实，因此，加密的目的，并不是为了防止反编译或者破解，而是加大破解的难度，让大多数人觉得购买你的软件，比寻找破解版更加容易。并且最重要的一点，就是程序员需要花费更多的精力，去完善软件，提升服务，尤其是配套的，售后的服务质量，让顾客觉得心甘情愿购买你的软件，或者更确切的，是购买你的服务！然后，再回头来讨论下这篇文章的最初目的，就是你的程序，应当，也应该校验用户的合法性，毕竟你是需要赚钱的！  The best bit of programming you can do to secure your program is to make the program actually valuable to the user, so they <em>want</em> to buy it. But, the next best thing is a mechanism by which you can use to correctly identify valid users of the program. There is no end to these methods, and they all have varying levels of security, administration overhead, and user-annoyance. Here are some of the common methods:</p>
<h3 id="Serial-Number-Protection"><a href="#Serial-Number-Protection" class="headerlink" title="Serial Number Protection"></a>Serial Number Protection</h3><p>Found on the back of a CD case, the most common copy-protection you can find often involves a long serial number that is derived from an algorithm, such that only the original key-generator can produce valid keys. Often, the first few characters define a seed entry for a pseudo-random-number generator, and the remaining characters must match the transformed output of that number generator. This has a number of drawbacks:</p>
<ol>
<li>It is a blanket authorization: Usernames and License-end terms, partial licenses cannot be specified</li>
<li>All you need is a copy of the serial-number: there are hundreds of websites that list known serial numbers for almost any bit of commercial software.</li>
<li>The user has to type in a long annoying and difficult to read serial number in order to install the software.</li>
</ol>
<h3 id="Online-Activation"><a href="#Online-Activation" class="headerlink" title="Online Activation"></a>Online Activation</h3><p>An extension of serial-number protection: the application contacts a central server to validate that the serial-number is one that has been issued. This allows serial numbers to be blacklisted, tracked, etc. The main drawback is that the application must have internet access in order to validate the serial number. Users will probably not be happy about this (especially if they don’t have constant internet access) and you may find hackers patching your software not to illegally copy it, but just to get it to work offline. The other drawback is the amount of coding and development work that must go into a system like this that could be defeated by a proxy-server that simulates the responses of your own validation server.</p>
<h3 id="License-Terms-File"><a href="#License-Terms-File" class="headerlink" title="License Terms File"></a>License Terms File</h3><p>Many systems use a license file that is supplied to the user with their purchase. The license file specifies the licensee (the user’s name, address, contact details, etc.), the product being licensed, and the start and end dates of that license. The software asks for the license file on first use, copies it into a known location, then validates that the terms of the license are valid (correct software version, within the applicable date-range, etc.).</p>
<p>The trick here is to ensure that the license file that is supplied is authentic, if that part is covered, this is an excellent system for licensing: the license terms can be as simple or complex as you like (i.e. blanket authorization, or partial (certain features enabled)), they can have start and end dates, be restricted to particular applications or even restricted to particular users. The user isn’t forced to type in a long and complex serial-number, and having the users name and contact details embedded within the terms makes it less likely that users will voluntarily share the license file.</p>
<h3 id="Authenticating-the-License-File"><a href="#Authenticating-the-License-File" class="headerlink" title="Authenticating the License File"></a>Authenticating the License File</h3><p>There is a branch of cryptography that deals with verification (or signing) of data, using Asymmetrical Encryption.</p>
<p>A digital signature is produced from the data being verified by generating a hash-code from the source data, and encrypting this hash with a private key.<br>The hash code will be unique to the source data… if even one bit in the source data changes, the resulting hashcode will be quite different. (The “strength” of any hashing algorithm is indicated by how much the hash-code changes with the smallest possible edit of the source data).</p>
<p>Verification of the data is achieved by using the public-part of the key to check if the digital signature (the encrypted hash) still matches the data that is being verified. If any part of the data is changed, then the digital signature will not match.</p>
<p>This means that you can verify that the license file the system is using definitely came from you, (the sellers of the software) without having to give the application access to the private key. If you were to use symmetrical encryption to encrypt the license-terms (so they could not be seen or changed), then the application itself would need access to the encryption key, in order to decrypt the file. The key could be found within the application EXE and extracted, allowing pirates to generate their own license files.</p>
<p>Using asymmetrical encryption still requires that the application have access to the public part of the key, but knowing the public part of the key will not help anyone trying to hack the system.</p>
<p>The danger lies in pirates being able to replace or intercept the public key with one of their own making. This would require them to get into the <em>.exe</em> and alter the sequence of bytes that defines the public-key (whether it is a string-literal or a resource within the EXE).</p>
<p>This is beyond the scope I have given myself for this article, but just a quick mention:<br>signing the executable itself is one potential way of trying to stop this: modification of the executable will generate a different signature, and the application can be instructed not to open. (This is how the click-once manifests work, in fact, using click-once to deploy your application makes it (almost) impossible to modify that application without regenerating the click-once manifest file.)</p>
<h2 id="如何使用代码"><a href="#如何使用代码" class="headerlink" title="如何使用代码"></a>如何使用代码</h2><p>The logic for the licensing system is contained within the <code>General.Security</code>namespace within the example project: this code is non-specific and portable (it doesn’t reference any custom types outside the <code>General</code>namespace) and the two files (<em>Serializer.cs</em> and <em><span class="search-highlight">RSA</span>.cs</em>) can be moved to any project without change. The actual implementation of the licensing system (i.e. project specific code) is contained within the<code>validateLicenseFile()</code>method of the <code>static Program</code> class. This provides a good example of using the methods defined in the <code>General.Security</code>namespace. The <code>Program.validateLicenseFile()</code>method reads the <code>public</code>key out of the embedded resource (<em>Resources.resx</em>) and locates the license file (asking the user for the location if it can’t find it). It verifies the license file signature is correct, then extracts the license-terms, de-serializes them and checks that the current software and date/time is within the terms on the license. Supplied is an example license file (valid until the year 9999) for user “<code>Test</code>“ (<em>Test.lic</em>) - The public and private key files used to generate this license are also included.</p>
<p>This is the <code>validateLicense</code>method:</p>
<p><pre class="lang:c# decode:true ">/// validate the user-license.<br>internal static bool validateLicenseFile()<br>{<br>    try<br>    {<br>        // reserve a license object:<br>        License license = null;</pre></p>
<pre><code>    // get the public key from internal resource:
    String publicKey = Properties.Resources.publicKey;

    // work out the expected license file-name:
    String licenseFile = Application.LocalUserAppDataPath + &quot;\\&quot; + 
                Environment.UserName + &quot;_user.lic&quot;;

    // does the license file exist?
    if (File.Exists(licenseFile))
    {
        // load the license:
        license = License.Load(licenseFile);
    }
    else
    {
        // prompt the user for a license file:
        OpenFileDialog dlg = new OpenFileDialog();

        // setup a dialog;
        dlg.Filter = &quot;User License Files (*.lic)|*.lic&quot;;
        dlg.Title = &quot;Select License File&quot;;

        if (dlg.ShowDialog() == DialogResult.OK)
        {
            try
            {
                // copy the license file into the local app data directory:
                File.Copy(dlg.FileName, licenseFile);

                // if it made it here, load it:
                if (File.Exists(licenseFile))
                {
                    license = License.Load(licenseFile);
                }
            }
            catch
            {
                // can&apos;t copy the file?.. load the original:
                license = License.Load(dlg.FileName);
            }
        }
    }
    if (license != null)
    {
        // validate the signature on the license with the message contents, 
        // and the public key:
        LicenseAuthorization.ValidateLicense(license, publicKey);

        // if we get here, the license is valid;
        return true;
    }
    else
    {
        // no license file...
        MessageBox.Show(&quot;License File Not Supplied!&quot;, &quot;License Check&quot;);
        return false;
    }
}
catch (SecurityException se)
{
    // display the reason for the license check failure:
    MessageBox.Show(se.Message, &quot;License Check&quot;);
}

// return false...invalid license.
return false;
}
</code></pre><p>}</p>
<div id="contentdiv" class="text"><br><br>## Points of Interest<br><br>Something I discovered while doing the research for this: You can convert an array of bytes to a printable <code>string</code>using <code>Convert.ToBase64String()</code>. The result <code>string</code>always contains printable ASCII characters, and it is definitely not human-readable. The <code>LicenseTerms</code>class for this article, (which contains the start date, end date, product name, user name, etc.) is stored in the license file (which is XML) as a <code>string</code>. The <code>string</code>is created by serializing the licence-terms class to a byte-array using the binary-formatter. This doesn’t encrypt the license terms by any means, but it makes it much harder to read, and it also makes it easy to deal with (no special serialization is required to save a <code>string</code>).<br><br>## 更新版本<br><br>*   Version 1.0<br></div><br><div class="float-right"></div>

<h2 id="文章授权"><a href="#文章授权" class="headerlink" title="文章授权"></a>文章授权</h2><div id="LicenseTerms"><br><br>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" target="_blank" rel="external">The Code Project Open License (CPOL)</a><br><br></div>
          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/12/10/C#全局键盘监听（Hook）的使用/" itemprop="url">
                  C#全局键盘监听（Hook）的使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2015-12-10T14:08:45+08:00" content="2015-12-10">
              2015-12-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/未分类/" itemprop="url" rel="index">
                    <span itemprop="name">未分类</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>文章主要参考了：<a href="http://www.bianceng.cn/Programming/csharp/201410/45484.htm" target="_blank" rel="external">http://www.bianceng.cn/Programming/csharp/201410/45484.htm</a></p>
<h2 id="为什么需要全局键盘监听？"><a href="#为什么需要全局键盘监听？" class="headerlink" title="为什么需要全局键盘监听？"></a>为什么需要全局键盘监听？</h2><p>在某些情况下应用程序需要实现快捷键执行特定功能，例如大家熟知的QQ截图功能Ctrl+Alt+A快捷键，只要QQ程序在运行（无论是拥有焦点还是处于后台运行状态），都可以按下快捷键使用此功能…</p>
<p>这个时候在程序中添加键盘监听肯定不能满足需求了，当用户焦点不在App上时（如最小化，或者用户在处理其它事物等等）键盘监听就失效了</p>
<h2 id="怎样才能实现全局键盘监听？"><a href="#怎样才能实现全局键盘监听？" class="headerlink" title="怎样才能实现全局键盘监听？"></a>怎样才能实现全局键盘监听？</h2><p>这里需要用到Windows API，源码如下：（可以作为一个工具类[KeyboardHook.cs]收藏起来）<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Runtime.InteropServices;</span><br><span class="line">using System.Windows.Forms;</span><br><span class="line">using System.Reflection;</span><br><span class="line"></span><br><span class="line">namespace 壁纸管家</span><br><span class="line">&#123;</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    /// 键盘钩子</span><br><span class="line">    /// [以下代码来自某网友，并非本人原创]</span><br><span class="line">    /// &lt;summary&gt;</span><br><span class="line">    class KeyboardHook</span><br><span class="line">    &#123;</span><br><span class="line">        public event KeyEventHandler KeyDownEvent;</span><br><span class="line">        public event KeyPressEventHandler KeyPressEvent;</span><br><span class="line">        public event KeyEventHandler KeyUpEvent;</span><br><span class="line"></span><br><span class="line">        public delegate int HookProc(int nCode, Int32 wParam, IntPtr lParam);</span><br><span class="line">        static int hKeyboardHook = 0; //声明键盘钩子处理的初始值</span><br><span class="line">        //值在Microsoft SDK的Winuser.h里查询</span><br><span class="line">		// http://www.bianceng.cn/Programming/csharp/201410/45484.htm</span><br><span class="line">        public const int WH_KEYBOARD_LL = 13;   //线程键盘钩子监听鼠标消息设为2，全局键盘监听鼠标消息设为13</span><br><span class="line">        HookProc KeyboardHookProcedure; //声明KeyboardHookProcedure作为HookProc类型</span><br><span class="line">        //键盘结构</span><br><span class="line">        [StructLayout(LayoutKind.Sequential)]</span><br><span class="line">        public class KeyboardHookStruct</span><br><span class="line">        &#123;</span><br><span class="line">            public int vkCode;  //定一个虚拟键码。该代码必须有一个价值的范围1至254</span><br><span class="line">            public int scanCode; // 指定的硬件扫描码的关键</span><br><span class="line">            public int flags;  // 键标志</span><br><span class="line">            public int time; // 指定的时间戳记的这个讯息</span><br><span class="line">            public int dwExtraInfo; // 指定额外信息相关的信息</span><br><span class="line">        &#125;</span><br><span class="line">        //使用此功能，安装了一个钩子</span><br><span class="line">        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</span><br><span class="line">        public static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);</span><br><span class="line"></span><br><span class="line">        //调用此函数卸载钩子</span><br><span class="line">        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</span><br><span class="line">        public static extern bool UnhookWindowsHookEx(int idHook);</span><br><span class="line"></span><br><span class="line">        //使用此功能，通过信息钩子继续下一个钩子</span><br><span class="line">        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</span><br><span class="line">        public static extern int CallNextHookEx(int idHook, int nCode, Int32 wParam, IntPtr lParam);</span><br><span class="line"></span><br><span class="line">        // 取得当前线程编号（线程钩子需要用到）</span><br><span class="line">        [DllImport("kernel32.dll")]</span><br><span class="line">        static extern int GetCurrentThreadId();</span><br><span class="line"></span><br><span class="line">        //使用WINDOWS API函数代替获取当前实例的函数,防止钩子失效</span><br><span class="line">        [DllImport("kernel32.dll")]</span><br><span class="line">        public static extern IntPtr GetModuleHandle(string name);</span><br><span class="line"></span><br><span class="line">        public void Start()</span><br><span class="line">        &#123;</span><br><span class="line">            // 安装键盘钩子</span><br><span class="line">            if (hKeyboardHook == 0)</span><br><span class="line">            &#123;</span><br><span class="line">                KeyboardHookProcedure = new HookProc(KeyboardHookProc);</span><br><span class="line">                hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, GetModuleHandle(System.Diagnostics.Process.GetCurrentProcess().MainModule.ModuleName), 0);</span><br><span class="line">                //hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]), 0);</span><br><span class="line">                //************************************</span><br><span class="line">                //键盘线程钩子</span><br><span class="line">                //SetWindowsHookEx( 2,KeyboardHookProcedure, IntPtr.Zero, GetCurrentThreadId());//指定要监听的线程idGetCurrentThreadId(),</span><br><span class="line">                //键盘全局钩子,需要引用空间(using System.Reflection;)</span><br><span class="line">                //SetWindowsHookEx( 13,MouseHookProcedure,Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]),0);</span><br><span class="line">                //</span><br><span class="line">                //关于SetWindowsHookEx (int idHook, HookProc lpfn, IntPtr hInstance, int threadId)函数将钩子加入到钩子链表中，说明一下四个参数：</span><br><span class="line">                //idHook 钩子类型，即确定钩子监听何种消息，上面的代码中设为2，即监听键盘消息并且是线程钩子，如果是全局钩子监听键盘消息应设为13，</span><br><span class="line">                //线程钩子监听鼠标消息设为7，全局钩子监听鼠标消息设为14。lpfn 钩子子程的地址指针。如果dwThreadId参数为0 或是一个由别的进程创建的</span><br><span class="line">                //线程的标识，lpfn必须指向DLL中的钩子子程。 除此以外，lpfn可以指向当前进程的一段钩子子程代码。钩子函数的入口地址，当钩子钩到任何</span><br><span class="line">                //消息后便调用这个函数。hInstance应用程序实例的句柄。标识包含lpfn所指的子程的DLL。如果threadId 标识当前进程创建的一个线程，而且子</span><br><span class="line">                //程代码位于当前进程，hInstance必须为NULL。可以很简单的设定其为本应用程序的实例句柄。threaded 与安装的钩子子程相关联的线程的标识符</span><br><span class="line">                //如果为0，钩子子程与所有的线程关联，即为全局钩子</span><br><span class="line">                //************************************</span><br><span class="line">                //如果SetWindowsHookEx失败</span><br><span class="line">                if (hKeyboardHook == 0)</span><br><span class="line">                &#123;</span><br><span class="line">                    Stop();</span><br><span class="line">                    throw new Exception("安装键盘钩子失败");</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        public void Stop()</span><br><span class="line">        &#123;</span><br><span class="line">            bool retKeyboard = true;</span><br><span class="line"></span><br><span class="line">            if (hKeyboardHook != 0)</span><br><span class="line">            &#123;</span><br><span class="line">                retKeyboard = UnhookWindowsHookEx(hKeyboardHook);</span><br><span class="line">                hKeyboardHook = 0;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            if (!(retKeyboard)) throw new Exception("卸载钩子失败！");</span><br><span class="line">        &#125;</span><br><span class="line">        //ToAscii职能的转换指定的虚拟键码和键盘状态的相应字符或字符</span><br><span class="line">        [DllImport("user32")]</span><br><span class="line">        public static extern int ToAscii(int uVirtKey, //[in] 指定虚拟关键代码进行翻译。</span><br><span class="line">                                         int uScanCode, // [in] 指定的硬件扫描码的关键须翻译成英文。高阶位的这个值设定的关键，如果是（不压）</span><br><span class="line">                                         byte[] lpbKeyState, // [in] 指针，以256字节数组，包含当前键盘的状态。每个元素（字节）的数组包含状态的一个关键。如果高阶位的字节是一套，关键是下跌（按下）。在低比特，如果设置表明，关键是对切换。在此功能，只有肘位的CAPS LOCK键是相关的。在切换状态的NUM个锁和滚动锁定键被忽略。</span><br><span class="line">                                         byte[] lpwTransKey, // [out] 指针的缓冲区收到翻译字符或字符。</span><br><span class="line">                                         int fuState); // [in] Specifies whether a menu is active. This parameter must be 1 if a menu is active, or 0 otherwise.</span><br><span class="line"></span><br><span class="line">        //获取按键的状态</span><br><span class="line">        [DllImport("user32")]</span><br><span class="line">        public static extern int GetKeyboardState(byte[] pbKeyState);</span><br><span class="line"></span><br><span class="line">        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]</span><br><span class="line">        private static extern short GetKeyState(int vKey);</span><br><span class="line"></span><br><span class="line">        private const int WM_KEYDOWN = 0x100;//KEYDOWN</span><br><span class="line">        private const int WM_KEYUP = 0x101;//KEYUP</span><br><span class="line">        private const int WM_SYSKEYDOWN = 0x104;//SYSKEYDOWN</span><br><span class="line">        private const int WM_SYSKEYUP = 0x105;//SYSKEYUP</span><br><span class="line"></span><br><span class="line">        private int KeyboardHookProc(int nCode, Int32 wParam, IntPtr lParam)</span><br><span class="line">        &#123;</span><br><span class="line">            // 侦听键盘事件</span><br><span class="line">            if ((nCode &amp;gt;= 0) &amp;amp;&amp;amp; (KeyDownEvent != null || KeyUpEvent != null || KeyPressEvent != null))</span><br><span class="line">            &#123;</span><br><span class="line">                KeyboardHookStruct MyKeyboardHookStruct = (KeyboardHookStruct)Marshal.PtrToStructure(lParam, typeof(KeyboardHookStruct));</span><br><span class="line">                // raise KeyDown</span><br><span class="line">                if (KeyDownEvent != null &amp;amp;&amp;amp; (wParam == WM_KEYDOWN || wParam == WM_SYSKEYDOWN))</span><br><span class="line">                &#123;</span><br><span class="line">                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;</span><br><span class="line">                    KeyEventArgs e = new KeyEventArgs(keyData);</span><br><span class="line">                    KeyDownEvent(this, e);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                //键盘按下</span><br><span class="line">                if (KeyPressEvent != null &amp;amp;&amp;amp; wParam == WM_KEYDOWN)</span><br><span class="line">                &#123;</span><br><span class="line">                    byte[] keyState = new byte[256];</span><br><span class="line">                    GetKeyboardState(keyState);</span><br><span class="line"></span><br><span class="line">                    byte[] inBuffer = new byte[2];</span><br><span class="line">                    if (ToAscii(MyKeyboardHookStruct.vkCode, MyKeyboardHookStruct.scanCode, keyState, inBuffer, MyKeyboardHookStruct.flags) == 1)</span><br><span class="line">                    &#123;</span><br><span class="line">                        KeyPressEventArgs e = new KeyPressEventArgs((char)inBuffer[0]);</span><br><span class="line">                        KeyPressEvent(this, e);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                // 键盘抬起</span><br><span class="line">                if (KeyUpEvent != null &amp;amp;&amp;amp; (wParam == WM_KEYUP || wParam == WM_SYSKEYUP))</span><br><span class="line">                &#123;</span><br><span class="line">                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;</span><br><span class="line">                    KeyEventArgs e = new KeyEventArgs(keyData);</span><br><span class="line">                    KeyUpEvent(this, e);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            //如果返回1，则结束消息，这个消息到此为止，不再传递。</span><br><span class="line">            //如果返回0或调用CallNextHookEx函数则消息出了这个钩子继续往下传递，也就是传给消息真正的接受者</span><br><span class="line">            return CallNextHookEx(hKeyboardHook, nCode, wParam, lParam);</span><br><span class="line">        &#125;</span><br><span class="line">        ~KeyboardHook()</span><br><span class="line">        &#123;</span><br><span class="line">            Stop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="如何使用上面的工具类？"><a href="#如何使用上面的工具类？" class="headerlink" title="如何使用上面的工具类？"></a>如何使用上面的工具类？</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>把上面的工具类添加到项目中</p>
<h3 id="首先导入需要的命名空间"><a href="#首先导入需要的命名空间" class="headerlink" title="首先导入需要的命名空间"></a>首先导入需要的命名空间</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">using System.Runtime.InteropServices; //调用WINDOWS API函数时要用到</span><br><span class="line">using Microsoft.Win32; //写入注册表时要用到</span><br></pre></td></tr></table></figure>
<h3 id="安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）"><a href="#安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）" class="headerlink" title="安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）"></a>安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）</h3><pre class="lang:c# decode:true ">var k_hook = new KeyboardHook();
k_hook.KeyDownEvent += new KeyEventHandler(hook_KeyDown);//钩住键按下
k_hook.Start();//安装键盘钩子</pre>

<h3 id="判断输入键值（实现KeyDown事件）"><a href="#判断输入键值（实现KeyDown事件）" class="headerlink" title="判断输入键值（实现KeyDown事件）"></a>判断输入键值（实现KeyDown事件）</h3><p><pre class="lang:c# decode:true ">private void hook_KeyDown(object sender, KeyEventArgs e)<br>{<br>    //判断按下的键（Alt + A）<br>    if (e.KeyValue == (int)Keys.A &amp;&amp; (int)Control.ModifierKeys == (int)Keys.Alt)<br>    {<br>        System.Windows.Forms.MessageBox.Show(“按下了指定快捷键组合”);<br>    }<br>}</pre><br>//注意几种不同的键值判断：<br>//1&gt;.单普通键（例如A）<br>//2&gt;.单控制键+单普通键（例如Ctrl+A）<br>//3&gt;.多控制键+单普通键（例如Ctrl+Alt+A）<br>//上面的代码中演示了2，其它情况以此类推，无非就是添几个条件再&amp;&amp;起来就好</p>
<p>搞定！</p>
<h2 id="使用全局键盘监听需要注意的问题-请读者朋友务必看看"><a href="#使用全局键盘监听需要注意的问题-请读者朋友务必看看" class="headerlink" title="使用全局键盘监听需要注意的问题(请读者朋友务必看看)"></a>使用全局键盘监听需要注意的问题(请读者朋友务必看看)</h2><p>在应用程序中使用全局键盘监听，会被360发现，弹窗提示用户“有程序正在监听键盘输入，是否阻止？”</p>
<p>所以如果程序中必须要用Hook应该告诉用户不会泄露其信息等等</p>
<p>或者直接把App提交给360审核</p>
<p>否则杀软的提示会对用户体验造成极大的影响</p>
<p>P.S：本机只在360安全卫士环境下做了测试，其它杀软未知，应该也会提示类似的危险信息，故慎重使用Hook</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/default_avatar.jpg"
               alt="节约用爱" />
          <p class="site-author-name" itemprop="name">节约用爱</p>
          <p class="site-description motion-element" itemprop="description">随笔 随心</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">22</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>
          
          
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">categories</span>
              
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">节约用爱</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  



  



  
  
  

  


</body>
</html>
