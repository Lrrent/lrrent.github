<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>FOOLMAN 一个人的修行</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="随笔 随心">
<meta property="og:type" content="website">
<meta property="og:title" content="FOOLMAN 一个人的修行">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="FOOLMAN 一个人的修行">
<meta property="og:description" content="随笔 随心">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FOOLMAN 一个人的修行">
<meta name="twitter:description" content="随笔 随心">
  
    <link rel="alternate" href="/atom.xml" title="FOOLMAN 一个人的修行" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">FOOLMAN 一个人的修行</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">随笔 随心</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-new-start" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/10/new-start/" class="article-date">
  <time datetime="2016-03-09T18:07:12.000Z" itemprop="datePublished">2016-03-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/10/new-start/">new start</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/10/new-start/" data-id="cill5rbum001cegp74qtfdtdx" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/09/hello-world/" class="article-date">
  <time datetime="2016-03-09T13:07:02.379Z" itemprop="datePublished">2016-03-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/09/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/09/hello-world/" data-id="cill5rbtw0016egp7hpb8fhcd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-windows-e4-b8-8b-e7-9a-84awesome-e8-ae-a9-e6-89-80-e6-9c-89-e7-aa-97-e5-8f-a3-e5-b9-b3-e9-93-ba-e6-b2-be-e6-bb-a1-e6-a1-8c-e9-9d-a2-e7-9a-84-e5-b7-a5-e5-85-b7bug-n" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/14/windows-e4-b8-8b-e7-9a-84awesome-e8-ae-a9-e6-89-80-e6-9c-89-e7-aa-97-e5-8f-a3-e5-b9-b3-e9-93-ba-e6-b2-be-e6-bb-a1-e6-a1-8c-e9-9d-a2-e7-9a-84-e5-b7-a5-e5-85-b7bug-n/" class="article-date">
  <time datetime="2016-01-14T03:11:21.000Z" itemprop="datePublished">2016-01-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/效率提升/">效率提升</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/14/windows-e4-b8-8b-e7-9a-84awesome-e8-ae-a9-e6-89-80-e6-9c-89-e7-aa-97-e5-8f-a3-e5-b9-b3-e9-93-ba-e6-b2-be-e6-bb-a1-e6-a1-8c-e9-9d-a2-e7-9a-84-e5-b7-a5-e5-85-b7bug-n/">Windows下的awesome让所有窗口平铺沾满桌面的工具bug.n</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="平铺式窗口管理器"><a href="#平铺式窗口管理器" class="headerlink" title="平铺式窗口管理器"></a>平铺式窗口管理器</h2><blockquote>
<p>总有一些东西是你自己不知道是否需要，但是在看到的那一刹那，就觉得相见恨晚的。</p>
</blockquote>
<p>因为曾经在知乎上，看到玩多屏的人介绍过awesome，就一直寻找windows下能用的类似软件，结果找到了这个名叫bug.n的小软件（名字是不是很拗口？）。</p>
<p>软件在GITHUB上，详见<a href="https://github.com/fuhsjr00/bug.n" target="_blank" rel="external">这里</a></p>
<p>先看一下我自己开启bug.n后桌面的窗口布局：</p>
<p><img src="http://7xrpbc.com1.z0.glb.clouddn.com/img_569711fb30fc5.png" alt=""></p>
<p>值得一提的是，窗口顶端还有一个banner，显示的信息包括：</p>
<ul>
<li>虚拟桌面列表</li>
<li>当前虚拟桌面使用什么布局</li>
<li>活动窗口的标题</li>
<li>日期时间</li>
</ul>
<p>bug.n支持虚拟桌面。Windows系统只有一个桌面，但通过bug.n可以虚拟出很多桌面。如果你正在一个桌面上玩游戏或看碟，看到老板来了，你可以迅速切换到早就准备好的工作桌面。老板在任务栏上不会发现任何你娱乐过的蛛丝马迹。</p>
<p>通过按Win+加数字n，可以切换到第n个桌面。用鼠标直接点击banner上的虚拟桌面按钮也可以。另外用鼠标右键点击某个虚拟桌面，会把当前的活动窗口送到那个虚拟桌面去。</p>
<p>每个桌面支持三种布局模式：</p>
<ul>
<li>平铺模式(tiling): 所有窗口平铺，左边是主窗口，右边是窗口队列。按 Win+t 可以切换到tiling模式。</li>
<li>浮动模式(floating): 所有窗口浮动，可以互相遮盖，就是我们平常用的模式。按 win+f可以切换到floating模式。</li>
<li>全屏模式(monocle): 所有窗口最大化，一次只显示一个。按 Win+m 可以切换到 monocle 模式。<br>用鼠标右键点击banner上的布局按钮可以在这三种布局间切换。</li>
</ul>
<p>通过窗口键加方向键可以调整主窗口大小和改变窗口队列，自己试试就知道。如果你觉得受不了了，按 Win + Ctrl + q，可以退出bug.n。</p>
<p>我在Win10上用bug.n，自己的配置写在 <code>C:\Users\Administrator\AppData\Roaming\bug.n\Config.ini</code> 中。</p>
<p>重点介绍一些常用的快捷键</p>
<p><code>Win+左右方向键</code>，是调整分割比例，这个很好用，左侧可以调整为正好一个网页的宽度。</p>
<p><code>Win+上下</code>，可以调整活动窗口。</p>
<p><code>Win+Shift+上下键</code>，可以让活动窗口在不同位置之间跳转。</p>
<p><code>Win+Shift+Enter</code>，让当前窗口和左侧活动主窗口对调位置很方便。</p>
<p><code>Win+Ctrl+q</code>，退出bug.n。</p>
<p><code>Win+c</code>，关闭当前窗口。</p>
<p>配合Chrome的Vimium，可以提高不少效率。</p>
<p>目前我正在研究的是Config.ini的一条规则，</p>
<p><code>Config_rule=WebChat*;.*;;1;0;0;0;0;0;</code></p>
<p>就是比如像微信电脑版这样的程序，其窗口的最小是一个固定值，如果让他按照普通窗口那样排列，基本什么也看不到，目前代替的方法就是Win+c，然后看到新信息，Ctrl+Alt+w取消息，回复完了，再关闭微信（注：Ctrl+Alt+w是微信默认快捷键，非bug.n）。</p>
<p>部分文字摘抄<a href="http://www.cnblogs.com/jiqingwu/p/4311202.html" target="_blank" rel="external">http://www.cnblogs.com/jiqingwu/p/4311202.html</a></p>
<p>特此说明。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/14/windows-e4-b8-8b-e7-9a-84awesome-e8-ae-a9-e6-89-80-e6-9c-89-e7-aa-97-e5-8f-a3-e5-b9-b3-e9-93-ba-e6-b2-be-e6-bb-a1-e6-a1-8c-e9-9d-a2-e7-9a-84-e5-b7-a5-e5-85-b7bug-n/" data-id="cill5rbus001hegp7l8bqfmlm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-net-e7-a0-b4-e8-a7-a3-e5-8f-8d-e7-bc-96-e8-af-91-e8-b5-84-e6-96-99-e6-b1-87-e6-80-bb" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/11/net-e7-a0-b4-e8-a7-a3-e5-8f-8d-e7-bc-96-e8-af-91-e8-b5-84-e6-96-99-e6-b1-87-e6-80-bb/" class="article-date">
  <time datetime="2016-01-11T09:10:24.000Z" itemprop="datePublished">2016-01-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/11/net-e7-a0-b4-e8-a7-a3-e5-8f-8d-e7-bc-96-e8-af-91-e8-b5-84-e6-96-99-e6-b1-87-e6-80-bb/">.net破解反编译资料汇总</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>国内网站</p>
<p>1、www.52pojie.cn 唔爱破解</p>
<p>2、<a href="http://www.17ky.net/" target="_blank" rel="external">http://www.17ky.net/</a> 工具汇总</p>
<p>国外网站</p>
<p>1、<a href="http://www.hackforum.net" target="_blank" rel="external">http://www.hackforum.net</a> 著名的HACK论坛，国内IP无法访问，挂代理或者VPN也不行</p>
<p>2、<a href="http://www.tuts.com" target="_blank" rel="external">http://www.tuts.com</a></p>
<p>3、<a href="http://www.nulled.io" target="_blank" rel="external">http://www.nulled.io</a> 现在貌似域名编程nulled.cr了，不知道IO出现什么变故了</p>
<p>4、</p>
<p>文档、资料</p>
<p>&nbsp;</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/11/net-e7-a0-b4-e8-a7-a3-e5-8f-8d-e7-bc-96-e8-af-91-e8-b5-84-e6-96-99-e6-b1-87-e6-80-bb/" data-id="cill5rbuj001aegp7moo2ovy5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-e5-8f-8d-e7-bc-96-e8-af-91-e8-bd-af-e4-bb-b6-e9-9b-86-e5-90-88" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/07/e5-8f-8d-e7-bc-96-e8-af-91-e8-bd-af-e4-bb-b6-e9-9b-86-e5-90-88/" class="article-date">
  <time datetime="2016-01-07T04:24:15.000Z" itemprop="datePublished">2016-01-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Net反编译/">.Net反编译</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/07/e5-8f-8d-e7-bc-96-e8-af-91-e8-bd-af-e4-bb-b6-e9-9b-86-e5-90-88/">.Net反编译软件集合</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1、查壳</p>
<p>PeID 0.95 下载地址：[download id=”115”] 官网：无，已经停止更新</p>
<p>这里要说一下，网上所谓的0.96版本，应该不是原作者的作品，截图如下：</p>
<p><img src="http://www.wuliaole.com/wp-content/uploads/2016/01/img_56934c3b33ebb.png" alt=""></p>
<p>0.95版本，大小213KB，所谓的0.96，大小就超过1M了，并且打开的时候，腾讯管家报毒“进程创建”，各位小心为妙。</p>
<p>Exeinfo PE 0.0.4.1 下载地址：[download id=”150”] 官方网站：<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>Dot Net ID 下载地址：[download id=”154”] 官方网站：<a href="http://rongchaua.net，网站404" target="_blank" rel="external">http://rongchaua.net，网站404</a></p>
<p>2、脱壳</p>
<p>.NET Generic Unpacker(x86) 下载地址：[download id=”144”] 官方网站：<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>.NET Generic Unpacker(x64) 下载地址：[download id=”147”] 官方网站：<a href="http://exeinfo.atwebpages.com/" target="_blank" rel="external">http://exeinfo.atwebpages.com/</a></p>
<p>DNGuard HVM Unpacker 3.71 trial support</p>
<p><img src="http://www.wuliaole.com/wp-content/uploads/2016/01/img_569370433c050.png" alt=""></p>
<p>SAE 1.14 下载地址：[download id=”122”]</p>
<p>.NET REFLECTOR 8.3.3.115 下载地址：[download id=”127”]</p>
<p>ILSpy_Master_2.3.1.1855 下载地址：[download id=”132”]</p>
<p>Telerik Just Decompile 2015.3.1116.1 下载地址：[download id=”141”]</p>
<p>dnSpy 1.5.0.0 下载地址：[download id=”161”]</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/01/07/e5-8f-8d-e7-bc-96-e8-af-91-e8-bd-af-e4-bb-b6-e9-9b-86-e5-90-88/" data-id="cill5rbt2000regp7i5gm3mma" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/反编译/">反编译</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-e4-bd-bf-e7-94-a8turbotop-e4-bf-9d-e6-8c-81windows-e4-b8-8a-e4-bb-bb-e6-84-8f-e7-a8-8b-e5-ba-8f-e4-bf-9d-e6-8c-81-e6-9c-80-e5-89-8d-e7-ab-af" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/18/e4-bd-bf-e7-94-a8turbotop-e4-bf-9d-e6-8c-81windows-e4-b8-8a-e4-bb-bb-e6-84-8f-e7-a8-8b-e5-ba-8f-e4-bf-9d-e6-8c-81-e6-9c-80-e5-89-8d-e7-ab-af/" class="article-date">
  <time datetime="2015-12-18T02:32:13.000Z" itemprop="datePublished">2015-12-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/18/e4-bd-bf-e7-94-a8turbotop-e4-bf-9d-e6-8c-81windows-e4-b8-8a-e4-bb-bb-e6-84-8f-e7-a8-8b-e5-ba-8f-e4-bf-9d-e6-8c-81-e6-9c-80-e5-89-8d-e7-ab-af/">使用TurboTop保持Windows上任意程序保持最前端</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>有时候你可能需要把某个应用窗口保持在最前端，比如处理表单数据的时候将计算器放在最前面。<strong>TurboTop</strong> 这款免费PC工具可以让任意正在运行的应用窗口保持在最前端。</p>
<p>运行后点击托盘区图标可以看到正在运行的应用列表，勾选某个应用，此应用就会保持在最前端了，而且你可以勾选多个应用。</p>
<ul>
<li>软件名称： TurboTop</li>
<li>支援平台； Windows</li>
<li>软件下载： 官网<br>软件截图<br><img src="http://pics.ikamu.me/2014/10/fqqc6i7qh1taf2cvlk7g.png" alt="fqqc6i7qh1taf2cvlk7g"></li>
</ul>
<p>转载了其他人的文字，当个软件推荐给大家吧。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/18/e4-bd-bf-e7-94-a8turbotop-e4-bf-9d-e6-8c-81windows-e4-b8-8a-e4-bb-bb-e6-84-8f-e7-a8-8b-e5-ba-8f-e4-bf-9d-e6-8c-81-e6-9c-80-e5-89-8d-e7-ab-af/" data-id="cill5rbsw000megp7ot3mwszk" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/置顶/">置顶</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-e4-bd-bf-e7-94-a8rsa-e5-8a-a0-e5-af-86-e4-bf-9d-e6-8a-a4-e4-bd-a0-e7-9a-84-net-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8fwinform" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/16/e4-bd-bf-e7-94-a8rsa-e5-8a-a0-e5-af-86-e4-bf-9d-e6-8a-a4-e4-bd-a0-e7-9a-84-net-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8fwinform/" class="article-date">
  <time datetime="2015-12-16T09:43:28.000Z" itemprop="datePublished">2015-12-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/16/e4-bd-bf-e7-94-a8rsa-e5-8a-a0-e5-af-86-e4-bf-9d-e6-8a-a4-e4-bd-a0-e7-9a-84-net-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8fwinform/">使用RSA加密保护你的.net应用程序(winform)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文地址：<a href="http://www.codeproject.com/Articles/203840/RSA-License-Protection" target="_blank" rel="external">http://www.codeproject.com/Articles/203840/RSA-License-Protection</a></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>本文的目的是通过使用.net内置的RSA加密组件对winform程序进行签名并校验，以达到有效保护winform程序的目的。</p>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>所有应用程序开发者，尤其是哪些程序需要销售并且得到付款的开发者，都或多或少的关注程序的未授权的分发问题。因为无论什么时候，程序都存在被破解（或反编译）的可能性，总有人不想花钱去买你的软件。而你需要明白的一个事实是，无论你如何加密软件，软件都存在被破解和反编译的事实，因此，加密的目的，并不是为了防止反编译或者破解，而是加大破解的难度，让大多数人觉得购买你的软件，比寻找破解版更加容易。并且最重要的一点，就是程序员需要花费更多的精力，去完善软件，提升服务，尤其是配套的，售后的服务质量，让顾客觉得心甘情愿购买你的软件，或者更确切的，是购买你的服务！然后，再回头来讨论下这篇文章的最初目的，就是你的程序，应当，也应该校验用户的合法性，毕竟你是需要赚钱的！  The best bit of programming you can do to secure your program is to make the program actually valuable to the user, so they <em>want</em> to buy it. But, the next best thing is a mechanism by which you can use to correctly identify valid users of the program. There is no end to these methods, and they all have varying levels of security, administration overhead, and user-annoyance. Here are some of the common methods:</p>
<h3 id="Serial-Number-Protection"><a href="#Serial-Number-Protection" class="headerlink" title="Serial Number Protection"></a>Serial Number Protection</h3><p>Found on the back of a CD case, the most common copy-protection you can find often involves a long serial number that is derived from an algorithm, such that only the original key-generator can produce valid keys. Often, the first few characters define a seed entry for a pseudo-random-number generator, and the remaining characters must match the transformed output of that number generator. This has a number of drawbacks:</p>
<ol>
<li>It is a blanket authorization: Usernames and License-end terms, partial licenses cannot be specified</li>
<li>All you need is a copy of the serial-number: there are hundreds of websites that list known serial numbers for almost any bit of commercial software.</li>
<li>The user has to type in a long annoying and difficult to read serial number in order to install the software.</li>
</ol>
<h3 id="Online-Activation"><a href="#Online-Activation" class="headerlink" title="Online Activation"></a>Online Activation</h3><p>An extension of serial-number protection: the application contacts a central server to validate that the serial-number is one that has been issued. This allows serial numbers to be blacklisted, tracked, etc. The main drawback is that the application must have internet access in order to validate the serial number. Users will probably not be happy about this (especially if they don’t have constant internet access) and you may find hackers patching your software not to illegally copy it, but just to get it to work offline. The other drawback is the amount of coding and development work that must go into a system like this that could be defeated by a proxy-server that simulates the responses of your own validation server.</p>
<h3 id="License-Terms-File"><a href="#License-Terms-File" class="headerlink" title="License Terms File"></a>License Terms File</h3><p>Many systems use a license file that is supplied to the user with their purchase. The license file specifies the licensee (the user’s name, address, contact details, etc.), the product being licensed, and the start and end dates of that license. The software asks for the license file on first use, copies it into a known location, then validates that the terms of the license are valid (correct software version, within the applicable date-range, etc.).</p>
<p>The trick here is to ensure that the license file that is supplied is authentic, if that part is covered, this is an excellent system for licensing: the license terms can be as simple or complex as you like (i.e. blanket authorization, or partial (certain features enabled)), they can have start and end dates, be restricted to particular applications or even restricted to particular users. The user isn’t forced to type in a long and complex serial-number, and having the users name and contact details embedded within the terms makes it less likely that users will voluntarily share the license file.</p>
<h3 id="Authenticating-the-License-File"><a href="#Authenticating-the-License-File" class="headerlink" title="Authenticating the License File"></a>Authenticating the License File</h3><p>There is a branch of cryptography that deals with verification (or signing) of data, using Asymmetrical Encryption.</p>
<p>A digital signature is produced from the data being verified by generating a hash-code from the source data, and encrypting this hash with a private key.<br>The hash code will be unique to the source data… if even one bit in the source data changes, the resulting hashcode will be quite different. (The “strength” of any hashing algorithm is indicated by how much the hash-code changes with the smallest possible edit of the source data).</p>
<p>Verification of the data is achieved by using the public-part of the key to check if the digital signature (the encrypted hash) still matches the data that is being verified. If any part of the data is changed, then the digital signature will not match.</p>
<p>This means that you can verify that the license file the system is using definitely came from you, (the sellers of the software) without having to give the application access to the private key. If you were to use symmetrical encryption to encrypt the license-terms (so they could not be seen or changed), then the application itself would need access to the encryption key, in order to decrypt the file. The key could be found within the application EXE and extracted, allowing pirates to generate their own license files.</p>
<p>Using asymmetrical encryption still requires that the application have access to the public part of the key, but knowing the public part of the key will not help anyone trying to hack the system.</p>
<p>The danger lies in pirates being able to replace or intercept the public key with one of their own making. This would require them to get into the <em>.exe</em> and alter the sequence of bytes that defines the public-key (whether it is a string-literal or a resource within the EXE).</p>
<p>This is beyond the scope I have given myself for this article, but just a quick mention:<br>signing the executable itself is one potential way of trying to stop this: modification of the executable will generate a different signature, and the application can be instructed not to open. (This is how the click-once manifests work, in fact, using click-once to deploy your application makes it (almost) impossible to modify that application without regenerating the click-once manifest file.)</p>
<h2 id="如何使用代码"><a href="#如何使用代码" class="headerlink" title="如何使用代码"></a>如何使用代码</h2><p>The logic for the licensing system is contained within the <code>General.Security</code>namespace within the example project: this code is non-specific and portable (it doesn’t reference any custom types outside the <code>General</code>namespace) and the two files (<em>Serializer.cs</em> and <em><span class="search-highlight">RSA</span>.cs</em>) can be moved to any project without change. The actual implementation of the licensing system (i.e. project specific code) is contained within the<code>validateLicenseFile()</code>method of the <code>static Program</code> class. This provides a good example of using the methods defined in the <code>General.Security</code>namespace. The <code>Program.validateLicenseFile()</code>method reads the <code>public</code>key out of the embedded resource (<em>Resources.resx</em>) and locates the license file (asking the user for the location if it can’t find it). It verifies the license file signature is correct, then extracts the license-terms, de-serializes them and checks that the current software and date/time is within the terms on the license. Supplied is an example license file (valid until the year 9999) for user “<code>Test</code>“ (<em>Test.lic</em>) - The public and private key files used to generate this license are also included.</p>
<p>This is the <code>validateLicense</code>method:</p>
<p><pre class="lang:c# decode:true ">/// validate the user-license.<br>internal static bool validateLicenseFile()<br>{<br>    try<br>    {<br>        // reserve a license object:<br>        License license = null;</pre></p>
<pre><code>    // get the public key from internal resource:
    String publicKey = Properties.Resources.publicKey;

    // work out the expected license file-name:
    String licenseFile = Application.LocalUserAppDataPath + &quot;\\&quot; + 
                Environment.UserName + &quot;_user.lic&quot;;

    // does the license file exist?
    if (File.Exists(licenseFile))
    {
        // load the license:
        license = License.Load(licenseFile);
    }
    else
    {
        // prompt the user for a license file:
        OpenFileDialog dlg = new OpenFileDialog();

        // setup a dialog;
        dlg.Filter = &quot;User License Files (*.lic)|*.lic&quot;;
        dlg.Title = &quot;Select License File&quot;;

        if (dlg.ShowDialog() == DialogResult.OK)
        {
            try
            {
                // copy the license file into the local app data directory:
                File.Copy(dlg.FileName, licenseFile);

                // if it made it here, load it:
                if (File.Exists(licenseFile))
                {
                    license = License.Load(licenseFile);
                }
            }
            catch
            {
                // can&apos;t copy the file?.. load the original:
                license = License.Load(dlg.FileName);
            }
        }
    }
    if (license != null)
    {
        // validate the signature on the license with the message contents, 
        // and the public key:
        LicenseAuthorization.ValidateLicense(license, publicKey);

        // if we get here, the license is valid;
        return true;
    }
    else
    {
        // no license file...
        MessageBox.Show(&quot;License File Not Supplied!&quot;, &quot;License Check&quot;);
        return false;
    }
}
catch (SecurityException se)
{
    // display the reason for the license check failure:
    MessageBox.Show(se.Message, &quot;License Check&quot;);
}

// return false...invalid license.
return false;
}
</code></pre><p>}</p>
<div id="contentdiv" class="text"><br><br>## Points of Interest<br><br>Something I discovered while doing the research for this: You can convert an array of bytes to a printable <code>string</code>using <code>Convert.ToBase64String()</code>. The result <code>string</code>always contains printable ASCII characters, and it is definitely not human-readable. The <code>LicenseTerms</code>class for this article, (which contains the start date, end date, product name, user name, etc.) is stored in the license file (which is XML) as a <code>string</code>. The <code>string</code>is created by serializing the licence-terms class to a byte-array using the binary-formatter. This doesn’t encrypt the license terms by any means, but it makes it much harder to read, and it also makes it easy to deal with (no special serialization is required to save a <code>string</code>).<br><br>## 更新版本<br><br>*   Version 1.0<br></div><br><div class="float-right"></div>

<h2 id="文章授权"><a href="#文章授权" class="headerlink" title="文章授权"></a>文章授权</h2><div id="LicenseTerms"><br><br>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" target="_blank" rel="external">The Code Project Open License (CPOL)</a><br><br></div>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/16/e4-bd-bf-e7-94-a8rsa-e5-8a-a0-e5-af-86-e4-bf-9d-e6-8a-a4-e4-bd-a0-e7-9a-84-net-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8fwinform/" data-id="cill5rbsv000legp7vc8yg7zn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-c-e5-85-a8-e5-b1-80-e9-94-ae-e7-9b-98-e7-9b-91-e5-90-ac-ef-bc-88hook-ef-bc-89-e7-9a-84-e4-bd-bf-e7-94-a8" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/10/c-e5-85-a8-e5-b1-80-e9-94-ae-e7-9b-98-e7-9b-91-e5-90-ac-ef-bc-88hook-ef-bc-89-e7-9a-84-e4-bd-bf-e7-94-a8/" class="article-date">
  <time datetime="2015-12-10T06:08:45.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/10/c-e5-85-a8-e5-b1-80-e9-94-ae-e7-9b-98-e7-9b-91-e5-90-ac-ef-bc-88hook-ef-bc-89-e7-9a-84-e4-bd-bf-e7-94-a8/">C#全局键盘监听（Hook）的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>文章主要参考了：<a href="http://www.bianceng.cn/Programming/csharp/201410/45484.htm" target="_blank" rel="external">http://www.bianceng.cn/Programming/csharp/201410/45484.htm</a></p>
<h2 id="为什么需要全局键盘监听？"><a href="#为什么需要全局键盘监听？" class="headerlink" title="为什么需要全局键盘监听？"></a>为什么需要全局键盘监听？</h2><p>在某些情况下应用程序需要实现快捷键执行特定功能，例如大家熟知的QQ截图功能Ctrl+Alt+A快捷键，只要QQ程序在运行（无论是拥有焦点还是处于后台运行状态），都可以按下快捷键使用此功能…</p>
<p>这个时候在程序中添加键盘监听肯定不能满足需求了，当用户焦点不在App上时（如最小化，或者用户在处理其它事物等等）键盘监听就失效了</p>
<h2 id="怎样才能实现全局键盘监听？"><a href="#怎样才能实现全局键盘监听？" class="headerlink" title="怎样才能实现全局键盘监听？"></a>怎样才能实现全局键盘监听？</h2><p>这里需要用到Windows API，源码如下：（可以作为一个工具类[KeyboardHook.cs]收藏起来）</p>
<pre class="lang:c# decode:true ">using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;
using System.Windows.Forms;
using System.Reflection;

namespace 壁纸管家
{
    /// &lt;summary&gt;
    /// 键盘钩子
    /// [以下代码来自某网友，并非本人原创]
    /// &lt;/summary&gt;
    class KeyboardHook
    {
        public event KeyEventHandler KeyDownEvent;
        public event KeyPressEventHandler KeyPressEvent;
        public event KeyEventHandler KeyUpEvent;

        public delegate int HookProc(int nCode, Int32 wParam, IntPtr lParam);
        static int hKeyboardHook = 0; //声明键盘钩子处理的初始值
        //值在Microsoft SDK的Winuser.h里查询
        // http://www.bianceng.cn/Programming/csharp/201410/45484.htm
        public const int WH_KEYBOARD_LL = 13;   //线程键盘钩子监听鼠标消息设为2，全局键盘监听鼠标消息设为13
        HookProc KeyboardHookProcedure; //声明KeyboardHookProcedure作为HookProc类型
        //键盘结构
        [StructLayout(LayoutKind.Sequential)]
        public class KeyboardHookStruct
        {
            public int vkCode;  //定一个虚拟键码。该代码必须有一个价值的范围1至254
            public int scanCode; // 指定的硬件扫描码的关键
            public int flags;  // 键标志
            public int time; // 指定的时间戳记的这个讯息
            public int dwExtraInfo; // 指定额外信息相关的信息
        }
        //使用此功能，安装了一个钩子
        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int SetWindowsHookEx(int idHook, HookProc lpfn, IntPtr hInstance, int threadId);

        //调用此函数卸载钩子
        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern bool UnhookWindowsHookEx(int idHook);

        //使用此功能，通过信息钩子继续下一个钩子
        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        public static extern int CallNextHookEx(int idHook, int nCode, Int32 wParam, IntPtr lParam);

        // 取得当前线程编号（线程钩子需要用到）
        [DllImport("kernel32.dll")]
        static extern int GetCurrentThreadId();

        //使用WINDOWS API函数代替获取当前实例的函数,防止钩子失效
        [DllImport("kernel32.dll")]
        public static extern IntPtr GetModuleHandle(string name);

        public void Start()
        {
            // 安装键盘钩子
            if (hKeyboardHook == 0)
            {
                KeyboardHookProcedure = new HookProc(KeyboardHookProc);
                hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, GetModuleHandle(System.Diagnostics.Process.GetCurrentProcess().MainModule.ModuleName), 0);
                //hKeyboardHook = SetWindowsHookEx(WH_KEYBOARD_LL, KeyboardHookProcedure, Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]), 0);
                //************************************
                //键盘线程钩子
                //SetWindowsHookEx( 2,KeyboardHookProcedure, IntPtr.Zero, GetCurrentThreadId());//指定要监听的线程idGetCurrentThreadId(),
                //键盘全局钩子,需要引用空间(using System.Reflection;)
                //SetWindowsHookEx( 13,MouseHookProcedure,Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]),0);
                //
                //关于SetWindowsHookEx (int idHook, HookProc lpfn, IntPtr hInstance, int threadId)函数将钩子加入到钩子链表中，说明一下四个参数：
                //idHook 钩子类型，即确定钩子监听何种消息，上面的代码中设为2，即监听键盘消息并且是线程钩子，如果是全局钩子监听键盘消息应设为13，
                //线程钩子监听鼠标消息设为7，全局钩子监听鼠标消息设为14。lpfn 钩子子程的地址指针。如果dwThreadId参数为0 或是一个由别的进程创建的
                //线程的标识，lpfn必须指向DLL中的钩子子程。 除此以外，lpfn可以指向当前进程的一段钩子子程代码。钩子函数的入口地址，当钩子钩到任何
                //消息后便调用这个函数。hInstance应用程序实例的句柄。标识包含lpfn所指的子程的DLL。如果threadId 标识当前进程创建的一个线程，而且子
                //程代码位于当前进程，hInstance必须为NULL。可以很简单的设定其为本应用程序的实例句柄。threaded 与安装的钩子子程相关联的线程的标识符
                //如果为0，钩子子程与所有的线程关联，即为全局钩子
                //************************************
                //如果SetWindowsHookEx失败
                if (hKeyboardHook == 0)
                {
                    Stop();
                    throw new Exception("安装键盘钩子失败");
                }
            }
        }
        public void Stop()
        {
            bool retKeyboard = true;

            if (hKeyboardHook != 0)
            {
                retKeyboard = UnhookWindowsHookEx(hKeyboardHook);
                hKeyboardHook = 0;
            }

            if (!(retKeyboard)) throw new Exception("卸载钩子失败！");
        }
        //ToAscii职能的转换指定的虚拟键码和键盘状态的相应字符或字符
        [DllImport("user32")]
        public static extern int ToAscii(int uVirtKey, //[in] 指定虚拟关键代码进行翻译。
                                         int uScanCode, // [in] 指定的硬件扫描码的关键须翻译成英文。高阶位的这个值设定的关键，如果是（不压）
                                         byte[] lpbKeyState, // [in] 指针，以256字节数组，包含当前键盘的状态。每个元素（字节）的数组包含状态的一个关键。如果高阶位的字节是一套，关键是下跌（按下）。在低比特，如果设置表明，关键是对切换。在此功能，只有肘位的CAPS LOCK键是相关的。在切换状态的NUM个锁和滚动锁定键被忽略。
                                         byte[] lpwTransKey, // [out] 指针的缓冲区收到翻译字符或字符。
                                         int fuState); // [in] Specifies whether a menu is active. This parameter must be 1 if a menu is active, or 0 otherwise.

        //获取按键的状态
        [DllImport("user32")]
        public static extern int GetKeyboardState(byte[] pbKeyState);

        [DllImport("user32.dll", CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
        private static extern short GetKeyState(int vKey);

        private const int WM_KEYDOWN = 0x100;//KEYDOWN
        private const int WM_KEYUP = 0x101;//KEYUP
        private const int WM_SYSKEYDOWN = 0x104;//SYSKEYDOWN
        private const int WM_SYSKEYUP = 0x105;//SYSKEYUP

        private int KeyboardHookProc(int nCode, Int32 wParam, IntPtr lParam)
        {
            // 侦听键盘事件
            if ((nCode &gt;= 0) &amp;&amp; (KeyDownEvent != null || KeyUpEvent != null || KeyPressEvent != null))
            {
                KeyboardHookStruct MyKeyboardHookStruct = (KeyboardHookStruct)Marshal.PtrToStructure(lParam, typeof(KeyboardHookStruct));
                // raise KeyDown
                if (KeyDownEvent != null &amp;&amp; (wParam == WM_KEYDOWN || wParam == WM_SYSKEYDOWN))
                {
                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;
                    KeyEventArgs e = new KeyEventArgs(keyData);
                    KeyDownEvent(this, e);
                }

                //键盘按下
                if (KeyPressEvent != null &amp;&amp; wParam == WM_KEYDOWN)
                {
                    byte[] keyState = new byte[256];
                    GetKeyboardState(keyState);

                    byte[] inBuffer = new byte[2];
                    if (ToAscii(MyKeyboardHookStruct.vkCode, MyKeyboardHookStruct.scanCode, keyState, inBuffer, MyKeyboardHookStruct.flags) == 1)
                    {
                        KeyPressEventArgs e = new KeyPressEventArgs((char)inBuffer[0]);
                        KeyPressEvent(this, e);
                    }
                }

                // 键盘抬起
                if (KeyUpEvent != null &amp;&amp; (wParam == WM_KEYUP || wParam == WM_SYSKEYUP))
                {
                    Keys keyData = (Keys)MyKeyboardHookStruct.vkCode;
                    KeyEventArgs e = new KeyEventArgs(keyData);
                    KeyUpEvent(this, e);
                }

            }
            //如果返回1，则结束消息，这个消息到此为止，不再传递。
            //如果返回0或调用CallNextHookEx函数则消息出了这个钩子继续往下传递，也就是传给消息真正的接受者
            return CallNextHookEx(hKeyboardHook, nCode, wParam, lParam);
        }
        ~KeyboardHook()
        {
            Stop();
        }
    }
}</pre>

<h2 id="如何使用上面的工具类？"><a href="#如何使用上面的工具类？" class="headerlink" title="如何使用上面的工具类？"></a>如何使用上面的工具类？</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>把上面的工具类添加到项目中</p>
<h3 id="首先导入需要的命名空间"><a href="#首先导入需要的命名空间" class="headerlink" title="首先导入需要的命名空间"></a>首先导入需要的命名空间</h3><pre class="lang:c# decode:true ">using System.Runtime.InteropServices; //调用WINDOWS API函数时要用到
using Microsoft.Win32; //写入注册表时要用到</pre>

<h3 id="安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）"><a href="#安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）" class="headerlink" title="安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）"></a>安装Hook，在程序入口中写上下面的代码（本例中用了WinForm，在Form的构造方法中安装Hook即可）</h3><pre class="lang:c# decode:true ">var k_hook = new KeyboardHook();
k_hook.KeyDownEvent += new KeyEventHandler(hook_KeyDown);//钩住键按下
k_hook.Start();//安装键盘钩子</pre>

<h3 id="判断输入键值（实现KeyDown事件）"><a href="#判断输入键值（实现KeyDown事件）" class="headerlink" title="判断输入键值（实现KeyDown事件）"></a>判断输入键值（实现KeyDown事件）</h3><p><pre class="lang:c# decode:true ">private void hook_KeyDown(object sender, KeyEventArgs e)<br>{<br>    //判断按下的键（Alt + A）<br>    if (e.KeyValue == (int)Keys.A &amp;&amp; (int)Control.ModifierKeys == (int)Keys.Alt)<br>    {<br>        System.Windows.Forms.MessageBox.Show(“按下了指定快捷键组合”);<br>    }<br>}</pre><br>//注意几种不同的键值判断：<br>//1&gt;.单普通键（例如A）<br>//2&gt;.单控制键+单普通键（例如Ctrl+A）<br>//3&gt;.多控制键+单普通键（例如Ctrl+Alt+A）<br>//上面的代码中演示了2，其它情况以此类推，无非就是添几个条件再&amp;&amp;起来就好</p>
<p>搞定！</p>
<h2 id="使用全局键盘监听需要注意的问题-请读者朋友务必看看"><a href="#使用全局键盘监听需要注意的问题-请读者朋友务必看看" class="headerlink" title="使用全局键盘监听需要注意的问题(请读者朋友务必看看)"></a>使用全局键盘监听需要注意的问题(请读者朋友务必看看)</h2><p>在应用程序中使用全局键盘监听，会被360发现，弹窗提示用户“有程序正在监听键盘输入，是否阻止？”</p>
<p>所以如果程序中必须要用Hook应该告诉用户不会泄露其信息等等</p>
<p>或者直接把App提交给360审核</p>
<p>否则杀软的提示会对用户体验造成极大的影响</p>
<p>P.S：本机只在360安全卫士环境下做了测试，其它杀软未知，应该也会提示类似的危险信息，故慎重使用Hook</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/10/c-e5-85-a8-e5-b1-80-e9-94-ae-e7-9b-98-e7-9b-91-e5-90-ac-ef-bc-88hook-ef-bc-89-e7-9a-84-e4-bd-bf-e7-94-a8/" data-id="cill5rbs40008egp7pet3r9ux" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-c-e6-a8-a1-e6-8b-9f-e9-94-ae-e7-9b-98-e6-93-8d-e4-bd-9c-sendkeysendkeys" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/10/c-e6-a8-a1-e6-8b-9f-e9-94-ae-e7-9b-98-e6-93-8d-e4-bd-9c-sendkeysendkeys/" class="article-date">
  <time datetime="2015-12-10T05:58:22.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/10/c-e6-a8-a1-e6-8b-9f-e9-94-ae-e7-9b-98-e6-93-8d-e4-bd-9c-sendkeysendkeys/">C# 模拟键盘操作--SendKey(),SendKeys()</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>C#实现模拟键盘输入可以使用以下2个语法实现的，分别是：<br>SendKeys.Send(string keys);  //模拟汉字(文本)输入<br>SendKeys.SendWait(string keys); //模拟按键输入</p>
<p>先了解一下2个语法的用法吧！</p>
<p>（1）每个按键由一个或多个字符表示。为了指定单一键盘字符，必须按字符本身的键。例如，为了表示字母 A，可以用 “A” 作为 string。为了表示多个字符，就必须在字符后面直接加上另一个字符。例如，要表示 A、B 及 C，可用 “ABC” 作为 string。<br>（2）对 SendKeys 来说，加号 (+)、插入符 (^)、百分比符号 (%)、上划线 (~) 及圆括号 ( ) 都具有特殊意义。为了指定上述任何一个字符，要将它放在大括号 ({}) 当中。例如，要指定正号，可用 {+} 表示。方括号 ([ ]) 对 SendKeys 来说并不具有特殊意义，但必须将它们放在大括号中。在其它应用程序中，方括号有特殊意义，在出现动态数据交换 (DDE) 的时候，它可能具有重要意义。为了指定大括号字符，请使用 {}。<br>（3）为了在按下按键时指定那些不显示的字符，例如 ENTER 或 TAB 以及那些表示动作而非字符的按键，请使用下列代码：</p>
<p><table border="1" cellspacing="0" cellpadding="0"></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td>按键</td></p>
<p><td>代码</td><br></p>
<p><tr></tr></p>
<p><td>BACKSPACE</td></p>
<p><td>{BACKSPACE}, {BS}, 或 {BKSP}</td><br></p>
<p><tr></tr></p>
<p><td>BREAK</td></p>
<p><td>{BREAK}</td><br></p>
<p><tr></tr></p>
<p><td>CAPS LOCK</td></p>
<p><td>{CAPSLOCK}</td><br></p>
<p><tr></tr></p>
<p><td>DEL or DELETE</td></p>
<p><td>{DELETE} 或 {DEL}</td><br></p>
<p><tr></tr></p>
<p><td>DOWN ARROW</td></p>
<p><td>{DOWN}</td><br></p>
<p><tr></tr></p>
<p><td>END</td></p>
<p><td>{END}</td><br></p>
<p><tr></tr></p>
<p><td>ENTER</td></p>
<p><td>{ENTER}或 ~</td><br></p>
<p><tr></tr></p>
<p><td>ESC</td></p>
<p><td>{ESC}</td><br></p>
<p><tr></tr></p>
<p><td>HELP</td></p>
<p><td>{HELP}</td><br></p>
<p><tr></tr></p>
<p><td>HOME</td></p>
<p><td>{HOME}</td><br></p>
<p><tr></tr></p>
<p><td>INS or INSERT</td></p>
<p><td>{INSERT} 或 {INS}</td><br></p>
<p><tr></tr></p>
<p><td>LEFT ARROW</td></p>
<p><td>{LEFT}</td><br></p>
<p><tr></tr></p>
<p><td>NUM LOCK</td></p>
<p><td>{NUMLOCK}</td><br></p>
<p><tr></tr></p>
<p><td>PAGE DOWN</td></p>
<p><td>{PGDN}</td><br></p>
<p><tr></tr></p>
<p><td>PAGE UP</td></p>
<p><td>{PGUP}</td><br></p>
<p><tr></tr></p>
<p><td>PRINT SCREEN</td></p>
<p><td>{PRTSC}</td><br></p>
<p><tr></tr></p>
<p><td>RIGHT ARROW</td></p>
<p><td>{RIGHT}</td><br></p>
<p><tr></tr></p>
<p><td>SCROLL LOCK</td></p>
<p><td>{SCROLLLOCK}</td><br></p>
<p><tr></tr></p>
<p><td>TAB</td></p>
<p><td>{TAB}</td><br></p>
<p><tr></tr></p>
<p><td>UP ARROW</td></p>
<p><td>{UP}</td><br></p>
<p><tr></tr></p>
<p><td>F1</td></p>
<p><td>{F1}</td><br></p>
<p><tr></tr></p>
<p><td>F2</td></p>
<p><td>{F2}</td><br></p>
<p><tr></tr></p>
<p><td>F3</td></p>
<p><td>{F3}</td><br></p>
<p><tr></tr></p>
<p><td>F4</td></p>
<p><td>{F4}</td><br></p>
<p><tr></tr></p>
<p><td>F5</td></p>
<p><td>{F5}</td><br></p>
<p><tr></tr></p>
<p><td>F6</td></p>
<p><td>{F6}</td><br></p>
<p><tr></tr></p>
<p><td>F7</td></p>
<p><td>{F7}</td><br></p>
<p><tr></tr></p>
<p><td>F8</td></p>
<p><td>{F8}</td><br></p>
<p><tr></tr></p>
<p><td>F9</td></p>
<p><td>{F9}</td><br></p>
<p><tr></tr></p>
<p><td>F10</td></p>
<p><td>{F10}</td><br></p>
<p><tr></tr></p>
<p><td>F11</td></p>
<p><td>{F1}</td><br></p>
<p><tr></tr></p>
<p><td>F12</td></p>
<p><td>{F12}</td><br></p>
<p><tr></tr></p>
<p><td>F13</td></p>
<p><td>{F13}</td><br></p>
<p><tr></tr></p>
<p><td>F14</td></p>
<p><td>{F14}</td><br></p>
<p><tr></tr></p>
<p><td>F15</td></p>
<p><td>{F15}</td><br></p>
<p><tr></tr></p>
<p><td>F16</td></p>
<p><td>{F16}</td><br><br><br><br>（4）SHIFT、CTRL 及 ALT 等按键结合的组合键，可在这些按键码的前面放置一个或多个代码，这些代码列举如下：</p>
<p><table border="1" cellspacing="0" cellpadding="0"></table></p>
<p><tbody></tbody></p>
<p><tr></tr></p>
<p><td>按键</td></p>
<p><td>代码</td><br></p>
<p><tr></tr></p>
<p><td>Shift</td></p>
<p><td>+</td><br></p>
<p><tr></tr></p>
<p><td>Ctrl</td></p>
<p><td>^</td><br></p>
<p><tr></tr></p>
<p><td>Alt</td></p>
<p><td>%</td><br><br><br><br>（5）输入汉字用SendKeys.Send(“汉字”);</p>
<p>样例代码：</p>
<p><pre class="lang:default decode:true ">using System;<br>using System.Collections.Generic;<br>using System.ComponentModel;<br>using System.Data;<br>using System.Drawing;<br>using System.Linq;<br>using System.Text;<br>using System.Windows.Forms;<br>namespace ApplicationForm<br>{<br>    public partial class Form1 : Form<br>    {<br>        public Form1()<br>        {<br>            InitializeComponent();<br>        }<br>        private void button1_Click(object sender, EventArgs e)<br>        {<br>            //光标移至richTextBox1<br>            richTextBox1.Focus();</pre></p>
<pre><code>        //模拟按下&quot;ABCDEFG&quot;
        SendKeys.SendWait(&quot;(ABCDEFG)&quot;);
        SendKeys.SendWait(&quot;{left 5}&quot;);
        SendKeys.SendWait(&quot;{h 10}&quot;);
        /*
        更多举例:
        SendKeys.SendWait(&quot;^C&quot;);  //Ctrl+C 组合键
        SendKeys.SendWait(&quot;+C&quot;);  //Shift+C 组合键
        SendKeys.SendWait(&quot;%C&quot;);  //Alt+C 组合键
        SendKeys.SendWait(&quot;+(AX)&quot;);  //Shift+A+X 组合键
        SendKeys.SendWait(&quot;+AX&quot;);  //Shift+A 组合键,之后按X键
        SendKeys.SendWait(&quot;{left 5}&quot;);  //按←键 5次
        SendKeys.SendWait(&quot;{h 10}&quot;);   //按h键 10次
        SendKeys.Send(&quot;汉字&quot;);  //模拟输入&quot;汉字&quot;2个字
        */
    }
}
</code></pre><p>}<br>原文出处：<a href="http://www.cnblogs.com/liujie1111/p/4268174.html" target="_blank" rel="external">http://www.cnblogs.com/liujie1111/p/4268174.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/10/c-e6-a8-a1-e6-8b-9f-e9-94-ae-e7-9b-98-e6-93-8d-e4-bd-9c-sendkeysendkeys/" data-id="cill5rbs9000aegp784qeain8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-e4-b8-80-e4-b8-aa-e5-be-ae-e4-bf-a1-e7-94-b5-e8-84-91-e7-89-88-e6-88-96-e8-80-85qq-e6-b5-8f-e8-a7-88-e5-99-a8-e7-9a-84-e5-be-ae-e4-bf-a1-e8-81-8a-e5-a4-a9-e8-be-85-e5-8a-a9-e5-b7-a5-e5-85-b7v0-1b" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/12/10/e4-b8-80-e4-b8-aa-e5-be-ae-e4-bf-a1-e7-94-b5-e8-84-91-e7-89-88-e6-88-96-e8-80-85qq-e6-b5-8f-e8-a7-88-e5-99-a8-e7-9a-84-e5-be-ae-e4-bf-a1-e8-81-8a-e5-a4-a9-e8-be-85-e5-8a-a9-e5-b7-a5-e5-85-b7v0-1b/" class="article-date">
  <time datetime="2015-12-10T04:48:19.000Z" itemprop="datePublished">2015-12-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/未分类/">未分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/10/e4-b8-80-e4-b8-aa-e5-be-ae-e4-bf-a1-e7-94-b5-e8-84-91-e7-89-88-e6-88-96-e8-80-85qq-e6-b5-8f-e8-a7-88-e5-99-a8-e7-9a-84-e5-be-ae-e4-bf-a1-e8-81-8a-e5-a4-a9-e8-be-85-e5-8a-a9-e5-b7-a5-e5-85-b7v0-1b/">一个微信电脑版或者QQ浏览器的微信聊天辅助工具v0.1b</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>怎么说呢，估计用到这个软件功能的人不是太多，具体环境就是如果你旁边的同事离你的工位很近，不想让他们瞟见你聊天的内容，尤其是好友的最后一句话，那么这个工具适合你。</p>
<p>开发环境：VS2015</p>
<p>语言：C#</p>
<p>下载地址：<a href="http://www.wuliaole.com/wp-content/uploads/2015/12/BlankChat-v0.1b1.rar" target="_blank" rel="external">BlankChat v0.1b</a></p>
<p>软件截图：<br><a href="http://www.wuliaole.com/wp-content/uploads/2015/12/QQ截图20151210124554.jpg" target="_blank" rel="external"><img src="http://www.wuliaole.com/wp-content/uploads/2015/12/QQ截图20151210124554-300x139.jpg" alt="QQ截图20151210124554"></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>最新版本：0.1beta</p>
<p>软件介绍：就是可以在聊天记录之前加上一堆空格，然后自动发出去，快捷键是CTRL+ENTER。</p>
<p>使用方法：首先要修改一下微信桌面版的发送快捷方式，要改成ENTER，这样就不会和软件的快捷键冲突了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/12/10/e4-b8-80-e4-b8-aa-e5-be-ae-e4-bf-a1-e7-94-b5-e8-84-91-e7-89-88-e6-88-96-e8-80-85qq-e6-b5-8f-e8-a7-88-e5-99-a8-e7-9a-84-e5-be-ae-e4-bf-a1-e8-81-8a-e5-a4-a9-e8-be-85-e5-8a-a9-e5-b7-a5-e5-85-b7v0-1b/" data-id="cill5rbsu000kegp7dttuxxti" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Net反编译/">.Net反编译</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/效率提升/">效率提升</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/未分类/">未分类</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/反编译/">反编译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/置顶/">置顶</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/反编译/" style="font-size: 10px;">反编译</a> <a href="/tags/置顶/" style="font-size: 10px;">置顶</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/03/10/new-start/">new start</a>
          </li>
        
          <li>
            <a href="/2016/03/09/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2016/01/14/windows-e4-b8-8b-e7-9a-84awesome-e8-ae-a9-e6-89-80-e6-9c-89-e7-aa-97-e5-8f-a3-e5-b9-b3-e9-93-ba-e6-b2-be-e6-bb-a1-e6-a1-8c-e9-9d-a2-e7-9a-84-e5-b7-a5-e5-85-b7bug-n/">Windows下的awesome让所有窗口平铺沾满桌面的工具bug.n</a>
          </li>
        
          <li>
            <a href="/2016/01/11/net-e7-a0-b4-e8-a7-a3-e5-8f-8d-e7-bc-96-e8-af-91-e8-b5-84-e6-96-99-e6-b1-87-e6-80-bb/">.net破解反编译资料汇总</a>
          </li>
        
          <li>
            <a href="/2016/01/07/e5-8f-8d-e7-bc-96-e8-af-91-e8-bd-af-e4-bb-b6-e9-9b-86-e5-90-88/">.Net反编译软件集合</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 节约用爱<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>